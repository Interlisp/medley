(DEFINE-FILE-INFO §READTABLE "INTERLISP" §PACKAGE "INTERLISP")
(FILECREATED "26-Mar-87 09:52:19" {ERIS}<LISPCORE>LIBRARY>INTERNAL>SOURCELOOKUP.;1 5861   

      previous date%: "21-Jan-86 09:49:57" {ERIS}<JAMES>KOTO>SOURCELOOKUP.;2)


(* "
Copyright (c) 1985, 1986, 1987 by Xerox Corporation.  All rights reserved.
")

(PRETTYCOMPRINT SOURCELOOKUPCOMS)

(RPAQQ SOURCELOOKUPCOMS ((VARS KotoSourceIndex)
                         (FNS LOCATE.FUNCTION LOCATE.FILE)
                         (FILES WHEREIS)))

(RPAQQ KotoSourceIndex 
       ((|KOTO SOURCES #1| 10MBDRIVER 4045STREAM AARITH ABASIC ACODE ADDARITH ADIR ADVISE AERROR 
               AFONT AINTERRUPT AOFD)
        (|KOTO SOURCES #2| ADISPLAY APRINT APUTDQ ASSIST ASTACK BIG BITMAPFNS BRKDWN BUSEXTENDER)
        (|KOTO SOURCES #3| ATERM ATTACHEDWINDOW BREAK BROWSER BSP CENTRONICS)
        (|KOTO SOURCES #4| ATBL BUSMASTER BYTECOMPILER CHAT CIRCLPRINT)
        (|KOTO SOURCES #5| C150STREAM CHATTERMINAL CHECKSET CLISP CLISPIFY CML CMLARITH CMLFLOATARRAY 
               CMLSETF)
        (|KOTO SOURCES #6| CMLARRAY CMLARRAYINSPECTOR CMLCHARACTER CMLCOMPILE CMLEXEC CMLHELP 
               CMLPRETTY CMLPRINT CMLSPECIALFORMS CMLSTREAMS CMLSTRUCT CMLTYPES COLOR COLORDEMO 
               COMPATIBILITY)
        (|KOTO SOURCES #7| COMMENT COMMON COMPILE COMPILEBANG COPYFILES COREIO COURIER DATABASEFNS 
               DEDIT DEXEC)
        (|KOTO SOURCES #8| DECL DES DFILE DINFO DISKDLION DLAP)
        (|KOTO SOURCES #9| DLFIXINIT DLRS232C DLTTY DMCHAT DMISC DORADOCOLOR DOVEDECLS DOVEDISK 
               DOVEDISPLAY DOVEDISPLAYHACK DSKDISPLAY)
        (|KOTO SOURCES #10| DPUPFTP DWIMIFY EDITBITMAP)
        (|KOTO SOURCES #11| DOVEETHER DOVEFLOPPY DOVEINPUTOUTPUT EDIT FILECACHE HLCOLOR)
        (|KOTO SOURCES #12| DOVEMISC DSPRINTDEF DTDECLARE DWIM ETHERRECORDS FILEBROWSER FILEIO 
               FILESETS)
        (|KOTO SOURCES #13| FLOPPY)
        (|KOTO SOURCES #14| FASTFX80STREAM FILEPKG FONT FONTSAMPLE ICONW)
        (|KOTO SOURCES #15| FREEMENU FX80STREAM GCHAX GRAPHER)
        (|KOTO SOURCES #16| FTPSERVER FXPRINTER GRAPHZOOM HARDCOPY HASH HIST HPRINT)
        (|KOTO SOURCES #17| HELPDL HELPSYS HLDISPLAY HRULE IDLER IMAGEIO IMAGEOBJ INSPECT)
        (|KOTO SOURCES #18| INTERPRESS IOCHAR IRISCONSTANTS IRISIO IRISNET IRISSTREAM LAMBDATRAN)
        (|KOTO SOURCES #19| IRISLIB KERMIT KERMITMENU KEYBOARDEDITOR LABEL LISTEN LLARITH LLSUBRS)
        (|KOTO SOURCES #20| LEAF LLARRAYELT LLBFS LLCODE)
        (|KOTO SOURCES #21| LLBASIC LLBIGNUM LLCHAR LLCOLOR LLDATATYPE LLFCOMPILE MACROAUX)
        (|KOTO SOURCES #22| LLDISPLAY LLETHER LLFLOAT LOADIRIS)
        (|KOTO SOURCES #23| LLFAULT LLGC LLINTERP LLKEY)
        (|KOTO SOURCES #24| LLHUNK LLNEW LLNS LLNSDECLS LLPARAMS LLREAD LLSTK LLTIMER LOADFNS MEM 
               POSTLOADUP)
        (|KOTO SOURCES #25| LOCALFILE MACHINEINDEPENDENT MACROS PUPCHAT)
        (|KOTO SOURCES #26| MAKEINIT MASTERSCOPE MATCH MATMULT MENU MISC)
        (|KOTO SOURCES #27| MINISERVE MOD44IO MSANALYZE NEWPRINTDEF PCALLSTATS PRETTY)
        (|KOTO SOURCES #28| NSCHAT PRESS PROC PUP)
        (|KOTO SOURCES #29| MODARITH MSPARSE NSPRINT PASSWORDS PMAP PUPPRINT RDSYS READAIS READNUMBER 
               READSYS REMOTEVMEM RENAMEMACROS TEDITABBREV)
        (|KOTO SOURCES #30| RECORD RENAMEFNS RESOURCE RS232CHAT RS232CMENU SAMEDIR 
               SCAVENGEDSKDIRECTORY SFFONT SIMPLIFY SKETCHEDIT SKETCHOBJ TEDITCHAT)
        (|KOTO SOURCES #31| SKETCHELEMENTS SPELL)
        (|KOTO SOURCES #32| SKETCHSTREAM SPLICE SPP SPY SYSEDIT TABLEBROWSER TEDIT TEDITHISTORY)
        (|KOTO SOURCES #33| TEDITFILE TEDITLOOKS TEDITPAGE VMEM)
        (|KOTO SOURCES #34| TEDITMENU TEDITWINDOW VT100KP)
        (|KOTO SOURCES #35| TEDITCOMMAND TEDITFIND TEDITFNKEYS TEDITHCPY TEDITSCREEN TEK4010CHAT 
               XXGEOM)
        (|KOTO SOURCES #36| TEDITSELECTION TELERAID TEXEC TEXTOFD TFBRAVO)
        (|KOTO SOURCES #37| TRSERVER TTYCHAT TTYIN UNDO VANILLADISK WTFIX)
        (|KOTO SOURCES #38| VIRTUALKEYBOARDS WBREAK WINDOW XXFILL)
        (|KOTO SOURCES #39| SKETCH)
        (|KOTO SOURCES #40| SKETCH VTCHAT WEDIT WHEREIS)))
(DEFINEQ

(LOCATE.FUNCTION
  [LAMBDA (FUNC QUIETFLG)                                    (* ckj "21-Jan-86 09:49")
          
          (* * finds which Koto source file and floppy FUNC is defined on)
          
          (* * KotoSourceIndex is a list where each element is a list whose car is a 
          floppy name and cdr is the floppy contents)

    (PROG (WhichFile? WhichFloppy?)
          (SETQ WhichFile? (CAR (WHEREIS FUNC NIL T)))
          (if WhichFile?
              then (SETQ WhichFloppy? (LOCATE.FILE WhichFile? KotoSourceIndex))
            else (if (NOT QUIETFLG)
                     then (printout T .FONT BOLDFONT FUNC .FONT DEFAULTFONT " not found." T))
                 (RETURN))
          (if (NOT QUIETFLG)
              then (printout T "The function " .FONT BOLDFONT FUNC .FONT DEFAULTFONT 
                          " is defined in the file " .FONT BOLDFONT WhichFile? .FONT DEFAULTFONT 
                          " located on floppy " .FONT BOLDFONT WhichFloppy? .FONT DEFAULTFONT "." T))
          (RETURN (LIST WhichFile? WhichFloppy?])

(LOCATE.FILE
  [LAMBDA (FILENAME FLOPPYINDEX)                             (* DERING " 8-Jan-85 14:05")
          
          (* * FLOPPYINDEX IS A LIST WHERE EACH ELEMENT IS A LIST WHOSE CAR IS THE FLOPPY 
          NAME AND CDR IS THE FILES RESIDING ON THE FLOPPY.)

    (COND
       ((NULL (CAR FLOPPYINDEX))
        NIL)
       ((EQMEMB FILENAME (CAR FLOPPYINDEX))
        (CAAR FLOPPYINDEX))
       (T (LOCATE.FILE FILENAME (CDR FLOPPYINDEX])
)
(FILESLOAD WHEREIS)
(PUTPROPS SOURCELOOKUP COPYRIGHT ("Xerox Corporation" 1985 1986 1987))
(DECLARE%: DONTCOPY
  (FILEMAP (NIL (4149 5747 (LOCATE.FUNCTION 4159 . 5274) (LOCATE.FILE 5276 . 5745)))))
STOP
