(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "INTERLISP" BASE 10)
(FILECREATED "22-Mar-88 21:14:40" {DSK}<LISPFILES>TOP10-87>ADMIN>FORMATTINGFNS.;13 63618  

      changes to%:  (VARS FORMATTINGFNSCOMS)
                    (FNS CALL.OTHERPARA CALL.HEAD CALL.1DIAGRAM CALL.2DIAGRAM CALL.3DIAGRAM 
                         CALL.4DIAGRAM CALL.5DIAGRAM CALL.6DIAGRAM TOP10.PAGELAYOUT 
                         TOP10.CALLNAME-STYLE TOP10.CALLDEFN-STYLE TOP10.NO-STYLE 
                         TOP10.NOTEHEAD-STYLE TOP10.NOTE-STYLE TOP10.DIAGRAM-STYLE TOP10.INIT 
                         TOP10-DIAGRAM-CHAR-STYLE TOP10-CALLTITLE-CHAR-STYLE 
                         TOP10-MAINPARA-CHAR-STYLE TOP10-NOTETITLE-CHAR-STYLE TOP10-NOTE-CHAR-STYLE 
                         TOP10-BIG-STYLES TOP10-PRINT-STYLES XPS.COVER.PARA CRAM-DOC FILE-TO-WP CHC 
                         TEDIT.EXTERNAL.FORM TEDIT.EXT.PARALOOKS TEDIT.EXT.CHARLOOKS TEDIT.EXT.OBJECT 
                         SPELLING-CORRECT)

      previous date%: "22-Mar-88 01:44:22" {DSK}<LISPFILES>TOP10-87>ADMIN>FORMATTINGFNS.;11)


(* "
Copyright (c) 1987, 1988 by Xerox Corporation.  All rights reserved.
")

(PRETTYCOMPRINT FORMATTINGFNSCOMS)

(RPAQQ FORMATTINGFNSCOMS 
       (  (* ;; "Support for TOP-10 '87 edition formatting")

        (FNS CALL.HEAD CALL.OTHERPARA CALL.1DIAGRAM CALL.2DIAGRAM CALL.3DIAGRAM CALL.4DIAGRAM 
             CALL.5DIAGRAM CALL.6DIAGRAM TOP10.PAGELAYOUT TOP10.CALLNAME-STYLE TOP10.CALLDEFN-STYLE 
             TOP10.NO-STYLE TOP10.NOTEHEAD-STYLE TOP10.NOTE-STYLE TOP10.DIAGRAM-STYLE TOP10.INIT)
        (COMS 
          (* ;; "Support for character styles used in the Top10 mss.")

              (FNS TOP10-DIAGRAM-CHAR-STYLE TOP10-CALLTITLE-CHAR-STYLE TOP10-MAINPARA-CHAR-STYLE 
                   TOP10-NOTETITLE-CHAR-STYLE TOP10-NOTE-CHAR-STYLE)
              (FUNCTIONS TOP10-APPLY-CHAR-STYLE)
              
          (* ;; "Initial style definitions:")

              (GLOBALVARS *TOP10-DIAGRAM-CHAR-STYLE-SPEC* *TOP10-CALLTITLE-CHAR-STYLE-SPEC* 
                     *TOP10-MAINPARA-CHAR-STYLE-SPEC* *TOP10-NOTE-CHAR-STYLE-SPEC* 
                     *TOP10-DIAGRAM-CHAR-STYLE-SPEC* *TOP10-NOTETITLE-CHAR-STYLE-SPEC*)
              
          (* ;; 
       "ALists for converting charlooks to styled looks.  Reset these lists to enforce new styles:")

              (GLOBALVARS *TOP10-DIAGRAM-CHAR-STYLE-ALIST* *TOP10-CALLTITLE-CHAR-STYLE-ALIST* 
                     *TOP10-MAINPARA-CHAR-STYLE-ALIST* *TOP10-NOTE-CHAR-STYLE-ALIST* 
                     *TOP10-DIAGRAM-CHAR-STYLE-ALIST* *TOP10-NOTETITLE-CHAR-STYLE-ALIST*)
              
          (* ;; "  Fns for changing to readable sizes:")

              (FNS TOP10-BIG-STYLES TOP10-PRINT-STYLES)
              
          (* ;; "Initialize the styles:")

              (P (TOP10-BIG-STYLES)))
        (FNS XPS.COVER.PARA)
                                                             (* ; "From XPSEDIT formatter.")
        (FNS CRAM-DOC FILE-TO-WP CHC)
                                                             (* ; 
                                                           "For converting from WP format on PC")
        (FNS TEDIT.EXTERNAL.FORM TEDIT.EXT.PARALOOKS TEDIT.EXT.CHARLOOKS TEDIT.EXT.OBJECT)
                                                             (* ; 
                                                    "For writing a WP-able version of TEdit files.")
        (FNS SPELLING-CORRECT)
                                                             (* ; 
                                                     "For fixing common errors in TOP10 documents.")
        [VARS (*TOP10-FILES* '(Front-Back>Inner-Cover.TEDIT Front-Back>Introduction.TEDIT 
                                     Front-Back>TOP10-CONTENTS.TEDIT FREQUENCY.TEDIT 
                                     DICTIONARIES>DICT-PREFACE.TEDIT DICTIONARIES>MSDICT-A-G.TEDIT 
                                     DICTIONARIES>MSDICT-H-P.TEDIT DICTIONARIES>MSDICT-R-S.TEDIT 
                                     DICTIONARIES>MSDICT-T-Z.TEDIT DICTIONARIES>PLUSDICT.TEDIT 
                                     DICTIONARIES>ADV-PREFACE.TEDIT DICTIONARIES>ADVDICT-A-M.TEDIT 
                                     DICTIONARIES>ADVDICT-N-Z.TEDIT DICTIONARIES>C1-PREFACE.TEDIT 
                                     DICTIONARIES>C1DEFNS-A-H.TEDIT DICTIONARIES>C1DEFNS-I-R.TEDIT 
                                     DICTIONARIES>C1DEFNS-S.TEDIT DICTIONARIES>C1DEFNS-T-Z.TEDIT 
                                     DICTIONARIES>C2DEFNS-A-E.TEDIT DICTIONARIES>C2DEFNS-F-O.TEDIT 
                                     >DICTIONARIES>C2DEFNS-P-S.TEDIT DICTIONARIES>C2DEFNS-T-Z.TEDIT 
                                     FRA>FORMATION-DICT.TEDIT FRA>ARRANGEMENTS.TEDIT FRA>FRA.TEDIT 
                                     FRA>ARRANGE-2FLINES.TEDIT FRA>ARRANGE-8CHAIN.TEDIT 
                                     FRA>ARRANGE-DIAMOND.TEDIT FRA>ARRANGE-LINES.TEDIT 
                                     FRA>ARRANGE-QTAG.TEDIT FRA>ARRANGE-WAVES.TEDIT))
              (*TOP10-ERIS-FILES* '({ERIS}<SYBALSKY>TOP10-87>TOP10-CONTENTS.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FREQUENCY.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>DICT-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-A-G.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-H-P.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-R-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-T-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>PLUSDICT.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADV-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-A-M.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-N-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-A-H.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-I-R.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-T-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-A-E.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-F-O.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-P-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-T-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>FORMATION-DICT.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGEMENTS.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>FRA.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-2FLINES.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-8CHAIN.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-DIAMOND.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-LINES.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-QTAG.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-WAVES.TEDIT))
              (*TOP10-ERIS-PART1* '({ERIS}<SYBALSKY>TOP10-87>TOP10-CONTENTS.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FREQUENCY.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>DICT-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-A-G.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-H-P.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-R-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-T-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>PLUSDICT.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADV-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-A-M.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-N-Z.TEDIT))
              (*TOP10-ERIS-PART2* '({ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1-PREFACE.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-A-H.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-I-R.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-T-Z.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-A-E.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-F-O.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-P-S.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-T-Z.TEDIT 
                                          ERISS}<SYBALSKY>CALENDAR.DATABASEATION-DICT.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGEMENTS.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>FRA.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-2FLINES.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-8CHAIN.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-DIAMOND.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-LINES.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-QTAG.TEDIT 
                                          {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-WAVES.TEDIT]
        (P (TEDIT.SETFUNCTION (CHARCODE "##^S")
                  (FUNCTION SPELLING-CORRECT)))
        
(* ;;; "Page layout of 3, 3x5 cards per page with heading and 2 columns per card.")

        [VARS (TOP10-FRAMES (TEDIT.PARSE.PAGEFRAMES
                             '(LIST ((PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                      (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                           (0 0 612 792)
                                           ((FOLIO NIL
                                                   (PARALOOKS (QUAD CENTERED)
                                                          CHARLOOKS
                                                          (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                 OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                 OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                 UNDERLINE OFF EXPANSION REGULAR 
                                                                 SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                 OFF USERINFO NIL STYLE NIL)
                                                          FORMATINFO
                                                          (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                   (108 36 288 36)
                                                   NIL)
                                            (TEXT NIL NIL (36 36 210 540)
                                                  NIL)
                                            (TEXT NIL NIL (258 36 210 540)
                                                  NIL)))
                                     (PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                      (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                           (0 0 612 792)
                                           ((FOLIO NIL
                                                   (PARALOOKS (QUAD CENTERED)
                                                          CHARLOOKS
                                                          (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                 OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                 OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                 UNDERLINE OFF EXPANSION REGULAR 
                                                                 SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                 OFF USERINFO NIL STYLE NIL)
                                                          FORMATINFO
                                                          (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                   (108 36 288 36)
                                                   NIL)
                                            (TEXT NIL NIL (36 36 210 540)
                                                  NIL)
                                            (TEXT NIL NIL (258 36 210 540)
                                                  NIL)))
                                     (PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                      (ERISIC "ÿï%ÿ " "ÿï%ÿ "))
                                           (0 0 612 792)
                                           ((FOLIO NIL
                                                   (PARALOOKS (QUAD CENTERED)
                                                          CHARLOOKS
                                                          (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                 OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                 OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                 UNDERLINE OFF EXPANSION REGULAR 
                                                                 SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                 OFF USERINFO NIL STYLE NIL)
                                                          FORMATINFO
                                                          (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                   (108 36 288 36)
                                                   NIL)
                                            (TEXT NIL NIL (36 36 210 540)
                                                  NIL)
                                            (TEXT NIL NIL (258 36 210 540)
                                                  NIL]
        (P (TOP10.INIT))
        (PROP FILETYPE FORMATTINGFNS)))



(* ;; "Support for TOP-10 '87 edition formatting")

(DEFINEQ

(CALL.HEAD
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                    (* ; "Edited 15-Mar-88 01:38 by Sybalsky")
          (* ;; "Impose the style for the paragraph that heads a call definition.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (LET* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
           (CH# (fetch CH# of SEL))
           (CHLIM (fetch CHLIM of SEL)))
          (TEDIT.PARALOOKS TEXTOBJ
                 '(HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE NIL SUBTYPE 
                         NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL STYLE NIL 
                         TABS (60 (581 . LEFT))
                         BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 6 RIGHTMARGIN 210 
                         LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD JUSTIFIED) SEL])

(CALL.OTHERPARA
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 22-Mar-88 18:18 by ")
          (* ;; "Impose the style for paragrazphs in the body of a call definition.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE NIL SUBTYPE 
                          NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL STYLE NIL 
                          TABS NIL BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 2 
                          RIGHTMARGIN 210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD JUSTIFIED])

(CALL.1DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 14-Oct-87 11:52 by jds")
          (* ;; "Impose the style for a single-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE NIL SUBTYPE 
                          NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL STYLE NIL 
                          TABS NIL BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 0 
                          RIGHTMARGIN 210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD CENTERED])

(CALL.2DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 14-Oct-87 11:54 by jds")
          (* ;; "Impose the style for a single-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE NIL SUBTYPE 
                          NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL STYLE NIL 
                          TABS (60 (66 . CENTERED)
                                   (144 . CENTERED))
                          BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 3 RIGHTMARGIN 
                          210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD JUSTIFIED])

(CALL.3DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 14-Oct-87 11:55 by jds")
          (* ;; "Impose the style for a 3-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE NIL SUBTYPE 
                          NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL STYLE NIL 
                          TABS (60 (36 . CENTERED)
                                   (108 . CENTERED)
                                   (174 . CENTERED))
                          BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 3 RIGHTMARGIN 
                          210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD JUSTIFIED])

(CALL.4DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 17-Dec-87 15:33 by jds")
          (* ;; "Impose the style for a single-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(REVISED NIL HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE 
                          NIL SUBTYPE NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL 
                          STYLE NIL TABS (60 (18 . CENTERED)
                                             (72 . CENTERED)
                                             (126 . CENTERED)
                                             (174 . CENTERED)
                                             (581 . LEFT))
                          BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 0 RIGHTMARGIN 
                          210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD LEFT])

(CALL.5DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited  5-Jan-88 13:25 by jds")
          (* ;; "Impose the style for a single-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(REVISED NIL HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE 
                          NIL SUBTYPE NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL 
                          STYLE NIL TABS (60 (24 . CENTERED)
                                             (66 . CENTERED)
                                             (108 . CENTERED)
                                             (150 . CENTERED)
                                             (192 . CENTERED))
                          BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 1 RIGHTMARGIN 
                          210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD LEFT])

(CALL.6DIAGRAM
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 17-Dec-87 16:20 by jds")
          (* ;; "Impose the style for a single-picture diagram paragraph:  Centered.")

    (XPS.COVER.PARA TEXTOBJ SEL)                         (* ; 
                                                       "Make sure the whole paragraph is selected.")
    (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))
            (CH# (fetch CH# of SEL))
            (CHLIM (fetch CHLIM of SEL)))
           (TEDIT.PARALOOKS TEXTOBJ
                  '(REVISED NIL HARDCOPY NIL KEEP NIL HEADINGKEEP OFF NEWPAGEAFTER NIL NEWPAGEBEFORE 
                          NIL SUBTYPE NIL TYPE NIL SPECIALY 0 SPECIALX 0 USERINFO NIL CHARSTYLES NIL 
                          STYLE NIL TABS (60 (18 . CENTERED)
                                             (42 . CENTERED)
                                             (78 . CENTERED)
                                             (120 . CENTERED)
                                             (156 . CENTERED)
                                             (186 . CENTERED)
                                             (581 . LEFT))
                          BASETOBASE NIL LINELEADING 0 POSTPARALEADING 0 PARALEADING 1 RIGHTMARGIN 
                          210 LEFTMARGIN 0 1STLEFTMARGIN 0 QUAD JUSTIFIED])

(TOP10.PAGELAYOUT
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 14-Oct-87 12:03 by jds")
(* ;;; "Impose page layout on a TOP-10 '87 file.  2-column, set up for 7 x 8.5 pages with 1/2%" top and bottom..")

    (TEDIT.PAGEFORMAT TEXTSTREAM TOP10-FRAMES])

(TOP10.CALLNAME-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 23-Dec-87 11:40 by jds")
          (* ;; "Impose the CHARACTER style for call titles.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE TOP10-CALLTITLE-CHAR-STYLE])

(TOP10.CALLDEFN-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 23-Dec-87 11:41 by jds")
          (* ;; "Impose the CHARACTER style for call titles.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE TOP10-MAINPARA-CHAR-STYLE])

(TOP10.NO-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited  5-Jan-88 12:26 by jds")
          (* ;; "Remove any character styling.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE NIL])

(TOP10.NOTEHEAD-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 23-Dec-87 11:41 by jds")
          (* ;; "Impose the CHARACTER style for call titles.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE TOP10-NOTETITLE-CHAR-STYLE])

(TOP10.NOTE-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 23-Dec-87 11:41 by jds")
          (* ;; "Impose the CHARACTER style for call titles.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE TOP10-NOTE-CHAR-STYLE])

(TOP10.DIAGRAM-STYLE
  [LAMBDA (TEXTSTREAM TEXTOBJ SEL)                       (* ; "Edited 23-Dec-87 11:41 by jds")
          (* ;; "Impose the CHARACTER style for call titles.")

    (TEDIT.LOOKS TEXTOBJ '(STYLE TOP10-DIAGRAM-CHAR-STYLE])

(TOP10.INIT
  [LAMBDA NIL                                            (* ; "Edited  5-Jan-88 12:26 by jds")
(* ;;; "Attach TOP-10 formatting operations to META- command keys")
          (* ;; "Meta-digits format diagrams of corresponding size:")

    (TEDIT.SETFUNCTION (CHARCODE %##1)
           (FUNCTION CALL.1DIAGRAM))
    (TEDIT.SETFUNCTION (CHARCODE %##2)
           (FUNCTION CALL.2DIAGRAM))
    (TEDIT.SETFUNCTION (CHARCODE %##3)
           (FUNCTION CALL.3DIAGRAM))
    (TEDIT.SETFUNCTION (CHARCODE %##4)
           (FUNCTION CALL.4DIAGRAM))
    (TEDIT.SETFUNCTION (CHARCODE %##5)
           (FUNCTION CALL.5DIAGRAM))
    (TEDIT.SETFUNCTION (CHARCODE %##6)
           (FUNCTION CALL.6DIAGRAM))
          (* ;; "META-A formats a CALL DEFINITION heading")

    (TEDIT.SETFUNCTION (CHARCODE %##A)
           (FUNCTION CALL.HEAD))
    (TEDIT.SETFUNCTION (CHARCODE %##a)
           (FUNCTION CALL.HEAD))
          (* ;; "META-S formatsother paragraphs:")

    (TEDIT.SETFUNCTION (CHARCODE %##S)
           (FUNCTION CALL.OTHERPARA))
    (TEDIT.SETFUNCTION (CHARCODE %##s)
           (FUNCTION CALL.OTHERPARA))
          (* ;; "META-G will set the page layout for a NEW TOP10 FILE:")

    (TEDIT.SETFUNCTION (CHARCODE %##G)
           (FUNCTION TOP10.PAGELAYOUT))
    (TEDIT.SETFUNCTION (CHARCODE %##g)
           (FUNCTION TOP10.PAGELAYOUT))
          (* ;; "Meta Q W E R T  set char styles for")
          (* ;; "Q - call name")

    (TEDIT.SETFUNCTION (CHARCODE %##q)
           (FUNCTION TOP10.CALLNAME-STYLE))
    (TEDIT.SETFUNCTION (CHARCODE %##Q)
           (FUNCTION TOP10.CALLNAME-STYLE))
          (* ;; "W - Call defn body")

    (TEDIT.SETFUNCTION (CHARCODE %##w)
           (FUNCTION TOP10.CALLDEFN-STYLE))
    (TEDIT.SETFUNCTION (CHARCODE %##W)
           (FUNCTION TOP10.CALLDEFN-STYLE))
          (* ;; "E - Note Head")

    (TEDIT.SETFUNCTION (CHARCODE %##e)
           (FUNCTION TOP10.NOTEHEAD-STYLE))
    (TEDIT.SETFUNCTION (CHARCODE %##E)
           (FUNCTION TOP10.NOTEHEAD-STYLE))
          (* ;; "R - Note body")

    (TEDIT.SETFUNCTION (CHARCODE %##r)
           (FUNCTION TOP10.NOTE-STYLE))
    (TEDIT.SETFUNCTION (CHARCODE %##R)
           (FUNCTION TOP10.NOTE-STYLE))
          (* ;; "T - diagram captions")

    (TEDIT.SETFUNCTION (CHARCODE %##t)
           (FUNCTION TOP10.DIAGRAM-STYLE))
    (TEDIT.SETFUNCTION (CHARCODE %##T)
           (FUNCTION TOP10.DIAGRAM-STYLE))
          (* ;; "SPACE - turns off all styling.")

    (TEDIT.SETFUNCTION (CHARCODE %##SPACE)
           (FUNCTION TOP10.NO-STYLE])
)



(* ;; "Support for character styles used in the Top10 mss.")

(DEFINEQ

(TOP10-DIAGRAM-CHAR-STYLE
  [LAMBDA (LOOKS PC TEXTOBJ)                          (* ; "Edited 15-Mar-88 00:57 by Sybalsky")
          (* ;; 
 "Character Style function for Top10 diagrams -- sets the font always to the proper size & weigth.")

    (TOP10-APPLY-CHAR-STYLE LOOKS PC TEXTOBJ *TOP10-DIAGRAM-CHAR-STYLE-SPEC* 
           *TOP10-DIAGRAM-CHAR-STYLE-ALIST*])

(TOP10-CALLTITLE-CHAR-STYLE
  [LAMBDA (LOOKS PC TEXTOBJ)                          (* ; "Edited 15-Mar-88 00:57 by Sybalsky")
          (* ;; "Character Style function for Top10 call titles -- sets the font always to the proper size & weigth.")

    (TOP10-APPLY-CHAR-STYLE LOOKS PC TEXTOBJ *TOP10-CALLTITLE-CHAR-STYLE-SPEC* 
           *TOP10-CALLTITLE-CHAR-STYLE-ALIST*])

(TOP10-MAINPARA-CHAR-STYLE
  [LAMBDA (LOOKS PC TEXTOBJ)                          (* ; "Edited 15-Mar-88 00:58 by Sybalsky")
          (* ;; "Character Style function for Top10 main-definition paragraphs -- sets the font always to the proper size & weigth.")

    (TOP10-APPLY-CHAR-STYLE LOOKS PC TEXTOBJ *TOP10-MAINPARA-CHAR-STYLE-SPEC* 
           *TOP10-MAINPARA-CHAR-STYLE-ALIST*])

(TOP10-NOTETITLE-CHAR-STYLE
  [LAMBDA (LOOKS PC TEXTOBJ)                          (* ; "Edited 15-Mar-88 00:59 by Sybalsky")
          (* ;; "Character Style function for Top10 note para title run-in heads. -- sets the font always to the proper size & weigth.")

    (TOP10-APPLY-CHAR-STYLE LOOKS PC TEXTOBJ *TOP10-NOTETITLE-CHAR-STYLE-SPEC* 
           *TOP10-NOTETITLE-CHAR-STYLE-ALIST*])

(TOP10-NOTE-CHAR-STYLE
  [LAMBDA (LOOKS PC TEXTOBJ)                          (* ; "Edited 15-Mar-88 00:51 by Sybalsky")
          (* ;; 
    "Character Style function for Top10 notes -- sets the font always to the proper size & weigth.")

    (TOP10-APPLY-CHAR-STYLE LOOKS PC TEXTOBJ *TOP10-NOTE-CHAR-STYLE-SPEC* 
           *TOP10-NOTE-CHAR-STYLE-ALIST*])
)

(DEFMACRO TOP10-APPLY-CHAR-STYLE (LOOKS PIECE TEXTOBJ STYLE-SPEC STYLE-ALIST)
          (* ;; "For applying character styles in a style function.")

   `[COND
       ((CDR (ASSOC ,LOOKS ,STYLE-ALIST))                    (* ; 
                                                           "There's a cached value.  Use it.")
        )
       (T                                                    (* ; 
                                                       "No cached value, create one, and cache it.")
          (CL:PUSH (CONS ,LOOKS (\TEDIT.PARSE.CHARLOOKS.LIST ,STYLE-SPEC ,LOOKS ,TEXTOBJ))
                 ,STYLE-ALIST)
          (CDR (ASSOC ,LOOKS ,STYLE-ALIST])




(* ;; "Initial style definitions:")

(DECLARE%: DOEVAL@COMPILE DONTCOPY

(GLOBALVARS *TOP10-DIAGRAM-CHAR-STYLE-SPEC* *TOP10-CALLTITLE-CHAR-STYLE-SPEC* 
       *TOP10-MAINPARA-CHAR-STYLE-SPEC* *TOP10-NOTE-CHAR-STYLE-SPEC* *TOP10-DIAGRAM-CHAR-STYLE-SPEC* 
       *TOP10-NOTETITLE-CHAR-STYLE-SPEC*)
)



(* ;; "ALists for converting charlooks to styled looks.  Reset these lists to enforce new styles:")

(DECLARE%: DOEVAL@COMPILE DONTCOPY

(GLOBALVARS *TOP10-DIAGRAM-CHAR-STYLE-ALIST* *TOP10-CALLTITLE-CHAR-STYLE-ALIST* 
       *TOP10-MAINPARA-CHAR-STYLE-ALIST* *TOP10-NOTE-CHAR-STYLE-ALIST* 
       *TOP10-DIAGRAM-CHAR-STYLE-ALIST* *TOP10-NOTETITLE-CHAR-STYLE-ALIST*)
)



(* ;; "  Fns for changing to readable sizes:")

(DEFINEQ

(TOP10-BIG-STYLES
  [LAMBDA NIL                                         (* ; "Edited 15-Mar-88 00:45 by Sybalsky")
          (* ;; "Set all Top10 styles to be readable size.")

    (SETQ *TOP10-CALLTITLE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 10))
    (SETQ *TOP10-MAINPARA-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 10))
    (SETQ *TOP10-NOTE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 10))
    (SETQ *TOP10-NOTETITLE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 10))
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 6 WEIGHT BOLD UNDERLINE OFF))
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-CALLTITLE-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-MAINPARA-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-NOTE-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-NOTETITLE-CHAR-STYLE-ALIST* NIL])

(TOP10-PRINT-STYLES
  [LAMBDA NIL                                         (* ; "Edited 15-Mar-88 00:45 by Sybalsky")
          (* ;; "Set all top10 styles to their rendering sizes for printing.")

    (SETQ *TOP10-CALLTITLE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 9 WEIGHT BOLD UNDERLINE OFF))
    (SETQ *TOP10-MAINPARA-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 9))
    (SETQ *TOP10-NOTE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 7))
    (SETQ *TOP10-NOTETITLE-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 7 WEIGHT BOLD))
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-SPEC* '(FAMILY OPTIMA SIZE 6 WEIGHT BOLD UNDERLINE OFF))
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-CALLTITLE-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-MAINPARA-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-NOTE-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-DIAGRAM-CHAR-STYLE-ALIST* NIL)
    (SETQ *TOP10-NOTETITLE-CHAR-STYLE-ALIST* NIL)
    (SETQ *DANCER-FONT-SIZE* 10])
)



(* ;; "Initialize the styles:")

(TOP10-BIG-STYLES)
(DEFINEQ

(XPS.COVER.PARA
  [LAMBDA (TEXTOBJ SEL)                                  (* jds "20-Nov-85 15:20")
(* Assure that SEL covers a span of WHOLE paragraphs.
Expand it to do so, if need be.)
    (PROG [[CH1 (CAR (\TEDIT.PARABOUNDS TEXTOBJ (fetch CH# of SEL]
           (CHLIM (CDR (\TEDIT.PARABOUNDS TEXTOBJ (SUB1 (fetch CHLIM of SEL]
          (TEDIT.SETSEL TEXTOBJ CH1 (ADD1 (IDIFFERENCE CHLIM CH1])
)



(* ; "From XPSEDIT formatter.")

(DEFINEQ

(CRAM-DOC
  [LAMBDA (FILE OUTFILE)                                 (* ; "Edited 28-Dec-87 12:42 by jds")
          (* ;; "Take one ovf Bill's editor files and make it readable to me")

    (LET (CH CH2)
         (CL:WITH-OPEN-FILE (IN FILE)
                (CL:WITH-OPEN-STREAM (OUT (OPENSTREAM OUTFILE 'OUTPUT 'NEW))
                       (while (NOT (EOFP IN))
                          do (SETQ CH (BIN IN))
                                (SELECTQ CH
                                    (12                      (* ; "%"New Column%"")
                                        (BOUT OUT (CHARCODE CR)))
                                    (140                     (* ; "Some variant on first-column?")
                                         (BOUT OUT (CHARCODE CR)))
                                    ((156 175 135 131)       (* ; "Not sure what this does.")
                                                             (* ; "Bold-on?"))
                                    ((169 170)               (* ; "N dash")
                                         (BOUT OUT (CHARCODE -)))
                                    (13 (BOUT OUT (CHARCODE SPACE)))
                                    (220                     (* ; 
                                         "Skip to next 12 on input file, insert CR in output file.")
                                         (repeatwhile (CL:/= CH 220) do (SETQ CH (BIN IN))))
                                    (225                     (* ; 
                                                    "Skip to next 10 in input, insert CR in output")
                                         (BIN IN)
                                         (BIN IN)
                                         (BOUT OUT (CHARCODE -)))
                                    (236                     (* ; 
                                                  "Skip to next 135 in input, insert CR in output.")
                                         (SETQ CH2 (BIN IN))
                                         (BIN IN)
                                         (BIN IN))
                                    (10                      (* ; "LF is para  sseparator")
                                        (BOUT OUT (CHARCODE CR)))
                                    (169 (BOUT OUT (CHARCODE -)))
                                    (96                      (* ; "open dbl quote")
                                        (COND
                                           ((= (\PEEKBIN IN)
                                               96)
                                            (BIN IN)
                                            (BOUT OUT 170))))
                                    (39                      (* ; "close dbl quote")
                                        (COND
                                           ((= (\PEEKBIN IN)
                                               39)
                                            (BIN IN)
                                            (BOUT OUT 186))))
                                    (124                     (* ; "1/2")
                                         (BOUT OUT 189))
                                    (123                     (* ; "1/4")
                                         (BOUT OUT 188))
                                    (125                     (* ; "3/4")
                                         (BOUT OUT 190))
                                    (BOUT OUT CH])

(FILE-TO-WP
  [LAMBDA (FILE OFILE)                                   (* ; "Edited 11-Dec-87 16:29 by jds")
    (LET ((TS (OPENTEXTSTREAM FILE)))
         (CL:WITH-OPEN-STREAM (OUT (OPEN OFILE :DIRECTION :OUTPUT :IF-EXISTS :NEW-VERSION))
                (TEDIT.EXTERNAL.FORM (TEXTOBJ TS)
                       OUT))
         (CLOSEF TS])

(CHC
  [LAMBDA (STREAM TEXTOBJ SEL)                           (* ; "Edited  4-Dec-87 11:32 by jds")
    (LET ((STR (TEDIT.SEL.AS.STRING STREAM SEL)))
         (PRINTOUT TT (CHCON STR)
                T T])
)



(* ; "For converting from WP format on PC")

(DEFINEQ

(TEDIT.EXTERNAL.FORM
  [LAMBDA (TEXTOBJ OFILE UNFORMATTED? SEPARATEFORMAT)    (* ; "Edited 11-Dec-87 16:18 by jds")
          (* ;; "Put a representation of the piece table onto OFILE, preserving font changes and paragraph looks.  UNFORMATTED?  means write no font or formatting info.")

    (PROG (OCURSOR CH PC PFILE PSTR POBJ OFILELEN OLDLOOKS (OLDPARALOOKS (fetch FMTSPEC
                                                                            of TEXTOBJ))
                 (*READTABLE* *TEDIT-FILE-READTABLE*)
                 (*PRINT-BASE* 10)
                 OLDCH# CURCH# PREVPC FONTFILE (PCCOUNT 0)
                 TRUEFILE CHARLOOKSLST PARALOOKSLST (TEDIT.PUT.FINISHEDFORMS NIL)
                 (EDITSTENTATIVE (TEXTPROP TEXTOBJ 'TEDIT.TENTATIVE))
                 (PARALOOKSSEEN NIL)
                 (FORMATTINGLEVEL (TEDIT.FORMATTEDFILEP TEXTOBJ))
                 (CACHE (TEXTPROP TEXTOBJ 'CACHE))
                 CH#S PREVFATP PARAHASH LOOKSHASH PREVPREVPC)
          (replace (STREAM LINELENGTH) of OFILE with MAX.SMALLP)
                                                             (* ; 
                                     "Prevent spurious carriage-returns in the piece descriptions.")
          (SETQ PC (\EDITELT (fetch PCTB of TEXTOBJ)
                          (ADD1 \FirstPieceOffset)))         (* ; "First piece in the document")
          (SETQ OLDLOOKS (create CHARLOOKS))             (* ; "Starting looks")
          (\TEDIT.FLUSH.UNUSED.LOOKS TEXTOBJ PC)             (* ; 
                        "Run thru the lists of char & para looks and remove any that aren't in use")
          (COND
             ([AND (fetch TXTPARALOOKSLIST of TEXTOBJ)
                   (OR (IGREATERP (FLENGTH (fetch TXTPARALOOKSLIST of TEXTOBJ))
                              1)
                       (NOT (EQFMTSPEC (CAR (fetch TXTPARALOOKSLIST of TEXTOBJ))
                                   TEDIT.DEFAULT.FMTSPEC]
          (* ;; "There are paragraph looks in this document that don't match the default -- save the list of them for later retrieval.")

              (SETQ PARAHASH (TEDIT.EXT.PARALOOKS OFILE (fetch TXTPARALOOKSLIST of 
                                                                                              TEXTOBJ
                                                                   )))
              (SETQ PARALOOKSSEEN T)))
          [COND
             ((OR PARALOOKSSEEN FORMATTINGLEVEL)
          (* ;; "There are character looks in this document that don't match the default (or paragraph formatting, which forces looks to be saved) -- save the list for later retrieval.")
                                                             (* ; 
                                                          "Open a font-info file if one is needed.")
              (SETQ LOOKSHASH (TEDIT.EXT.CHARLOOKS OFILE (fetch TXTCHARLOOKSLIST of
                                                                                         TEXTOBJ]
          (while PC do [COND
                                  ([AND (NOT (ZEROP (fetch PLEN of PC)))
                                        (NOT (EQCLOOKS OLDLOOKS (fetch PLOOKS of PC]
                                   [OR LOOKSHASH (SETQ LOOKSHASH (TEDIT.EXT.CHARLOOKS
                                                                  OFILE
                                                                  (fetch TXTCHARLOOKSLIST
                                                                     of TEXTOBJ]
                                   (CL:FORMAT OFILE "@F(~D)" (GETHASH (fetch PLOOKS of PC)
                                                                    LOOKSHASH))
                                   (SETQ OLDLOOKS (fetch PLOOKS of PC]
                              (COND
                                 ([AND (NOT (ZEROP (fetch PLEN of PC)))
                                       (OR (NOT PREVPC)
                                           (fetch PPARALAST of PREVPC))
                                       (OR PARALOOKSSEEN (NOT (EQFMTSPEC (fetch PPARALOOKS
                                                                            of PC)
                                                                     (fetch FMTSPEC of 
                                                                                              TEXTOBJ
                                                                            ]
                                                             (* ; 
                                     "The last piece ended a paragraph, so send out new para looks")
                                  (CL:FORMAT OFILE "@P(~D)" (GETHASH (fetch PPARALOOKS
                                                                        of PC)
                                                                   PARAHASH))
                                  (SETQ PARALOOKSSEEN T)     (* ; 
           "Remember that we've seen a foreign paralooks, and must henceforth note para boundaries")
                                  ))
                              (COND
                                 ((fetch POBJ of PC) (* ; 
                                                           "It's an object -- go use its PUTFN")
                                  (TEDIT.EXT.OBJECT OFILE (fetch (PIECE POBJ) of PC))
                                                             (* ; "Send out the object")
                                  )) 
          (* ;; "Now dump out the non-object contents of the piece:")

                              (COND
                                 ((AND PREVPC PC (EQ (fetch PFATP of PREVPC)
                                                     (fetch PFATP of PC)))
                                                             (* ; "Nothing further to do.")
                                  )
                                 [(AND PREVPC (fetch PFATP of PREVPC))
                                  (COND
                                     ((fetch PFATP of PC))
                                     (T                      (* ; "Switching from FAT to thin")
                                        (BOUT OFILE 255)
                                        (BOUT OFILE 0]
                                 ((fetch PFATP of PC)(* ; "Switching from thin to fat")
                                  (BOUT OFILE 255)
                                  (BOUT OFILE 255)
                                  (BOUT OFILE 0)))
                              [COND
                                 [(SETQ PFILE (fetch PFILE of PC))
                                                             (* ; "It's on a file.  Copy it.")
                                  [OR (OPENP PFILE)
                                      (replace PFILE of PC with (SETQ PFILE
                                                                             (\TEDIT.REOPEN.STREAM
                                                                              TEXTOBJ PFILE]
                                                             (* ; "Make sure the file is open.")
                                  (COPYBYTES PFILE OFILE (fetch PFPOS of PC)
                                         (IPLUS (fetch PFPOS of PC)
                                                (COND
                                                   ((fetch PFATP of PC)
                                                             (* ; 
                                     "For fat file pieces, copy twice as many bytes as characters.")
                                                    (UNFOLD (fetch PLEN of PC)
                                                           2))
                                                   (T (fetch PLEN of PC]
                                 ((SETQ PSTR (fetch PSTR of PC))
                                                             (* ; 
                                                           "It's in a string.  Just print it.")
                                  (COND
                                     [(fetch PFATP of PC)
                                                             (* ; 
                                            "The string is fat: Copy twice as many bytes as chars.")
                                      (for I from 1 to (fetch PLEN of PC)
                                         as CH instring PSTR do (\BOUT OFILE (\CHARSET CH))
                                                                       (\BOUT OFILE (\CHAR8CODE
                                                                                     CH]
                                     (T                      (* ; 
                                                   "The string is thin.  Just copy it to the file.")
                                        (for I from 1 to (fetch PLEN of PC)
                                           as CH instring PSTR do (\BOUT OFILE CH]
                              (SETQ PREVPC PC)
                              (SETQ PC (fetch NEXTPIECE of PC])

(TEDIT.EXT.PARALOOKS
  [LAMBDA (FILE LOOKSLIST)                               (* ; "Edited 10-Dec-87 10:04 by jds")
                                                             (* ; 
                                                   "Write the list of FMTSPECs into the font file.")
    (PROG ((LOOKSHASH (HASHARRAY 50)))
          (PRIN1 "(PARAGRAPH-LOOKS " FILE)
          (for I from 1 as LOOKS in LOOKSLIST do (PRIN1 (
                                                                        \TEDIT.UNPARSE.PARALOOKS.LIST
                                                                             LOOKS)
                                                                            FILE) 
                                                             (* ; "Write out the description")
                                                                    (PUTHASH LOOKS I LOOKSHASH) 
                                                             (* ; 
                                      "And save it in the hash table so people can find its index.")
                 )
          (PRIN1 ")

" FILE)
          (RETURN LOOKSHASH])

(TEDIT.EXT.CHARLOOKS
  [LAMBDA (FILE LOOKSLIST)                               (* ; "Edited 10-Dec-87 09:41 by jds")
          (* ;; "Write the list of CHARLOOKSs into the font file.")
          (* ;; "Returns a hasharray that will map from a given CHARLOOKS to that CHARLOOKS' position in the list we wrote on the file.  Those position numbers are then written in the individual looks descriptions, and are used to reconstruct the piece looks when the file is read back in.")

    (PROG ((LOOKSHASH (HASHARRAY 50)))                       (* ; 
                                                        "How many CHARLOOKSs there are in the list")
          (PRIN1 "(FONTS " FILE)
          (for I from 1 as LOOKS in LOOKSLIST do 
                                                             (* ; 
                                      "Write each charlooks, in the order they appear in the list.")
                                                                    (PRIN1 (
                                                                        \TEDIT.UNPARSE.CHARLOOKS.LIST
                                                                            LOOKS)
                                                                           FILE) 
                                                             (* ; "Write out the description")
                                                                    (PUTHASH LOOKS I LOOKSHASH) 
                                                             (* ; 
                                      "And save it in the hash table so people can find its index.")
                 )
          (PRIN1 ")

" FILE)
          (RETURN LOOKSHASH])

(TEDIT.EXT.OBJECT
  [LAMBDA (FILE OBJECT)                                  (* ; "Edited 11-Dec-87 15:22 by jds")
    (LET (PLIST)
         (SELECTQ (fetch (IMAGEFNS DISPLAYFN) of (fetch (IMAGEOBJ IMAGEOBJFNS)
                                                            of OBJECT))
             (DANCEROBJ.DISPLAYFN 
                  (SETQ PLIST (COPY (fetch (IMAGEOBJ IMAGEOBJPLIST) of OBJECT)))
                  [COND
                     ((LISTGET PLIST 'BOUNDBOX)              (* ; "Remove the boundbox property")
                      (SETQ PLIST (LDIFFERENCE PLIST (LIST 'BOUNDBOX (LISTGET PLIST 'BOUNDBOX]
                  (PRINTOUT FILE "@PIC" PLIST))
             (HELP "UNKNOWN OBJECT TYPE"])
)



(* ; "For writing a WP-able version of TEdit files.")

(DEFINEQ

(SPELLING-CORRECT
  [LAMBDA (TEXTOBJ)                                   (* ; "Edited 15-Mar-88 00:09 by Sybalsky")
    (LET ((TEXTOBJ (TEXTOBJ TEXTOBJ))
          CORRECTION-LIST)
         (CL:WITH-OPEN-FILE (IN "{DSK}<LISPFILES>TOP10-87>ADMIN>SPELLING-CORRECTION-LIST" 
                                   :DIRECTION :INPUT)
                (SETQ CORRECTION-LIST (READ IN)))
         (for CORRECTION in CORRECTION-LIST do (TEDIT.SETSEL TEXTOBJ 1
                                                                  (fetch (TEXTOBJ TEXTLEN)
                                                                     of TEXTOBJ)
                                                                  NIL NIL)
                                                          (TEDIT.SUBSTITUTE TEXTOBJ (CAR CORRECTION)
                                                                 (CADR CORRECTION)
                                                                 NIL])
)



(* ; "For fixing common errors in TOP10 documents.")


(RPAQQ *TOP10-FILES* 
       (Front-Back>Inner-Cover.TEDIT Front-Back>Introduction.TEDIT Front-Back>TOP10-CONTENTS.TEDIT 
              FREQUENCY.TEDIT DICTIONARIES>DICT-PREFACE.TEDIT DICTIONARIES>MSDICT-A-G.TEDIT 
              DICTIONARIES>MSDICT-H-P.TEDIT DICTIONARIES>MSDICT-R-S.TEDIT 
              DICTIONARIES>MSDICT-T-Z.TEDIT DICTIONARIES>PLUSDICT.TEDIT 
              DICTIONARIES>ADV-PREFACE.TEDIT DICTIONARIES>ADVDICT-A-M.TEDIT 
              DICTIONARIES>ADVDICT-N-Z.TEDIT DICTIONARIES>C1-PREFACE.TEDIT 
              DICTIONARIES>C1DEFNS-A-H.TEDIT DICTIONARIES>C1DEFNS-I-R.TEDIT 
              DICTIONARIES>C1DEFNS-S.TEDIT DICTIONARIES>C1DEFNS-T-Z.TEDIT 
              DICTIONARIES>C2DEFNS-A-E.TEDIT DICTIONARIES>C2DEFNS-F-O.TEDIT 
              >DICTIONARIES>C2DEFNS-P-S.TEDIT DICTIONARIES>C2DEFNS-T-Z.TEDIT FRA>FORMATION-DICT.TEDIT 
              FRA>ARRANGEMENTS.TEDIT FRA>FRA.TEDIT FRA>ARRANGE-2FLINES.TEDIT FRA>ARRANGE-8CHAIN.TEDIT 
              FRA>ARRANGE-DIAMOND.TEDIT FRA>ARRANGE-LINES.TEDIT FRA>ARRANGE-QTAG.TEDIT 
              FRA>ARRANGE-WAVES.TEDIT))

(RPAQQ *TOP10-ERIS-FILES* 
       ({ERIS}<SYBALSKY>TOP10-87>TOP10-CONTENTS.TEDIT {ERIS}<SYBALSKY>TOP10-87>FREQUENCY.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>DICT-PREFACE.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-A-G.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-H-P.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-R-S.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-T-Z.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>PLUSDICT.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADV-PREFACE.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-A-M.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-N-Z.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1-PREFACE.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-A-H.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-I-R.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-S.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-T-Z.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-A-E.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-F-O.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-P-S.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-T-Z.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>FORMATION-DICT.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGEMENTS.TEDIT {ERIS}<SYBALSKY>TOP10-87>FRA>FRA.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-2FLINES.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-8CHAIN.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-DIAMOND.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-LINES.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-QTAG.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-WAVES.TEDIT))

(RPAQQ *TOP10-ERIS-PART1* ({ERIS}<SYBALSKY>TOP10-87>TOP10-CONTENTS.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>FREQUENCY.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>DICT-PREFACE.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-A-G.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-H-P.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-R-S.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>MSDICT-T-Z.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>PLUSDICT.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADV-PREFACE.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-A-M.TEDIT 
                                     {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>ADVDICT-N-Z.TEDIT))

(RPAQQ *TOP10-ERIS-PART2* 
       ({ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1-PREFACE.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-A-H.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-I-R.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-S.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C1DEFNS-T-Z.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-A-E.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-F-O.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-P-S.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>DICTIONARIES>C2DEFNS-T-Z.TEDIT 
              ERISS}<SYBALSKY>CALENDAR.DATABASEATION-DICT.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGEMENTS.TEDIT {ERIS}<SYBALSKY>TOP10-87>FRA>FRA.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-2FLINES.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-8CHAIN.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-DIAMOND.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-LINES.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-QTAG.TEDIT 
              {ERIS}<SYBALSKY>TOP10-87>FRA>ARRANGE-WAVES.TEDIT))
(TEDIT.SETFUNCTION (CHARCODE "##^S")
       (FUNCTION SPELLING-CORRECT))



(* ;;; "Page layout of 3, 3x5 cards per page with heading and 2 columns per card.")


(RPAQ TOP10-FRAMES 
      [TEDIT.PARSE.PAGEFRAMES '(LIST ((PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                       (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                            (0 0 612 792)
                                            ((FOLIO NIL
                                                    (PARALOOKS (QUAD CENTERED)
                                                           CHARLOOKS
                                                           (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                  OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                  OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                  UNDERLINE OFF EXPANSION REGULAR 
                                                                  SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                  OFF USERINFO NIL STYLE NIL)
                                                           FORMATINFO
                                                           (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                    (108 36 288 36)
                                                    NIL)
                                             (TEXT NIL NIL (36 36 210 540)
                                                   NIL)
                                             (TEXT NIL NIL (258 36 210 540)
                                                   NIL)))
                                      (PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                       (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                            (0 0 612 792)
                                            ((FOLIO NIL
                                                    (PARALOOKS (QUAD CENTERED)
                                                           CHARLOOKS
                                                           (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                  OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                  OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                  UNDERLINE OFF EXPANSION REGULAR 
                                                                  SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                  OFF USERINFO NIL STYLE NIL)
                                                           FORMATINFO
                                                           (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                    (108 36 288 36)
                                                    NIL)
                                             (TEXT NIL NIL (36 36 210 540)
                                                   NIL)
                                             (TEXT NIL NIL (258 36 210 540)
                                                   NIL)))
                                      (PAGE NIL (PAPERSIZE Letter LANDSCAPE? T FOLIOINFO
                                                       (ERISIC "ÿï%ÿ " "ÿï%ÿ "))
                                            (0 0 612 792)
                                            ((FOLIO NIL
                                                    (PARALOOKS (QUAD CENTERED)
                                                           CHARLOOKS
                                                           (SUPERSCRIPT 0 INVISIBLE OFF SELECTPOINT 
                                                                  OFF PROTECTED OFF SIZE 6 FAMILY 
                                                                  OPTIMA OVERLINE OFF STRIKEOUT OFF 
                                                                  UNDERLINE OFF EXPANSION REGULAR 
                                                                  SLOPE ITALIC WEIGHT BOLD INVERTED 
                                                                  OFF USERINFO NIL STYLE NIL)
                                                           FORMATINFO
                                                           (ARABIC "ÿï%ÿ " "ÿï%ÿ "))
                                                    (108 36 288 36)
                                                    NIL)
                                             (TEXT NIL NIL (36 36 210 540)
                                                   NIL)
                                             (TEXT NIL NIL (258 36 210 540)
                                                   NIL])
(TOP10.INIT)

(PUTPROPS FORMATTINGFNS FILETYPE CL:COMPILE-FILE)
(PUTPROPS FORMATTINGFNS COPYRIGHT ("Xerox Corporation" 1987 1988))
(DECLARE%: DONTCOPY
  (FILEMAP (NIL (15668 28962 (CALL.HEAD 15678 . 16659) (CALL.OTHERPARA 16661 . 17608) (CALL.1DIAGRAM 
17610 . 18559) (CALL.2DIAGRAM 18561 . 19606) (CALL.3DIAGRAM 19608 . 20700) (CALL.4DIAGRAM 20702 . 
21945) (CALL.5DIAGRAM 21947 . 23194) (CALL.6DIAGRAM 23196 . 24567) (TOP10.PAGELAYOUT 24569 . 24861) (
TOP10.CALLNAME-STYLE 24863 . 25121) (TOP10.CALLDEFN-STYLE 25123 . 25380) (TOP10.NO-STYLE 25382 . 25597
) (TOP10.NOTEHEAD-STYLE 25599 . 25857) (TOP10.NOTE-STYLE 25859 . 26108) (TOP10.DIAGRAM-STYLE 26110 . 
26365) (TOP10.INIT 26367 . 28960)) (29032 31007 (TOP10-DIAGRAM-CHAR-STYLE 29042 . 29427) (
TOP10-CALLTITLE-CHAR-STYLE 29429 . 29817) (TOP10-MAINPARA-CHAR-STYLE 29819 . 30219) (
TOP10-NOTETITLE-CHAR-STYLE 30221 . 30627) (TOP10-NOTE-CHAR-STYLE 30629 . 31005)) (32434 34235 (
TOP10-BIG-STYLES 32444 . 33294) (TOP10-PRINT-STYLES 33296 . 34233)) (34295 34739 (XPS.COVER.PARA 34305
 . 34737)) (34780 38942 (CRAM-DOC 34790 . 38366) (FILE-TO-WP 38368 . 38721) (CHC 38723 . 38940)) (
38995 52182 (TEDIT.EXTERNAL.FORM 39005 . 48503) (TEDIT.EXT.PARALOOKS 48505 . 49687) (
TEDIT.EXT.CHARLOOKS 49689 . 51434) (TEDIT.EXT.OBJECT 51436 . 52180)) (52245 53240 (SPELLING-CORRECT 
52255 . 53238)))))
STOP
