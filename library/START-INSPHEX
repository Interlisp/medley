(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "INTERLISP" BASE 10)

(FILECREATED " 5-Nov-2025 23:12:38" {DSK}<home>frank>il>medley>library>START-INSPHEX.;5 2142   

      :EDIT-BY "FGH"

      :CHANGES-TO (FNS START-INSPHEX)
                  (VARS START-INSPHEXCOMS)
                  (FUNCTIONS TmpShellWget)

      :PREVIOUS-DATE " 5-Nov-2025 19:57:59" {DSK}<home>frank>il>medley>library>START-INSPHEX.;1)


(PRETTYCOMPRINT START-INSPHEXCOMS)

(RPAQQ START-INSPHEXCOMS ((FUNCTIONS TmpShellWget)
                          (FNS START-INSPHEX)
                          (P (START-INSPHEX))))

(CL:DEFUN TmpShellWget (URL OUTFILENAME)
   (LET* ((WGET (ShellWhich "wget"))
          (OUTNAME (OUTFILEP OUTFILENAME))
          (UNIXNAME (LET [(UN (UNIX-FILE-NAME OUTNAME 'OUTPUT]
                         (if (STREQUAL (SUBSTRING UN (NCHARS UN))
                                    ".")
                             then (SUBSTRING UN 1 -2)
                           else UN)))
          (CMD (CONCAT WGET " " URL " -O " UNIXNAME)))
         (if (NULL WGET)
             then (ERROR "ShellWget - wget not available"))
         (ShellCommand CMD)
         OUTNAME))
(DEFINEQ

(START-INSPHEX
  [LAMBDA NIL                                                (* ; "Edited  5-Nov-2025 23:09 by FGH")
    (LET ((INSPHEX.FILE (CONCAT LOGINDIR ">INSPHEX"))
          INSPHEX.DFASL)
         (TmpShellWget "https://raw.githubusercontent.com/pamoroso/insphex/refs/heads/main/INSPHEX" 
                INSPHEX.FILE)
         (SETQ INSPHEX.DFASL (CL:COMPILE-FILE INSPHEX.FILE))
         (LOAD INSPHEX.DFASL)
         [ADVISE '(TEDIT IN INSPHEX::CREATE-HEX-WINDOW)
                'BEFORE
                '(SETQ WINDOW (CREATEW (CREATEREGION (FIX (TIMES 0.25 SCREENWIDTH))
                                              (FIX (TIMES 0.25 SCREENHEIGHT))
                                              (FIX (TIMES 0.5 SCREENWIDTH))
                                              (FIX (TIMES 0.5 SCREENHEIGHT]
         (ADD.PROCESS '(INSPHEX:HEXDUMP INSPHEX.DFASL T])
)

(START-INSPHEX)
(DECLARE%: DONTCOPY
  (FILEMAP (NIL (608 1201 (TmpShellWget 608 . 1201)) (1202 2098 (START-INSPHEX 1212 . 2096)))))
STOP
