(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "11-Jun-90 16:38:11" {DSK}<usr>local>lde>lispcore>library>KERMITMENU.;3 12714        changes to%:  (FILES KERMIT)                    (VARS KERMITMENUCOMS)      previous date%: "20-Apr-90 19:11:09" {DSK}<usr>local>lde>lispcore>library>KERMITMENU.;2)(* ; "Copyright (c) 1985, 1986, 1990 by Venue & Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT KERMITMENUCOMS)(RPAQQ KERMITMENUCOMS       [(COMS               (* ;; "Interactive menu facility for Kermit")              [INITVARS (KERMIT.FMENU.SPEC '((PROPS FONT (MODERN 10 BOLD))                                             ((LABEL "Send!" MESSAGE                                                "Sends the specified local file to be stored remotely"                                                     SELECTEDFN KERMIT.MENU.STORE)                                              (LABEL "Receive!" MESSAGE                                                "Receives a remote file into the specified local file"                                                     SELECTEDFN KERMIT.MENU.RETRIEVE)                                              (LABEL "Bye!" MESSAGE                                                      "Forces remote Kermit server to exit" SELECTEDFN                                                     KERMIT.MENU.BYE)                                              (LABEL "Exit!" MESSAGE "Closes this menu" SELECTEDFN                                                      KERMIT.MENU.EXIT))                                             ((TYPE DISPLAY LABEL "Transfer mode: ")                                              (TYPE NWAY COLLECTION MODE LABEL Kermit FONT                                                    (MODERN 10))                                              (TYPE NWAY COLLECTION MODE LABEL Modem FONT                                                    (MODERN 10)))                                             ((TYPE EDITSTART LABEL "Local file:" LINKS (EDIT                                                                                             LOCALFILE                                                                                              ))                                              (TYPE EDIT ID LOCALFILE LABEL "" FONT (MODERN 10)))                                             ((TYPE EDITSTART LABEL "Remote file:" LINKS (EDIT                                                                                            REMOTEFILE                                                                                               ))                                              (TYPE EDIT LABEL "" ID REMOTEFILE FONT (MODERN 10)))                                             ((TYPE STATE LABEL "File type:" ID FILETYPE MENUITEMS                                                    (Binary Text)                                                    MENUFONT                                                    (MODERN 10)                                                    INITSTATE Text LINKS (DISPLAY FILETYPEDISPLAY))                                              (TYPE DISPLAY ID FILETYPEDISPLAY MAXWIDTH 40 FONT                                                    (MODERN 10)                                                    LABEL Text)                                              (TYPE STATE LABEL "End-of-line Convention:" ID                                                     EOLCONVENTION MENUITEMS (CR LF CRLF)                                                    MENUFONT                                                    (MODERN 10)                                                    INITSTATE CRLF LINKS (DISPLAY                                                                                 EOLCONVENTIONDISPLAY)                                                    )                                              (TYPE DISPLAY ID EOLCONVENTIONDISPLAY MAXWIDTH 30 FONT                                                    (MODERN 10)                                                    LABEL CRLF]              (GLOBALVARS KERMIT.FMENU.SPEC)              (FNS KERMIT.MENU.ABORT KERMIT.MENU.BYE KERMIT.MENU.EXIT KERMIT.MENU.OPEN                    KERMIT.MENU.RETRIEVE KERMIT.MENU.STORE)              (FILES FREEMENU KERMIT)              (P (COND ((NOT (FASSOC 'Kermit CHATMENUITEMS))                        (push CHATMENUITEMS '(Kermit (FUNCTION KERMIT.MENU.OPEN)                                                    "Opens a kermit command menu"))                        (SETQ CHATMENU NIL)))                 (COND ((AND (BOUNDP 'TEDITCHAT.MENUITEMS)                             (NOT (FASSOC 'Kermit TEDITCHAT.MENUITEMS)))                        (push TEDITCHAT.MENUITEMS '(Kermit (FUNCTION KERMIT.MENU.OPEN)                                                          "Opens a kermit command menu"))                        (SETQ TEDITCHAT.MENU NIL])(* ;; "Interactive menu facility for Kermit")(RPAQ? KERMIT.FMENU.SPEC       '((PROPS FONT (MODERN 10 BOLD))         ((LABEL "Send!" MESSAGE "Sends the specified local file to be stored remotely" SELECTEDFN                  KERMIT.MENU.STORE)          (LABEL "Receive!" MESSAGE "Receives a remote file into the specified local file" SELECTEDFN                 KERMIT.MENU.RETRIEVE)          (LABEL "Bye!" MESSAGE "Forces remote Kermit server to exit" SELECTEDFN KERMIT.MENU.BYE)          (LABEL "Exit!" MESSAGE "Closes this menu" SELECTEDFN KERMIT.MENU.EXIT))         ((TYPE DISPLAY LABEL "Transfer mode: ")          (TYPE NWAY COLLECTION MODE LABEL Kermit FONT (MODERN 10))          (TYPE NWAY COLLECTION MODE LABEL Modem FONT (MODERN 10)))         ((TYPE EDITSTART LABEL "Local file:" LINKS (EDIT LOCALFILE))          (TYPE EDIT ID LOCALFILE LABEL "" FONT (MODERN 10)))         ((TYPE EDITSTART LABEL "Remote file:" LINKS (EDIT REMOTEFILE))          (TYPE EDIT LABEL "" ID REMOTEFILE FONT (MODERN 10)))         ((TYPE STATE LABEL "File type:" ID FILETYPE MENUITEMS (Binary Text)                MENUFONT                (MODERN 10)                INITSTATE Text LINKS (DISPLAY FILETYPEDISPLAY))          (TYPE DISPLAY ID FILETYPEDISPLAY MAXWIDTH 40 FONT (MODERN 10)                LABEL Text)          (TYPE STATE LABEL "End-of-line Convention:" ID EOLCONVENTION MENUITEMS (CR LF CRLF)                MENUFONT                (MODERN 10)                INITSTATE CRLF LINKS (DISPLAY EOLCONVENTIONDISPLAY))          (TYPE DISPLAY ID EOLCONVENTIONDISPLAY MAXWIDTH 30 FONT (MODERN 10)                LABEL CRLF))))(DECLARE%: DOEVAL@COMPILE DONTCOPY(GLOBALVARS KERMIT.FMENU.SPEC))(DEFINEQ(KERMIT.MENU.ABORT  [LAMBDA (ITEM WINDOW BUTTON)                           (* jow "24-Jun-86 14:42")         (* * Called to kill the active Kermit/Modem process)    (LET [(PROC (WINDOWPROP (MAINWINDOW WINDOW)                       'KERMITPROC]         (COND            ((AND (PROCESSP PROC)                  (NOT (RELPROCESSP PROC))                  (MOUSECONFIRM "Are you sure?"))             (PROCESS.EVAL PROC '(ERROR!])(KERMIT.MENU.BYE  [LAMBDA (ITEM WINDOW BUTTON)                           (* jow "24-Jun-86 15:30")    (LET ((STATE (FM.GETSTATE WINDOW)))         (SELECTQ (FM.ITEMPROP (LISTGET STATE 'MODE)                         'LABEL)             (Kermit (KERMIT.SERVER.COMMAND KERMIT.GENERIC.SERVER.COMMAND 'F (MAINWINDOW WINDOW)))             (Modem (printout (GETPROMPTWINDOW (MAINWINDOW WINDOW))                           T "This command only works in Kermit mode."))             NIL])(KERMIT.MENU.EXIT  [LAMBDA (ITEM WINDOW BUTTON)                           (* jow "25-Jun-86 17:16")    (REMOVEWINDOW WINDOW])(KERMIT.MENU.OPEN  [LAMBDA (CHAT.STATE)                                   (* jow "26-Jun-86 15:38")    (LET ((MAINWINDOW (fetch (CHAT.STATE WINDOW) of CHAT.STATE))          (FMENU (FREEMENU KERMIT.FMENU.SPEC "Kermit/Modem Settings")))         (WINDOWPROP FMENU 'FM.PROMPTWINDOW (GETPROMPTWINDOW MAINWINDOW))         (WINDOWPROP FMENU 'FM.DONTRESHAPE T)         [WINDOWPROP FMENU 'MINSIZE (CONS (fetch (REGION WIDTH) of (WINDOWPROP FMENU                                                                                  'REGION))                                          (fetch (REGION HEIGHT) of (WINDOWPROP FMENU                                                                                   'REGION]         (ATTACHWINDOW FMENU MAINWINDOW 'TOP 'JUSTIFY 'LOCALCLOSE)         (WINDOWPROP FMENU 'REJECTMAINCOMS '(SHAPEW))         (WINDOWADDPROP MAINWINDOW 'RESHAPEFN 'REPOSITIONATTACHEDWINDOWS])(KERMIT.MENU.RETRIEVE  [LAMBDA (ITEM WINDOW BUTTON)                           (* jow "25-Jun-86 17:15")    (LET ((STATE (FM.GETSTATE WINDOW))          ABORTWINDOW)         (WINDOWPROP (MAINWINDOW WINDOW)                'KERMITPROC                (THIS.PROCESS))         (DSPFILL NIL HIGHLIGHTSHADE 'PAINT WINDOW)         (ATTACHWINDOW [SETQ ABORTWINDOW (FREEMENU '(((LABEL "Button here to abort file transfer"                                                              FONT (MODERN 10 BOLD)                                                             SELECTEDFN KERMIT.MENU.ABORT]                (MAINWINDOW WINDOW)                'TOP                'LEFT)         (RESETLST             [RESETSAVE NIL (LIST (FUNCTION (LAMBDA NIL                                              (WINDOWPROP (MAINWINDOW WINDOW)                                                     'KERMITPROC NIL)                                              (REMOVEWINDOW ABORTWINDOW)                                              (FM.REDISPLAYMENU WINDOW]             (SELECTQ (FM.ITEMPROP (LISTGET STATE 'MODE)                             'LABEL)                 (Kermit [KERMIT.RECEIVE (LISTGET STATE 'REMOTEFILE)                                (LISTGET STATE 'LOCALFILE)                                (MAINWINDOW WINDOW)                                (U-CASE (LISTGET STATE 'FILETYPE])                 (Modem (MODEM.RECEIVE (LISTGET STATE 'LOCALFILE)                               (MAINWINDOW WINDOW)                               (U-CASE (LISTGET STATE 'FILETYPE))                               (LISTGET STATE 'EOLCONVENTION)))                 NIL))])(KERMIT.MENU.STORE  [LAMBDA (ITEM WINDOW BUTTON)                           (* jow "25-Jun-86 17:15")    (LET ((STATE (FM.GETSTATE WINDOW))          ABORTWINDOW)         (WINDOWPROP (MAINWINDOW WINDOW)                'KERMITPROC                (THIS.PROCESS))         (DSPFILL NIL HIGHLIGHTSHADE 'PAINT WINDOW)         (ATTACHWINDOW [SETQ ABORTWINDOW (FREEMENU '(((LABEL "Button here to abort file transfer"                                                              FONT (MODERN 10 BOLD)                                                             SELECTEDFN KERMIT.MENU.ABORT]                (MAINWINDOW WINDOW)                'TOP                'LEFT)         (RESETLST             [RESETSAVE NIL (LIST (FUNCTION (LAMBDA NIL                                              (WINDOWPROP (MAINWINDOW WINDOW)                                                     'KERMITPROC NIL)                                              (REMOVEWINDOW ABORTWINDOW)                                              (FM.REDISPLAYMENU WINDOW]             (SELECTQ (FM.ITEMPROP (LISTGET STATE 'MODE)                             'LABEL)                 (Kermit [KERMIT.SEND (LISTGET STATE 'LOCALFILE)                                (LISTGET STATE 'REMOTEFILE)                                (MAINWINDOW WINDOW)                                (U-CASE (LISTGET STATE 'FILETYPE])                 (Modem (MODEM.SEND (LISTGET STATE 'LOCALFILE)                               (MAINWINDOW WINDOW)                               (U-CASE (LISTGET STATE 'FILETYPE))                               (LISTGET STATE 'EOLCONVENTION)))                 NIL))]))(FILESLOAD FREEMENU KERMIT)(COND   ((NOT (FASSOC 'Kermit CHATMENUITEMS))    (push CHATMENUITEMS '(Kermit (FUNCTION KERMIT.MENU.OPEN)                                    "Opens a kermit command menu"))    (SETQ CHATMENU NIL)))(COND   ((AND (BOUNDP 'TEDITCHAT.MENUITEMS)         (NOT (FASSOC 'Kermit TEDITCHAT.MENUITEMS)))    (push TEDITCHAT.MENUITEMS '(Kermit (FUNCTION KERMIT.MENU.OPEN)                                          "Opens a kermit command menu"))    (SETQ TEDITCHAT.MENU NIL)))(PUTPROPS KERMITMENU COPYRIGHT ("Venue & Xerox Corporation" 1985 1986 1990))(DECLARE%: DONTCOPY  (FILEMAP (NIL (6730 12102 (KERMIT.MENU.ABORT 6740 . 7190) (KERMIT.MENU.BYE 7192 . 7688) (KERMIT.MENU.EXIT 7690 . 7829) (KERMIT.MENU.OPEN 7831 . 8775) (KERMIT.MENU.RETRIEVE 8777 . 10442) (KERMIT.MENU.STORE 10444 . 12100)))))STOP