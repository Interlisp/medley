(DEFINE-FILE-INFO §PACKAGE "INTERLISP" §READTABLE "INTERLISP" §BASE 10)
(FILECREATED " 4-Feb-87 19:32:44" {ERIS}<IRIS>NEXT>IRISVIEW.;18 65298  

      changes to%:  (VARS IRISVIEWCOMS)
                    (FNS IV.SET.CURRENT.SCENE IV.SCENE.SETUP IV.INIT IV.VIEW.CHANGED IRIS.DEGREES 
                         IV.ENSURE.SCENE IV.REDEFINE.SCENE IV.DOUBLEBUFFER IV.AXES IV.NEWSTREAM 
                         IV.BACKGROUND IV.DSPCOLOR IV.RIGHT IV.UP IV.TOWARD IV.PHOME.AUX IV.PHOME 
                         IV.2D.HOME)
                    (VARIABLES *IV-COMMANDS-MENUDESC* *IV-FILLINS-MENUDESC* 
                           *IV-POSITIONING-MENU-DESC* *IV-MENUDESC*)

      previous date%: "27-Jan-87 01:16:23" {ERIS}<IRIS>NEXT>IRISVIEW.;10)


(* "
Copyright (c) 1985, 1987 by Xerox Corporation.  All rights reserved.
")

(PRETTYCOMPRINT IRISVIEWCOMS)

(RPAQQ IRISVIEWCOMS 
       [(FILES IRISCONSTANTS COLOROBJ)
        (GLOBALVARS IV.CURRENT.SCENE IV.SCENES IV.SCENES.MENU IV.VIEW.MENU IV.PROMPTWINDOW AXES.SCENE 
               SKULL.SCENE \IV.DRAW.AXES iV.BACKGROUND IV.MODE IV.THETA IV.DXLATE)
        (INITVARS (IV.SCENES NIL)
               (IV.CURRENT.SCENE)
               (IV.SCENES.MENU)
               (IV.VIEW.MENU))
        (BITMAPS IV.LEFT IV.POS IV.RIGHT IV.RIGHT.HIGHLIGHT IV.DOWN IV.UP IV.UP.HIGHLIGHT 
               BACKGROUNDBITMAP IV.ROTX IV.ROTX.HIGHLIGHT IV.ROTY IV.ROTY.HIGHLIGHT IV.ROTZ 
               IV.ROTZ.HIGHLIGHT IV.ROTATE IV.DELTA.LABEL IV.THETA.LABEL IV.TOWARD 
               IV.TOWARD.HIGHLIGHT IV.AWAY)
                                                             (* ; "fns for co-ordinating scenes")
        (FNS IV.PROOF.SCENE IV.ENSURE.SCENE IV.NEW.SCENE.FROM.USER IV.REDEFINE.SCENE IV.CHOOSE.SCENE 
             IV.BUILD.SCENES.MENU IV.FORGET.SCENE IV.DRAW.SCENE IV.SET.CURRENT.SCENE IV.SCENE.SETUP)
        (FNS DRAW.AXES F IV.CLEARIRIS IV.DOWN IV.GETINPUT IV.READ IV.HOME IV.2D.HOME IV.PHOME 
             IV.PHOME.AUX IV.VIEW IV.LEFT IV.RIGHT IV.ROTX IV.DOUBLEBUFFER IV.ROTY IV.ROTZ 
             IV.SWAPBUFFERS IV.UP IV.THETA IV.AXES IV.BACKGROUND IV.TOWARD IV.AWAY IV.DSPCOLOR 
             IV.DELTA IV.VIEW.CHANGED IV.NEWSTREAM IV.PROMPTPRINT IV.PROOF.SKETCH IV.INIT \CLEAR.IRIS 
             IRIS.DEGREES)
        (FNS IV.ITEMMAPFN IV.DISPLAY.FMITEM)
        (RECORDS IRISSCENE IVPOS)
        (VARS HANDWIDTH IRIS.XAXIS IRIS.ZAXIS IV.DXLATE IV.MODE IV.OBJPT IV.THETA IV.TRACE.FNS 
              IV.TWIST IV.VIEWPT LASTIV.OBJPT LASTIV.VIEWPT (\IV.DRAW.AXES)
              (\IV.BACKGROUND))
        (P (IV.SCENE.SETUP)
           (IV.BUILD.SCENES.MENU))
        (FNS SKULLO)
          
          (* ;; "The order of these variables is important.")

        (VARIABLES *IV-SCENES-MENUDESC* *IV-FILLINS-MENUDESC* *IV-COMMANDS-MENUDESC* 
               *IV-POSITIONING-MENU-DESC* *IV-MENUDESC*)
        (PROP FILETYPE IRISVIEW)
        (DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDVARS (NLAMA)
                                                                             (NLAML)
                                                                             (LAMA IV.PROMPTPRINT])
(FILESLOAD IRISCONSTANTS COLOROBJ)
(DECLARE%: DOEVAL@COMPILE DONTCOPY

(GLOBALVARS IV.CURRENT.SCENE IV.SCENES IV.SCENES.MENU IV.VIEW.MENU IV.PROMPTWINDOW AXES.SCENE 
       SKULL.SCENE \IV.DRAW.AXES iV.BACKGROUND IV.MODE IV.THETA IV.DXLATE)
)

(RPAQ? IV.SCENES NIL)

(RPAQ? IV.CURRENT.SCENE )

(RPAQ? IV.SCENES.MENU )

(RPAQ? IV.VIEW.MENU )

(RPAQQ IV.LEFT #*(48 24)@@@L@@@@@@@@@@ACH@@@@@@@@@A@F@@@@@@@@@@HAH@@@@@@@@@F@F@@@@@@@@@ALAH@@@@@@@@@B@L@@@@@GOOOO@GH@@@@H@@@@@@F@@@@H@@@@@@ACO@@H@@@@@@@N@@@GOOO@@@@B@@@@@D@@@@@B@@@@@H@@@@@B@@@@@H@@@@@B@@@@@GOH@@@B@@@@@B@@@@@B@@@@@D@@@@@B@@@@@D@@@@@B@@@@@CON@@@B@@@@@A@@@@@B@@@@@B@@@@AN@@@@@B@@@@NAH@@@@AOOOO@@G@@
)

(RPAQQ IV.POS (275 . 200))

(RPAQQ IV.RIGHT #*(48 24)@@@@@@@@C@@@@@@@@@@ALH@@@@@@@@@F@H@@@@@@@@AHA@@@@@@@@@F@F@@@@@@@@AHCH@@@@@@@@C@D@@@@@@@@AN@OOOON@@@@F@@@@@@A@@OLH@@@@@@A@@@G@@@@@@@A@@@D@@@@OOON@@@D@@@@@B@@@@@D@@@@@A@@@@@D@@@@@A@@@@@D@@@AON@@@@@D@@@@@D@@@@@D@@@@@B@@@@@D@@@@@B@@@@@D@@@GOL@@@@@D@@@@@H@@@@@GH@@@@D@@@@AHG@@@@D@@@@N@@OOOOH@@
)

(RPAQQ IV.RIGHT.HIGHLIGHT #*(48 24)@@@@@@@@C@@@@@@@@@@AOH@@@@@@@@@GOH@@@@@@@@AOO@@@@@@@@@GON@@@@@@@@AOOH@@@@@@@@GOL@@@@@@@@AOOOOOON@@@@GOOOOOOO@@OLOOOOOOOO@@@GOOOOOOOO@@@GOOOOOOON@@@GOOOOON@@@@@GOOOOOO@@@@@GOOOOOO@@@@@GOOOOON@@@@@GOOOOOL@@@@@GOOOOON@@@@@GOOOOON@@@@@GOOOOOL@@@@@GOOOOOH@@@@@GOOOOOL@@@@AHGOOOOL@@@@N@@OOOOH@@
)

(RPAQQ IV.DOWN #*(24 48)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@D@@A@@@@D@@A@@@@D@@A@@@@D@@B@@@@D@@B@@@@GOOL@@@@B@@D@@@@B@@D@@@@D@@D@@@@H@@B@@@@H@@B@@@A@@@B@@@A@@@A@@@A@@@A@@@C@@@A@@@F@@@A@@@D@@@A@@@H@@@A@@@H@@@A@@A@@@@A@@AA@@@A@@BC@@AA@@BE@@AA@@DE@AAA@@DEAAAA@@DIAAAA@@HIAAAA@@IAAAAA@@FAAAAI@@@AAAIF@@@AAIF@@@@AAF@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@@N@@@@@
)

(RPAQQ IV.UP #*(24 48)@@N@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AA@@@@@@AAF@@@@@AAIF@@@@AAAIF@@FAAAAI@@IAAAAA@@HIAAAA@@DIAAAA@@DEAAAA@@DE@AAA@@BE@@AA@@BC@@AA@@AA@@@A@@A@@@@A@@@H@@@A@@@H@@@A@@@D@@@A@@@F@@@A@@@C@@@A@@@A@@@A@@@A@@@A@@@A@@@B@@@@H@@B@@@@H@@B@@@@D@@D@@@@B@@D@@@@B@@D@@@@GOOL@@@@D@@B@@@@D@@B@@@@D@@A@@@@D@@A@@@@D@@A@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.UP.HIGHLIGHT #*(24 48)@@N@@@@@@AO@@@@@@AO@@@@@@AO@@@@@@AO@@@@@@AO@@@@@@AO@@@@@@AO@@@@@@AOF@@@@@AOOF@@@@AOOOF@@FAOOOO@@OAOOOO@@OIOOOO@@GIOOOO@@GMOOOO@@GMOOOO@@CMOOOO@@COOOOO@@AOOOOO@@AOOOOO@@@OOOOO@@@OOOOO@@@GOOOO@@@GOOOO@@@COOOO@@@AOOOO@@@AOOOO@@@AOOON@@@@OOON@@@@OOON@@@@GOOL@@@@COOL@@@@COOL@@@@GOOL@@@@D@@B@@@@D@@B@@@@D@@A@@@@D@@A@@@@D@@A@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ BACKGROUNDBITMAP #*(12 15)@@@@CKN@EOB@IFH@JFH@BF@@BD@@@D@@@D@@@B@@@CF@@CN@@ON@AON@@@@@)

(RPAQQ IV.ROTX #*(28 47)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@G@@@@@@AHL@@@@@B@B@@@@@D@A@@@@@D@A@@@@@H@@H@@@@H@@H@@@A@@@D@@@A@@@D@@@A@@@D@@@A@@@D@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@@B@@BB@@@B@@CBF@@B@@AJL@@B@@@OH@@A@@@F@@@A@@@D@@@A@@@D@@@A@@@D@@@@H@@H@@@@H@@H@@@@D@A@@@@@D@A@@@@@B@B@@@@@AHL@@@@@@G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTX.HIGHLIGHT #*(28 47)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@G@@@@@@AOL@@@@@CON@@@@@GOO@@@@@GOO@@@@@OOOH@@@@OOOH@@@AOOOL@@@AOOOL@@@AOOOL@@@AOOOL@@@COOON@@@COOON@@@COOON@@@COOON@@@COOON@@@COOON@@@COOON@@@COOON@@@COOONF@@COOONL@@COOOOH@@AOOON@@@AOOOL@@@AOOOL@@@AOOOL@@@@OOOH@@@@OOOH@@@@GOO@@@@@GOO@@@@@CON@@@@@AOL@@@@@@G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTY #*(42 30)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OON@@@@@@@@O@@AN@@@@@@C@@@@AH@@@@@L@@@@@F@@@@A@@@@@@A@@@@B@@@@@@@H@@@B@@@@@@@H@@@D@@@@@@@D@@@D@@@@@@@D@@@D@@@@@@@D@@@B@@@@@@@H@@@B@@@@H@@H@@@A@@@AH@A@@@@@L@@C@@F@@@@@C@@F@AH@@@@@@O@LAN@@@@@@@@OON@@@@@@@@@@L@@@@@@@@@@@F@@@@@@@@@@@C@@@@@@@@@@@AH@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTY.HIGHLIGHT #*(42 30)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OON@@@@@@@@OOOON@@@@@@COOOOOH@@@@@OOOOOON@@@@AOOOOOOO@@@@COOOOOOOH@@@COOOOOOOH@@@GOOOOOOOL@@@GOOOOOOOL@@@GOOOOOOOL@@@COOOOOOOH@@@COOOOOOOH@@@AOOOOOOO@@@@@OOOOOON@@@@@COOOOOH@@@@@@OOOON@@@@@@@@OON@@@@@@@@@@L@@@@@@@@@@@F@@@@@@@@@@@C@@@@@@@@@@@AH@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTZ #*(45 38)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@CO@@@@@@@@@AL@O@@@@@@@@F@@@N@@@@@@@H@@@AH@@@@@A@@@@@F@@@@@A@@@@@AOO@@@A@@@@@AL@@@@B@@@@@AB@@@@B@@@@@AA@@@@B@@@@@A@H@@@B@@@@@A@D@@@A@@@@@A@D@@@A@@@@@A@B@@@A@@@@@A@A@@@@H@@@@@@A@@@@D@@@@@@A@@@@D@@@@@@@H@@@B@@@@@@@H@@@A@@@@@@@H@@@@H@@@@@@H@@@@F@@@@@A@@@@@A@@@@@A@@@@@@L@@@@A@@@@@@C@@@@B@@@@@@@N@@@L@@@@@@@AN@G@@@@@@@@@AOH@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTZ.HIGHLIGHT #*(45 38)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@CO@@@@@@@@@AOOO@@@@@@@@GOOON@@@@@@@OOOOOH@@@@@AOOOOON@@@@@AOOOOOOOO@@@AOOOOOOL@@@@COOOOOON@@@@COOOOOOO@@@@COOOOOOOH@@@COOOOOOOL@@@AOOOOOOOL@@@AOOOOOOON@@@AOOOOOOOO@@@@OOOOOOOO@@@@GOOOOOOO@@@@GOOOOOOOH@@@COOOOOOOH@@@AOOOOOOOH@@@@OOOOOOOH@@@@GOOOOOO@@@@@AOOOOOO@@@@@@OOOOOO@@@@@@COOOON@@@@@@@OOOOL@@@@@@@AOOO@@@@@@@@@AOH@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.ROTATE #*(74 77)@@@@@@@@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AL@@@@@@@@@@@@@@@@@@AL@@@@@@@@@@@@@@@@@@BJ@@@@@@@@@@@@@@@@@@BJ@@@@@@@@@@@@@@@@@@DI@@@@@@@@@@@@@@@@@@DI@@@@@@@@@@@@@@@@@@HI@@@@@@@@@@@@@@@@@@HHH@@@@@@@@@@@@@@@@@HHH@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@IB@@@@@@@@@@@@@@@@@@HJ@@@@@@@@@@@@@@@@@@HF@@@@@@@@@@@@@@@@@@HB@@@@@@@@@@@@@@@@@@IB@@@@@@@@@@@@@@@@@@HL@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@@@H@@@@@@HH@@@@@@@@@@@H@@@@@@E@@@@@@@@@@@@H@@@@@@B@N@@@@@@@@@@H@@@@@@E@AH@@@@@@@@@H@@@@@@HH@F@@@@@@@@@H@@@@@@@@@AL@@@@@@@@OOOOOOOOOOOO@@@@@@@A@@@@@@@@@@AL@@@@@@@A@@@@@@@@@@F@@@@@@@@B@@@@@@@@@AH@@@@@@@@D@@@@@@@@@N@@@@@@@@@D@@@@@@@@@@@@@@@AN@@H@@@@@@@@@@@@@@@@B@A@@@@@@@@@@@@@@@@@D@A@@@@@@@@@@@@@@@@@H@B@@@@@@@@@@@@@@@@AN@D@@@@@@@@@@@@@@@@@@@D@@@@@@@@@@@@@@@@@@@H@@@@@@@@@@@@@@@@@AA@@@@@@@@@@@@@@@@@@AA@@@@@@@@@@@@@@@@@@AB@@@@@@@@@@@@@@@@@@BD@@@@@@@@@@@@@@@@@@BDD@@@@@@@@@@@@@@@@@BHH@@@@@@@@@@@@@@@@@EA@@@@@@@@@@@@@@@@@@EF@@@@@@@@@@@@@@@@@@FH@@@@@@@@@@@@@@@@@@M@@@@@@@@@@@@@@@@@@@N@@@@@@@@@@@@@@@@@@@L@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.DELTA.LABEL #*(9 13)@@@@@H@@@H@@AD@@AD@@BB@@BB@@DA@@DA@@GO@@@@@@@@@@@@@@)

(RPAQQ IV.THETA.LABEL #*(7 13)@@@@CH@@DD@@DD@@DD@@GL@@DD@@DD@@DD@@CH@@@@@@@@@@@@@@)

(RPAQQ IV.TOWARD #*(35 38)@@@@@@H@@@@@@@@@@A@@@@@@@@@@@B@@@@@@@G@@@L@@@@@@@DN@CD@@@@@@@FAONF@@@@@@@B@@@B@@@@@@@A@@@C@@@@@@@@L@@A@@@@@@@@CO@@H@@@@@@@@F@@D@@@@@@@@D@@B@@@@@@@@H@@A@@@@@@@A@@@@IB@@@@@B@@@@EN@@@@@D@@@@C@@@@@@HB@@@F@@@@@A@D@@@H@@@@@B@H@@@H@@@@@DA@D@A@@@@@@HB@H@B@@@@@A@DA@HD@@@@@B@JBA@H@@@@@DAALBA@@@@@@HB@DDB@@@@@@HD@GHD@@@@@@GH@@HH@@@@@@@@@@I@@@@@@@@@@@F@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.TOWARD.HIGHLIGHT #*(35 38)@@@@@@H@@@@@@@@@@A@@@@@@@@@@@B@@@@@@@G@@@L@@@@@@@GN@CL@@@@@@@GOOON@@@@@@@COOON@@@@@@@AOOOO@@@@@@@@OOOO@@@@@@@@COOOH@@@@@@@@GOOL@@@@@@@@GOON@@@@@@@@OOOO@@@@@@@AOOOOHB@@@@@COOOOMN@@@@@GOOOOO@@@@@@OOOOON@@@@@AOOOOOH@@@@@COOOOOH@@@@@GOOOOO@@@@@@OOOOON@@@@@AOOOOOL@@@@@COKOOOH@@@@@GOAOOO@@@@@@ON@GON@@@@@@OL@GOL@@@@@@GH@@OH@@@@@@@@@@O@@@@@@@@@@@F@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)

(RPAQQ IV.AWAY #*(36 34)@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@A@@@@@@@@@@@A@@@@@@@@@@@C@@@@@@@@@@@G@@@@@@@@@@@K@@@@@@@@@@AE@@@@@@@@@@BE@@@@@@@@@@@E@@@@@@@@@@@I@@@@@@@@@@@H@@@@@@@@@@@H@@@@@@@@@@A@@@@@@@@@@@A@@@@@@@@@@@A@@@@@@@@@@@B@@@@@@@@@@@B@@@@@@@@@@@B@@@@@@@@@@@D@@@@@@@@@@@D@@@@@@@@@@@D@@@@@@@@@@@H@@@@@@@@@@@H@@@@@@@@@@@H@@@@@@@@@@A@@@@@@@@@@@A@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
)



(* ; "fns for co-ordinating scenes")

(DEFINEQ

(IV.PROOF.SCENE
  [LAMBDA (ITEM)                                             (* gbn "21-Nov-85 01:14")
    (LET ((OBJNO (fetch (IRISSCENE OBJNO) of IV.CURRENT.SCENE)))
         (IV.ENSURE.SCENE IV.CURRENT.SCENE)                  (* makes sure the object is defined)
         (IRIS.CALLOBJ OBJNO \IRISSTREAM)
         (IRIS.SWAPBUFFERS \IRISSTREAM)
         (ALIGN \IRISSTREAM)
         (SPP.FORCEOUTPUT IRISCONN])

(IV.ENSURE.SCENE
  [LAMBDA (SCENE)                                            (* ; "Edited 29-Jan-87 01:22 by gbn")
                                                             (* ; 
                                                        "makes sure that a scene's objno is defined.")
    (LET ((OBJNO (fetch (IRISSCENE OBJNO) of SCENE)))
         (if (ZEROP (IRIS.ISOBJ OBJNO \IRISSTREAM))
             then (IV.PROMPTPRINT "Creating object for " (fetch (IRISSCENE NAME) of SCENE))
                  (RESETLST (RESETSAVE NIL (LIST 'IRIS.CLOSEOBJ \IRISSTREAM))
                         (IRIS.MAKEOBJ OBJNO \IRISSTREAM)
                         (if (SETQ DRAWFN (fetch (IRISSCENE DRAWFN) of SCENE))
                             then (EVAL DRAWFN)
                           else (IV.GETINPUT (CONCAT "Please remake " (fetch (IRISSCENE NAME)
                                                                         of SCENE)
                                                    " then hit RETURN")))
                         (IRIS.CLOSEOBJ \IRISSTREAM))
                  (PRINTOUT IV.PROMPTWINDOW "...done" T])

(IV.NEW.SCENE.FROM.USER
  [LAMBDA NIL                                                (* gbn "20-Nov-85 23:21")
          
          (* * Reads a new scene from the user. Returns NIL if the scene is not 
          completed. Sets the scene menu to nil to cause it to be rebuilt when a new 
          scene is successfully read)

    (PROG (NAME DRAWFN OBJNO SCENE)
          (SETQ NAME (IV.GETINPUT "Scene Name?"))
          (if (NOT NAME)
              then (RETURN))
          (SETQ SCENE (create IRISSCENE
                             NAME _ NAME
                             OBJNO _ (IRIS.CONS.OBJNO)))
          (replace (IRISSCENE DRAWFN) of SCENE with (SETQ DRAWFN (IV.READ 
                                                                     "Form to eval to create scene? "
                                                                        )))
          (if (NOT DRAWFN)
              then (IRIS.MAKEOBJ (fetch (IRISSCENE OBJNO) of SCENE)
                          \IRISSTREAM)
                   (IV.GETINPUT "Make object, then type RETURN")
                   (IRIS.CLOSEOBJ \IRISSTREAM))
          (push IV.SCENES SCENE)
          (SETQ IV.SCENES.MENU NIL)
          (RETURN SCENE])

(IV.REDEFINE.SCENE
  [LAMBDA (ITEM BUTTONS WINDOW)                              (* ; "Edited 29-Jan-87 01:20 by gbn")
    (LET ((SCENE (IV.CHOOSE.SCENE)))
         (if (MOUSECONFIRM (CONCAT "Redefine " (fetch NAME of SCENE))
                    NIL IV.PROMPTWINDOW)
             then (IRIS.DELOBJ (fetch OBJNO of SCENE)
                         \IRISSTREAM)
                  (REPLACE OBJNO OF SCENE WITH (IRIS.CONS.OBJNO))
                  (IV.ENSURE.SCENE SCENE])

(IV.CHOOSE.SCENE
  [LAMBDA NIL                                                (* edited%: "12-Dec-85 20:58")
    (MENU (OR IV.SCENES.MENU (IV.BUILD.SCENES.MENU])

(IV.BUILD.SCENES.MENU
  [LAMBDA NIL                                                (* ; "Edited 23-Jan-87 20:23 by gbn")

(* ;;; "builds the menu used to prompt the user for scenes that can be loaded on the iris.")

    (SETQ IV.SCENES.MENU (create MENU
                                ITEMS _ (CONS '(New% Scene? (IV.NEW.SCENE.FROM.USER)
                                                      "allows specification of a new scene")
                                              (for ENTRY in IV.SCENES
                                                 collect (LIST (fetch (IRISSCENE NAME) of ENTRY)
                                                               (KWOTE ENTRY])

(IV.FORGET.SCENE
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "12-Dec-85 20:58")
    (PROG ((NEWSCENE (IV.CHOOSE.SCENE))
           OBJNO)
          (if NEWSCENE
              then (DREMOVE NEWSCENE IV.SCENES)
                   (if (SETQ OBJNO (fetch (IRISSCENE OBJNO) of NEWSCENE))
                       then (IRIS.DELOBJ OBJNO \IRISSTREAM))
                   (SETQ IV.SCENES.MENU NIL])

(IV.DRAW.SCENE
  [LAMBDA NIL                                                (* gbn "21-Nov-85 02:09")
    (OR IV.CURRENT.SCENE (ERROR "CAN'T DRAW NULL SCENE"))
    (SELECTQ IV.MODE
        (POLAR (IRIS.POLARVIEW IV.DIST IV.AZIM IV.INC IV.TWIST \IRISSTREAM))
        (XLATE NIL)
        (LOOKAT (if (NOT (AND (EQUAL IV.OBJPT LASTIV.OBJPT)
                              (EQUAL IV.VIEWPT LASTIV.VIEWPT)))
                    then                                     (* setup the viewing transformation, 
                                                             since it has changed)
                         (IRIS.LOOKAT (fetch IVX of IV.VIEWPT)
                                (fetch IVX of IV.VIEWPT)
                                (fetch IVY of IV.VIEWPT)
                                (fetch IVZ of IV.OBJPT)
                                (fetch IVY of IV.OBJPT)
                                (fetch IVZ of IV.OBJPT)
                                IV.TWIST \IRISSTREAM)
                         (SETQ LASTIV.OBJPT IV.OBJPT)
                         (SETQ LASTIV.VIEWPT IV.VIEWPT)))
        (ERROR "UNKNOWN IV.MODE"))
    (if \IV.BACKGROUND
        then (\CLEAR.IRIS \IV.BACKGROUND))
    (IRIS.CALLOBJ (fetch (IRISSCENE OBJNO) of IV.CURRENT.SCENE)
           \IRISSTREAM)
    (if \IV.DRAW.AXES
        then (IRIS.CALLOBJ (fetch (IRISSCENE OBJNO) of AXES.SCENE)
                    \IRISSTREAM))
    (IRIS.SWAPBUFFERS \IRISSTREAM)
    (ALIGN \IRISSTREAM])

(IV.SET.CURRENT.SCENE
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited  4-Feb-87 19:28 by gbn")
    (PROG ([NEWSCENE (MENU (OR IV.SCENES.MENU (IV.BUILD.SCENES.MENU]
           SCENEITEM)
          (if NEWSCENE
              then (SETQ IV.CURRENT.SCENE NEWSCENE)
                   (SETQ SCENEITEM (FM.GETITEM 'CURRENTSCENE 'FILL-INS WINDOW))
                   (OR SCENEITEM (ERROR "SCENE ITEM NOT FOUND"))
                   (FM.CHANGESTATE SCENEITEM (fetch (IRISSCENE NAME) of NEWSCENE)
                          WINDOW)                            (* IV.DISPLAY.FMITEM SCENEITEM WINDOW)
                   (IV.PROOF.SCENE SCENEITEM])

(IV.SCENE.SETUP
  [LAMBDA NIL                                                (* ; "Edited  4-Feb-87 19:22 by gbn")
    [IF (NOT (BOUNDP 'AXES.SCENE))
        THEN (SETQ AXES.SCENE (CREATE IRISSCENE
                                     NAME _ 'Axes
                                     OBJNO _ (IRIS.CONS.OBJNO)
                                     DRAWFN _ '(DRAW.AXES 2]
    [IF (NOT (BOUNDP 'SKULL.SCENE))
        THEN (SETQ SKULL.SCENE (CREATE IRISSCENE
                                      NAME _ 'Skull
                                      OBJNO _ (IRIS.CONS.OBJNO)
                                      DRAWFN _ '(SKULLO \IRISSTREAM]
    (PUSHNEW IV.SCENES AXES.SCENE)
    (PUSHNEW IV.SCENES SKULL.SCENE)
    (SETQ IV.CURRENT.SCENE AXES.SCENE])
)
(DEFINEQ

(DRAW.AXES
  [LAMBDA (WIDTH COLOR)                                      (* edited%: "17-Dec-85 18:39")
          
          (* * draws tri-color axes with each axis being 200 in length in the positive 
          direction)

    (IRIS.PUSHATTRIBUTES \IRISSTREAM)
    (IRIS.LINEWIDTH (OR WIDTH 5)
           \IRISSTREAM)
    (IRIS.COLOR (OR COLOR 1)
           \IRISSTREAM)
    (IRIS.MOVE 0 0 0 \IRISSTREAM)
    (IRIS.DRAW 0 0 200 \IRISSTREAM)
    (IRIS.CMOV 0 0 210 \IRISSTREAM)
    (IRIS.CHARSTR "z" \IRISSTREAM)
    (IRIS.COLOR (OR COLOR 2)
           \IRISSTREAM)
    (IRIS.MOVE 0 0 0 \IRISSTREAM)
    (IRIS.DRAW 0 200 0 \IRISSTREAM)
    (IRIS.CMOV 0 210 0 \IRISSTREAM)
    (IRIS.CHARSTR "y" \IRISSTREAM)
    (IRIS.COLOR (OR COLOR 3)
           \IRISSTREAM)
    (IRIS.MOVE 0 0 0 \IRISSTREAM)
    (IRIS.DRAW 200 0 0 \IRISSTREAM)
    (IRIS.CMOV 210 0 0 \IRISSTREAM)
    (IRIS.CHARSTR "x" \IRISSTREAM)
    (IRIS.POPATTRIBUTES \IRISSTREAM)
    (F])

(F
  [LAMBDA NIL                                                (* edited%: "13-Dec-85 18:35")
    (SPP.FORCEOUTPUT IRISCONN])

(IV.CLEARIRIS
  [LAMBDA NIL                                                (* gbn "21-Nov-85 00:51")
    (DSPCOLOR (DICOLOR.FROM.USER T)
           \IRISSTREAM)
    (IRIS.CLEAR \IRISSTREAM)
    (IRIS.SWAPBUFFERS \IRISSTREAM)
    (F])

(IV.DOWN
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 16:01")
    (LET NIL (SELECTQ IV.MODE
                 (POLAR (add IV.AZIM IV.THETA))
                 (XLATE (IRIS.TRANSLATE 0 (IMINUS IV.DXLATE)
                               0 \IRISSTREAM))
                 (PROGN (add (fetch IVX of IV.OBJPT)
                             IV.DXLATE)))
         (IV.DRAW.SCENE])

(IV.GETINPUT
  [LAMBDA (MSG)                                              (* edited%: "21-Aug-85 04:10")
    (CLEARW IV.PROMPTWINDOW)
    (PROG1 (PROMPTFORWORD MSG NIL NIL IV.PROMPTWINDOW NIL 'TTY NIL NIL)
           (WINDOWPROP IV.PROMPTWINDOW 'PROCESS NIL)         (* some random process circularity fix)
           ])

(IV.READ
  [LAMBDA (PROMPT)                                           (* gbn "20-Nov-85 23:19")
    (CLEARW IV.PROMPTWINDOW)
    (PRINTOUT IV.PROMPTWINDOW PROMPT)
    (RESETFORM (TTYDISPLAYSTREAM IV.PROMPTWINDOW)
           (LISPXREAD T T])

(IV.HOME
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 18:31")
    (PROG [(R (FM.ITEMPROP ITEM 'REGION]
          (\FM.HIGHLIGHTITEM ITEM WINDOW)
          (SELECTQ IV.MODE
              (XLATE (IRIS.ORTHO 0 SCREENWIDTH 0 SCREENHEIGHT -5000 5000 IRISCONN)
                     (IV.VIEW))
              (POLAR (IRIS.POLARVIEW 500 0 0 0 \IRISSTREAM))
              (LOOKAT NIL)
              (ERROR "UNKNOWN MODE"))
          (IV.DRAW.SCENE)
          (F])

(IV.2D.HOME
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 18:43 by gbn")
    (PROG [(R (FM.ITEMPROP ITEM 'REGION]
          (\FM.HIGHLIGHTITEM ITEM WINDOW)
          (IRIS.ORTHO 0 SCREENWIDTH 0 SCREENHEIGHT -1000 1000 IRISCONN)
          (IV.DRAW.SCENE)
          (F])

(IV.PHOME
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 18:43 by gbn")
    (PROG [(R (FM.ITEMPROP ITEM 'REGION]
          (\FM.HIGHLIGHTITEM ITEM WINDOW)
          (IV.PHOME.AUX)
          (F])

(IV.PHOME.AUX
  [LAMBDA NIL                                                (* ; "Edited 27-Jan-87 18:31 by gbn")
    (IRIS.ORTHO 0 SCREENWIDTH 0 SCREENHEIGHT -5000 5000 IRISCONN)
    (IRIS.VIEWPORT 0 IRIS.XMAXSCREEN 0 IRIS.YMAXSCREEN IRISCONN)
    (IRIS.PERSPECTIVE (IRIS.DEGREES 45)
           (IQUOTIENT IRIS.XMAXSCREEN IRIS.YMAXSCREEN)
           0 10000 IRISCONN)                                 (* ; 
                                           "The projection (world-space -> eye-space) transformation")
    (IRIS.POLARVIEW 500 (IRIS.DEGREES 45)
           (IRIS.DEGREES 45)
           0 IRISCONN)                                       (* ; 
                                      "the viewing (placing eye-space in world-space) transformation")
    (IV.DRAW.SCENE])

(IV.VIEW
  [LAMBDA (Z)                                                (* edited%: "17-Dec-85 18:32")
    (IRIS.PERSPECTIVE (IRIS.DEGREES 45)
           (IQUOTIENT IRIS.XMAXSCREEN IRIS.YMAXSCREEN)
           0 10000 IRISCONN)
    (IRIS.POLARVIEW (OR Z 1000)
           (IRIS.DEGREES 90)
           (IRIS.DEGREES 90)
           0 IRISCONN])

(IV.LEFT
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 15:59")
    (LET NIL (SELECTQ IV.MODE
                 (POLAR (add IV.AZIM IV.THETA))
                 (XLATE (IRIS.TRANSLATE (IMINUS IV.DXLATE)
                               0 0 \IRISSTREAM))
                 (PROGN (add (fetch IVX of IV.OBJPT)
                             IV.DXLATE)))
         (IV.DRAW.SCENE])

(IV.RIGHT
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 17:55 by gbn")
    (LET ((MOVE (IF (SHIFTDOWNP 'SHIFT)
                    THEN (IMINUS IV.DXLATE)
                  ELSE IV.DXLATE)))
         (IRIS.TRANSLATE MOVE 0 0 \IRISSTREAM)
         (IV.DRAW.SCENE])

(IV.ROTX
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 16:03")
    (IRIS.ROTATE (if (SHIFTDOWNP 'SHIFT)
                     then (MINUS IV.THETA)
                   else IV.THETA)
           IRIS.XAXIS \IRISSTREAM)
    (IV.DRAW.SCENE])

(IV.DOUBLEBUFFER
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 29-Jan-87 00:03 by gbn")
    (PROG [(STATE (FM.ITEMPROP ITEM 'STATE]
          (if STATE
              then (IRIS.DOUBLEBUFFER \IRISSTREAM)
                   (IRIS.FRONTBUFFER 0)
                   (IRIS.BACKBUFFER 1)
                   (IV.PROMPTPRINT "Double buffering.")
            else (IRIS.SINGLEBUFFER \IRISSTREAM)
                 (IRIS.FRONTBUFFER 1)
                 (IRIS.BACKBUFFER 0)
                 (IV.PROMPTPRINT "Single buffering."))
          (IRIS.GCONFIG IRISCONN])

(IV.ROTY
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 16:04")
    (IRIS.ROTATE (if (SHIFTDOWNP 'SHIFT)
                     then (MINUS IV.THETA)
                   else IV.THETA)
           IRIS.YAXIS \IRISSTREAM)
    (IV.DRAW.SCENE])

(IV.ROTZ
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 16:02")
    (IRIS.ROTATE (if (SHIFTDOWNP 'SHIFT)
                     then (MINUS IV.THETA)
                   else IV.THETA)
           IRIS.ZAXIS \IRISSTREAM)
    (IV.DRAW.SCENE])

(IV.SWAPBUFFERS
  [LAMBDA NIL                                                (* gbn "14-Nov-85 18:27")
    (IRIS.SWAPBUFFERS \IRISSTREAM)
    (SPP.FORCEOUTPUT IRISCONN])

(IV.UP
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 17:55 by gbn")
    (LET ((MOVE (IF (SHIFTDOWNP 'SHIFT)
                    THEN (IMINUS IV.DXLATE)
                  ELSE IV.DXLATE)))
         (IRIS.TRANSLATE 0 MOVE 0 \IRISSTREAM)
         (IV.DRAW.SCENE])

(IV.THETA
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 01:13 by gbn")
          
          (* controls whether or not the background is cleared before drawing a scene)

    (LET ((NEW (RNUMBER "Enter new rotation in degrees")))
         (if NEW
             then (SETQ IV.THETA (ITIMES 10 NEW))
                  (FM.CHANGESTATE (FM.GETITEM 'THETA 'FILL-INS WINDOW)
                         NEW WINDOW])

(IV.AXES
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 29-Jan-87 00:17 by gbn")
                                                             (* ; 
                                               "controls whether or not axes are drawn in the scene.")
    (if (FM.ITEMPROP ITEM 'STATE)
        then (SETQ \IV.DRAW.AXES T)
             (IV.ENSURE.SCENE AXES.SCENE)
      else (SETQ \IV.DRAW.AXES))
    (IV.DRAW.SCENE])

(IV.BACKGROUND
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 28-Jan-87 17:01 by gbn")
                                                             (* ; 
                           "controls whether or not the background is cleared before drawing a scene")
    (LET ((NAME-OR-RGB (DICOLOR.FROM.USER T)))
         (SETQ \IV.BACKGROUND (if NAME-OR-RGB
                                  then (\IRIS.ASSURE.COLOR NAME-OR-RGB \IRISSTREAM)
                                else NIL))
         (FM.CHANGELABEL (FM.GETITEM 'BACKGROUND 'FILL-INS WINDOW)
                (if NAME-OR-RGB
                    then (L-CASE (MKSTRING NAME-OR-RGB))
                  else "none")
                WINDOW)
         (IV.DRAW.SCENE])

(IV.TOWARD
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 17:55 by gbn")
    (LET ((MOVE (IF (SHIFTDOWNP 'SHIFT)
                    THEN (IMINUS IV.DXLATE)
                  ELSE IV.DXLATE)))
         (IRIS.TRANSLATE 0 0 MOVE \IRISSTREAM)
         (IV.DRAW.SCENE])

(IV.AWAY
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* edited%: "17-Dec-85 15:39")
    (LET NIL (SELECTQ IV.MODE
                 (POLAR (add IV.AZIM IV.THETA))
                 (XLATE (IRIS.TRANSLATE 0 0 (MINUS IV.DXLATE)
                               \IRISSTREAM))
                 (PROGN (add (fetch IVX of IV.OBJPT)
                             IV.DXLATE)))
         (IV.DRAW.SCENE])

(IV.DSPCOLOR
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 28-Jan-87 17:02 by gbn")

(* ;;; "sets the dspcolor for the stream (foreground color)")

    (LET ((RGB (DICOLOR.FROM.USER T)))
         (if RGB
             then (DSPCOLOR RGB \IRISSTREAM)
                  (FM.CHANGESTATE (FM.GETITEM 'DSPCOLOR 'FILL-INS WINDOW)
                         (if RGB
                             then (L-CASE (MKSTRING RGB))
                           else "none")
                         WINDOW)
           else NIL])

(IV.DELTA
  [LAMBDA (ITEM WINDOW BUTTONS)                              (* ; "Edited 27-Jan-87 01:13 by gbn")
    (LET ((NEW (RNUMBER "Enter new translation value")))
         (if NEW
             then (FM.CHANGESTATE (FM.GETITEM 'DELTA 'FILL-INS WINDOW)
                         (SETQ IV.DXLATE NEW)
                         WINDOW])

(IV.VIEW.CHANGED
  [LAMBDA NIL                                                (* ; "Edited  3-Feb-87 00:00 by gbn")
    'JUNK])

(IV.NEWSTREAM
  [LAMBDA (ITEM BUTTONS WINDOW)                              (* ; "Edited 29-Jan-87 00:59 by gbn")
    (IF (MOUSECONFIRM "kill old stream?  (lose fonts, etc.)" "left to confirm" IV.PROMPTWINDOW)
        THEN (SETQ IRISCONN NIL)
             (OPENIRISSTREAM IRISNSHOSTNUMBER])

(IV.PROMPTPRINT
  [LAMBDA ARGS                                               (* edited%: "21-Aug-85 06:10")
    (CLEARW IV.PROMPTWINDOW)
    (for F from 1 to ARGS do (PRIN1 (ARG ARGS F)
                                    IV.PROMPTWINDOW])

(IV.PROOF.SKETCH
  [LAMBDA (ARGS |...|)                                       (* edited%: "21-Aug-85 10:39")
    (IV.PROMPTPRINT "SKETCHing...")
    (IRIS.SKETCH (PROG1 NIL (GETPOSITION)))
    (ALIGN \IRISSTREAM)
    (IV.PROMPTPRINT "done"])

(IV.INIT
  [LAMBDA (MENU-POSITION)                                    (* ; "Edited  4-Feb-87 19:23 by gbn")

(* ;;; "uses freemenu to build the view controller menu ")

    (LET NIL (if (BOUNDP 'IV.DEMOW)
                 then (CLOSEW IV.DEMOW))
         (MOVEW (SETQ IV.DEMOW (FREEMENU *IV-MENUDESC*))
                MENU-POSITION)
         (SETQ IV.PROMPTWINDOW (GETPROMPTWINDOW IV.DEMOW 2))
         (IV.NEWSTREAM NIL NIL NIL)                          (* ; "INIT LOOKAT PARAMS")
         (SETQ LASTIV.OBJPT (create IVPOS
                                   IVX _ 0
                                   IVY _ 0
                                   IVZ _ 1))
         (SETQ IV.OBJPT (create IVPOS
                               IVX _ 0
                               IVY _ 0
                               IVZ _ 0))
         (SETQ IV.VIEWPT (create IVPOS
                                IVX _ 0
                                IVY _ 0
                                IVZ _ -1000))
         (SETQ LASTIV.VIEWPT (create IVPOS
                                    IVX _ 0
                                    IVY _ 0
                                    IVZ _ -1001))            (* ; 
                                                            "The amount that a translate should move")
         (SETQ IV.DXLATE 10)                                 (* ; "INIT POLAR PARAMS")
         (SETQ IV.DIST 500)
         (SETQ IV.AZIM (SETQ IV.INC (SETQ IV.TWIST 0)))
         (SETQ IV.MODE 'XLATE)
         (IRIS.DOUBLEBUFFER \IRISSTREAM)
         (IV.SCENE.SETUP)
         (IV.ENSURE.SCENE AXES.SCENE)
         (IV.PHOME.AUX)
         (IV.DRAW.SCENE)
         (IV.DRAW.SCENE)
         (IRIS.GCONFIG \IRISSTREAM])

(\CLEAR.IRIS
  [LAMBDA (COLOR)                                            (* gbn "21-Nov-85 02:10")
    (IRIS.PUSHATTRIBUTES \IRISSTREAM)
    (IRIS.COLOR (\IRIS.ASSURE.COLOR COLOR \IRISSTREAM))
    (IRIS.CLEAR \IRISSTREAM)
    (IRIS.POPATTRIBUTES])

(IRIS.DEGREES
  [LAMBDA (DEGREES)                                          (* edited%: "13-Dec-85 18:32")
          
          (* Takes an angle in degrees and returns an angle as the iris likes it
          (tenths))

    (FIX (TIMES DEGREES 10])
)
(DEFINEQ

(IV.ITEMMAPFN
  [LAMBDA (ITEM)                                             (* edited%: "21-Aug-85 02:05")
    (if (EQUAL (FM.ITEMPROP ITEM 'NAME%:)
               NAME)
        then (SETQ RESULT ITEM])

(IV.DISPLAY.FMITEM
  [LAMBDA (ITEM WINDOW)                                      (* gbn "15-Nov-85 12:25")
    (HELP)(* PROG ((STREAM (fetch (FREEMENU STREAM) of
          (WINDOWPROP WINDOW (QUOTE FREEMENU)))) (FONT
          (FM.ITEMPROP ITEM (QUOTE FONT%:))) (REGION
          (FM.ITEMPROP ITEM (QUOTE REGION))) (LABEL
          (FM.ITEMPROP ITEM (QUOTE LABEL)))) (DSPDESTINATION
          (FM.ITEMPROP ITEM (QUOTE BITMAP)) STREAM)
          (DSPXPOSITION 0 STREAM) (DSPYPOSITION (FONTPROP FONT
          (QUOTE DESCENT)) STREAM) (DSPFONT FONT STREAM)
          (PRIN1 LABEL STREAM) (replace (REGION WIDTH) of REGION with
          (STRINGWIDTH LABEL FONT)) (FM.DISPLAYITEM ITEM WINDOW)
          (BLTSHADE WHITESHADE WINDOW (IPLUS (fetch
          (REGION LEFT) of REGION) (fetch (REGION WIDTH) of REGION))
          (fetch (REGION BOTTOM) of REGION) (IDIFFERENCE
          (BITMAPWIDTH (FM.ITEMPROP ITEM (QUOTE BITMAP)))
          (fetch (REGION WIDTH) of REGION)) (BITMAPHEIGHT
          (FM.ITEMPROP ITEM (QUOTE BITMAP)))))
    ])
)
(DECLARE%: EVAL@COMPILE

(RECORD IRISSCENE (NAME DRAWFN OBJNO)
                  OBJNO _ (IRIS.CONS.OBJNO))

(RECORD IVPOS (IVX IVY IVZ))
)

(RPAQQ HANDWIDTH 48)

(RPAQQ IRIS.XAXIS 88)

(RPAQQ IRIS.ZAXIS 90)

(RPAQQ IV.DXLATE 10)

(RPAQQ IV.MODE XLATE)

(RPAQQ IV.OBJPT (0 0 0))

(RPAQQ IV.THETA 50)

(RPAQQ IV.TRACE.FNS (IRIS.POPMATRIX IRIS.ROTATE IRIS.TRANSLATE))

(RPAQQ IV.TWIST 0)

(RPAQQ IV.VIEWPT (0 0 -1000))

(RPAQQ LASTIV.OBJPT (0 0 1))

(RPAQQ LASTIV.VIEWPT (0 0 -1001))

(RPAQQ \IV.DRAW.AXES NIL)

(RPAQQ \IV.BACKGROUND NIL)
(IV.SCENE.SETUP)
(IV.BUILD.SCENES.MENU)
(DEFINEQ

(SKULLO
  [LAMBDA (*STREAM*)
    (FILLCIRCLE 529 377 192.0 '(NIL (255 0 0)) *STREAM*)
    (DRAWCIRCLE 529 377 192.0 '(ROUND 1 (0 255 255)) 'NIL *STREAM*)
    (FILLPOLYGON '((530 . 568)
                   (476 . 562)
                   (426 . 540)
                   (380 . 500)
                   (349 . 445)
                   (337 . 386)
                   (344 . 323)
                   (383 . 250)
                   (436 . 208)
                   (484 . 190)
                   (530 . 184)) '(NIL (0 0 255)) *STREAM*)
    (DRAWLINE 530 568 476 562 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 476 562 426 540 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 426 540 380 500 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 380 500 349 445 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 349 445 337 386 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 337 386 344 323 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 344 323 383 250 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 383 250 436 208 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 436 208 484 190 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 484 190 530 184 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (DRAWLINE 530 184 530 568 '1 'NIL *STREAM* '(0 255 255) 'NIL)
    (FILLCIRCLE 529 417 152.0526 '(NIL (255 255 255)) *STREAM*)
    (DRAWCIRCLE 529 417 152.0526 '(ROUND 1 (255 255 255)) 'NIL *STREAM*)
    (FILLPOLYGON '((639 . 312)
                   (642 . 301)
                   (642 . 291)
                   (640 . 283)
                   (635 . 276)
                   (629 . 273)
                   (620 . 272)
                   (611 . 294)) '(NIL (255 255 255)) *STREAM*)
    (DRAWLINE 639 312 642 301 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 642 301 642 291 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 642 291 640 283 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 640 283 635 276 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 635 276 629 273 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 629 273 620 272 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 620 272 611 294 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 611 294 639 312 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (FILLPOLYGON '((446 . 300)
                   (439 . 271)
                   (439 . 254)
                   (440 . 245)
                   (446 . 236)
                   (455 . 231)
                   (465 . 227)
                   (529 . 220)
                   (602 . 227)
                   (611 . 229)
                   (618 . 236)
                   (622 . 245)
                   (622 . 256)
                   (620 . 271)
                   (615 . 302)) '(NIL (255 255 255)) *STREAM*)
    (DRAWLINE 446 300 439 271 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 439 271 439 254 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 439 254 440 245 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 440 245 446 236 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 446 236 455 231 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 455 231 465 227 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 465 227 529 220 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 529 220 602 227 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 602 227 611 229 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 611 229 618 236 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 618 236 622 245 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 622 245 622 256 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 622 256 620 271 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 620 271 615 302 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 615 302 446 300 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (FILLPOLYGON '((468 . 228)
                   (466 . 222)
                   (468 . 216)
                   (474 . 218)
                   (478 . 212)
                   (481 . 213)
                   (486 . 202)
                   (493 . 205)
                   (499 . 194)
                   (505 . 198)
                   (514 . 186)
                   (522 . 191)
                   (530 . 187)
                   (538 . 192)
                   (546 . 186)
                   (554 . 192)
                   (559 . 190)
                   (566 . 196)
                   (572 . 194)
                   (578 . 202)
                   (584 . 201)
                   (589 . 210)
                   (593 . 209)
                   (598 . 214)
                   (601 . 214)
                   (604 . 219)
                   (600 . 226)) '(NIL (255 255 255)) *STREAM*)
    (DRAWLINE 468 228 466 222 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 466 222 468 216 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 468 216 474 218 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 474 218 478 212 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 478 212 481 213 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 481 213 486 202 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 486 202 493 205 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 493 205 499 194 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 499 194 505 198 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 505 198 514 186 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 514 186 522 191 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 522 191 530 187 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 530 187 538 192 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 538 192 546 186 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 546 186 554 192 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 554 192 559 190 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 559 190 566 196 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 566 196 572 194 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 572 194 578 202 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 578 202 584 201 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 584 201 589 210 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 589 210 593 209 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 593 209 598 214 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 598 214 601 214 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 601 214 604 219 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 604 219 600 226 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 600 226 468 228 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (FILLPOLYGON '((422 . 310)
                   (419 . 298)
                   (419 . 283)
                   (420 . 278)
                   (424 . 274)
                   (431 . 272)
                   (439 . 271)
                   (451 . 292)) '(NIL (255 255 255)) *STREAM*)
    (DRAWLINE 422 310 419 298 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 419 298 419 283 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 419 283 420 278 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 420 278 424 274 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 424 274 431 272 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 431 272 439 271 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 439 271 451 292 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 451 292 422 310 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (FILLCIRCLE 527 419 136.0 '(NIL (255 0 0)) *STREAM*)
    (DRAWCIRCLE 527 419 136.0 '(ROUND 2 (255 255 255)) 'NIL *STREAM*)
    (FILLPOLYGON '((564 . 550)
                   (582 . 544)
                   (609 . 527)
                   (632 . 506)
                   (650 . 478)
                   (662 . 441)
                   (664 . 404)
                   (654 . 369)
                   (638 . 340)
                   (616 . 316)
                   (591 . 299)
                   (565 . 286)
                   (532 . 280)
                   (490 . 286)) '(NIL (0 0 255)) *STREAM*)
    (DRAWLINE 564 550 582 544 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 582 544 609 527 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 609 527 632 506 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 632 506 650 478 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 650 478 662 441 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 662 441 664 404 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 664 404 654 369 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 654 369 638 340 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 638 340 616 316 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 616 316 591 299 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 591 299 565 286 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 565 286 532 280 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 532 280 490 286 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 490 286 564 550 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (FILLPOLYGON '((564 . 550)
                   (560 . 532)
                   (568 . 530)
                   (548 . 492)
                   (574 . 492)
                   (536 . 432)
                   (572 . 433)
                   (522 . 378)
                   (559 . 378)
                   (492 . 286)
                   (510 . 362)
                   (482 . 363)
                   (518 . 418)
                   (496 . 418)
                   (542 . 480)
                   (520 . 480)
                   (554 . 525)
                   (545 . 524)) '(NIL (255 255 255)) *STREAM*)
    (DRAWLINE 564 550 560 532 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 560 532 568 530 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 568 530 548 492 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 548 492 574 492 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 574 492 536 432 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 536 432 572 433 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 572 433 522 378 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 522 378 559 378 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 559 378 492 286 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 492 286 510 362 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 510 362 482 363 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 482 363 518 418 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 518 418 496 418 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 496 418 542 480 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 542 480 520 480 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 520 480 554 525 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 554 525 545 524 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWLINE 545 524 564 550 '1 'NIL *STREAM* '(255 255 255) 'NIL)
    (DRAWCIRCLE 529 417 136.0 '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((420 . 311)
                 (390 . 354)
                 (377 . 415)
                 (387 . 470)
                 (409 . 511)
                 (444 . 542)
                 (488 . 563)
                 (528 . 569)
                 (581 . 559)
                 (630 . 531)
                 (657 . 498)
                 (677 . 453)
                 (679 . 392)
                 (662 . 342)
                 (640 . 312)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((565 . 547)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 565 547 547 522 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((547 . 522)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 547 522 555 522 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((555 . 522)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 555 522 522 478 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((522 . 478)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 522 478 545 479 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((545 . 479)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 545 479 499 416 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((499 . 416)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 499 416 521 416 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((521 . 416)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 521 416 483 362 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((483 . 362)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 483 362 512 360 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((512 . 360)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 512 360 493 285 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((493 . 285)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((566 . 548)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 566 548 562 529 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((562 . 529)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 562 529 570 529 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((570 . 529)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 570 529 550 490 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((550 . 490)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 550 490 575 490 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((575 . 490)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 575 490 538 430 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((538 . 430)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 538 430 573 431 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((573 . 431)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 573 431 526 377 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((526 . 377)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 526 377 561 376 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((561 . 376)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWLINE 561 376 493 285 '2 'NIL *STREAM* '(0 0 0) 'NIL)
    (DRAWCURVE '((493 . 285)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCIRCLE 529 377 192.0 '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((478 . 260)
                 (471 . 258)
                 (462 . 256)
                 (459 . 268)
                 (462 . 283)
                 (457 . 289)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((513 . 256)
                 (520 . 260)
                 (508 . 266)
                 (490 . 267)
                 (481 . 264)
                 (478 . 260)
                 (486 . 258)
                 (499 . 253)) 'T '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((589 . 261)
                 (593 . 261)
                 (605 . 265)
                 (605 . 273)
                 (605 . 285)
                 (605 . 293)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((549 . 253)
                 (545 . 257)
                 (545 . 265)
                 (561 . 267)
                 (569 . 267)
                 (577 . 265)
                 (585 . 261)
                 (589 . 261)
                 (581 . 257)
                 (573 . 257)
                 (561 . 253)
                 (553 . 253)) 'T '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((638 . 312)
                 (640 . 302)
                 (641 . 291)
                 (639 . 280)
                 (629 . 273)
                 (617 . 271)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((619 . 271)
                 (621 . 256)
                 (620 . 240)
                 (611 . 230)
                 (602 . 226)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((438 . 271)
                 (438 . 253)
                 (442 . 240)
                 (453 . 231)
                 (465 . 227)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((421 . 310)
                 (418 . 294)
                 (420 . 276)
                 (431 . 271)
                 (436 . 271)) 'NIL '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((534 . 240)
                 (533 . 234)
                 (534 . 230)
                 (539 . 226)
                 (543 . 232)
                 (540 . 235)) 'T '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((527 . 242)
                 (528 . 236)
                 (527 . 229)
                 (520 . 227)
                 (521 . 234)
                 (524 . 238)) 'T '(ROUND 2 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((465 . 226)
                 (466 . 219)
                 (469 . 215)
                 (472 . 218)
                 (473 . 223)
                 (470 . 228)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((474 . 222)
                 (475 . 215)
                 (478 . 211)
                 (481 . 214)
                 (482 . 219)
                 (479 . 224)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((483 . 219)
                 (486 . 222)
                 (493 . 219)
                 (493 . 213)
                 (493 . 206)
                 (486 . 203)
                 (482 . 209)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((494 . 216)
                 (496 . 219)
                 (501 . 218)
                 (505 . 213)
                 (505 . 203)
                 (505 . 199)
                 (502 . 195)
                 (497 . 195)
                 (495 . 200)
                 (494 . 205)
                 (494 . 210)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((507 . 209)
                 (510 . 213)
                 (517 . 212)
                 (520 . 206)
                 (521 . 199)
                 (521 . 193)
                 (519 . 189)
                 (513 . 186)
                 (509 . 190)
                 (506 . 196)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((523 . 208)
                 (526 . 212)
                 (533 . 211)
                 (536 . 205)
                 (537 . 198)
                 (537 . 192)
                 (535 . 188)
                 (529 . 185)
                 (525 . 189)
                 (522 . 195)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((539 . 208)
                 (542 . 212)
                 (549 . 211)
                 (552 . 205)
                 (553 . 198)
                 (553 . 192)
                 (551 . 188)
                 (545 . 185)
                 (541 . 189)
                 (538 . 195)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((553 . 212)
                 (555 . 215)
                 (560 . 214)
                 (564 . 209)
                 (564 . 199)
                 (564 . 195)
                 (561 . 191)
                 (556 . 191)
                 (554 . 196)
                 (553 . 201)
                 (553 . 206)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((565 . 215)
                 (567 . 218)
                 (572 . 217)
                 (576 . 212)
                 (576 . 202)
                 (576 . 198)
                 (573 . 194)
                 (568 . 194)
                 (566 . 199)
                 (565 . 204)
                 (565 . 209)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((578 . 217)
                 (581 . 220)
                 (588 . 217)
                 (588 . 211)
                 (588 . 204)
                 (581 . 201)
                 (577 . 207)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((588 . 220)
                 (589 . 213)
                 (592 . 209)
                 (595 . 212)
                 (596 . 217)
                 (593 . 222)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*)
    (DRAWCURVE '((596 . 224)
                 (597 . 217)
                 (600 . 213)
                 (603 . 216)
                 (604 . 221)
                 (601 . 226)) 'T '(ROUND 3 (0 0 0)) 'NIL *STREAM*])
)



(* ;; "The order of these variables is important.")


(CL:DEFPARAMETER *IV-SCENES-MENUDESC* `(NIL ((LABEL "Draw Scene" SELECTEDFN IV.PROOF.SCENE HJUSTIFY 
                                                    CENTER))
                                            ((LABEL "Forget Scene" SELECTEDFN IV.FORGET.SCENE 
                                                    HJUSTIFY CENTER))
                                            ((LABEL "Redefine Scene" SELECTEDFN IV.REDEFINE.SCENE 
                                                    HJUSTIFY CENTER))) )


(CL:DEFPARAMETER *IV-FILLINS-MENUDESC* `[(GROUP (PROPS FORMAT TABLE ID FILL-INS)
                                                ((LABEL "Change Scene" SELECTEDFN 
                                                        IV.SET.CURRENT.SCENE)
                                                 (TYPE EDIT ID CURRENTSCENE LABEL "axes" MAXWIDTH 55)
                                                 )
                                                ((LABEL "" TYPE DISPLAY)
                                                 (LABEL "" TYPE DISPLAY))
                                                [(LABEL "Background:" SELECTEDFN IV.BACKGROUND)
                                                 (TYPE EDIT ID BACKGROUND LABEL "black" SELECTEDFN 
                                                       IV.BACKGROUND MAXWIDTH ,(STRINGWIDTH 
                                                                                      ">background<"]
                                                [(LABEL "Foreground:" SELECTEDFN IV.DSPCOLOR)
                                                 (TYPE EDIT ID DSPCOLOR LABEL "red" SELECTEDFN 
                                                       IV.DSPCOLOR MAXWIDTH ,(STRINGWIDTH 
                                                                                    ">background<"]
                                                [(LABEL ,IV.DELTA.LABEL SELECTEDFN IV.DELTA)
                                                 (TYPE EDIT ID DELTA LABEL ,(MKSTRING IV.DXLATE]
                                                ((LABEL ,IV.THETA.LABEL SELECTEDFN IV.THETA)
                                                 (TYPE EDIT ID THETA LABEL ,(MKSTRING IV.THETA]
   )


(CL:DEFPARAMETER *IV-COMMANDS-MENUDESC* `[(GROUP (PROPS FORMAT ROW)
                                                 ((LABEL "New Stream" SELECTEDFN IV.NEWSTREAM 
                                                         HJUSTIFY CENTER))
                                                 ((TYPE TOGGLE LABEL "Axes" SELECTEDFN IV.AXES 
                                                        HJUSTIFY CENTER INITSTATE NIL))
                                                 ((TYPE TOGGLE LABEL "Double Buffer" SELECTEDFN 
                                                        IV.DOUBLEBUFFER HJUSTIFY CENTER INITSTATE T))
                                                 ((TYPE MOMENTARY LABEL "Swap buffers" SELECTEDFN 
                                                        IV.SWAPBUFFERS HJUSTIFY CENTER))
                                                 ((TYPE MOMENTARY LABEL "Clear IRIS" SELECTEDFN 
                                                        IV.CLEARIRIS HJUSTIFY CENTER))
                                                 ((TYPE DISPLAY LABEL ""))
                                                 ,@*IV-SCENES-MENUDESC*
                                                 (,@*IV-FILLINS-MENUDESC*] )


(CL:DEFPARAMETER *IV-POSITIONING-MENU-DESC* `((GROUP (PROPS FORMAT EXPLICIT COORDINATES GROUP BOX 0)
                                                     (LABEL ,IV.TOWARD HIGHLIGHT ,IV.TOWARD.HIGHLIGHT 
                                                            LEFT 0 BOTTOM 0 HELDFN IV.TOWARD)
                                                     (LABEL ,IV.ROTZ HIGHLIGHT ,IV.ROTZ.HIGHLIGHT 
                                                            LEFT ,(IPLUS -10 (BITMAPWIDTH IV.TOWARD)) 
                                                            BOTTOM ,(BITMAPHEIGHT IV.TOWARD) HELDFN 
                                                            IV.ROTZ)
                                                     [TYPE DISPLAY LABEL ,IV.ROTATE LEFT
                                                           ,(IPLUS (BITMAPWIDTH IV.TOWARD)
                                                                   (IQUOTIENT (BITMAPWIDTH IV.ROTZ)
                                                                          2)) BOTTOM
                                                           ,(IPLUS (BITMAPHEIGHT IV.ROTZ)
                                                                   (BITMAPHEIGHT IV.TOWARD]
                                                     (LABEL ,IV.RIGHT HIGHLIGHT ,IV.RIGHT.HIGHLIGHT 
                                                            LEFT ,(IPLUS (BITMAPWIDTH IV.TOWARD)
                                                                         (IQUOTIENT (BITMAPWIDTH
                                                                                     IV.ROTZ)
                                                                                2)
                                                                         (BITMAPWIDTH IV.ROTATE)
                                                                         (BITMAPWIDTH IV.ROTX)) 
                                                            BOTTOM ,(IPLUS (BITMAPHEIGHT IV.ROTZ)
                                                                           (BITMAPHEIGHT IV.TOWARD)
                                                                           20) HELDFN IV.RIGHT)
                                                     (LABEL ,IV.ROTX HIGHLIGHT ,IV.ROTX.HIGHLIGHT 
                                                            LEFT ,(IPLUS (BITMAPWIDTH IV.TOWARD)
                                                                         (IQUOTIENT (BITMAPWIDTH
                                                                                     IV.ROTZ)
                                                                                2)
                                                                         (BITMAPWIDTH IV.ROTATE)) 
                                                            BOTTOM ,(IPLUS (BITMAPHEIGHT IV.ROTZ)
                                                                           (BITMAPHEIGHT IV.TOWARD)) 
                                                            HELDFN IV.ROTX)
                                                     (LABEL ,IV.UP HIGHLIGHT ,IV.UP.HIGHLIGHT LEFT
                                                            ,(IPLUS (BITMAPWIDTH IV.TOWARD)
                                                                    (IQUOTIENT (BITMAPWIDTH IV.ROTZ)
                                                                           2)
                                                                    10) BOTTOM
                                                            ,(IPLUS (BITMAPHEIGHT IV.TOWARD)
                                                                    (BITMAPHEIGHT IV.ROTZ)
                                                                    (BITMAPHEIGHT IV.ROTATE)
                                                                    (BITMAPHEIGHT IV.ROTY)
                                                                    -5) HELDFN IV.UP)
                                                     (LABEL "2D-Home" DOWNFN IV.2D.HOME LEFT
                                                            ,(FIX (TIMES 2.5 (BITMAPWIDTH IV.ROTZ))) 
                                                            BOTTOM ,(BITMAPHEIGHT IV.TOWARD))
                                                     [LABEL "Home" DOWNFN IV.HOME LEFT
                                                            ,(FIX (TIMES 2.5 (BITMAPWIDTH IV.ROTZ))) 
                                                            BOTTOM ,(IPLUS -15 (BITMAPHEIGHT 
                                                                                      IV.TOWARD]
                                                     [LABEL "Acute-Home" DOWNFN IV.PHOME LEFT
                                                            ,(FIX (TIMES 2.5 (BITMAPWIDTH IV.ROTZ))) 
                                                            BOTTOM ,(IPLUS -30 (BITMAPHEIGHT 
                                                                                      IV.TOWARD]
                                                     (LABEL ,IV.ROTY HIGHLIGHT ,IV.ROTY.HIGHLIGHT 
                                                            LEFT ,(IPLUS (BITMAPWIDTH IV.TOWARD)
                                                                         (IQUOTIENT (BITMAPWIDTH
                                                                                     IV.ROTZ)
                                                                                2)
                                                                         5) BOTTOM
                                                            ,(IPLUS (BITMAPHEIGHT IV.TOWARD)
                                                                    (BITMAPHEIGHT IV.ROTZ)
                                                                    (BITMAPHEIGHT IV.ROTATE)) HELDFN 
                                                            IV.ROTY))) )


(CL:DEFPARAMETER *IV-MENUDESC* `[(PROPS FORMAT ROW BOX 4)
                                 ((TYPE DISPLAY LABEL "IRIS View Controller" HJUSTIFY CENTER FONT
                                        (MODERN 10 BOLD)))
                                 (,@*IV-POSITIONING-MENU-DESC* (GROUP (PROPS FORMAT COLUMN)
                                                                      (,@*IV-COMMANDS-MENUDESC*]
   )


(PUTPROPS IRISVIEW FILETYPE :FAKE-COMPILE-FILE)
(DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS 

(ADDTOVAR NLAMA )

(ADDTOVAR NLAML )

(ADDTOVAR LAMA IV.PROMPTPRINT)
)
(PUTPROPS IRISVIEW COPYRIGHT ("Xerox Corporation" 1985 1987))
(DECLARE%: DONTCOPY
  (FILEMAP (NIL (11707 19606 (IV.PROOF.SCENE 11717 . 12158) (IV.ENSURE.SCENE 12160 . 13349) (
IV.NEW.SCENE.FROM.USER 13351 . 14631) (IV.REDEFINE.SCENE 14633 . 15155) (IV.CHOOSE.SCENE 15157 . 15334
) (IV.BUILD.SCENES.MENU 15336 . 16056) (IV.FORGET.SCENE 16058 . 16516) (IV.DRAW.SCENE 16518 . 18096) (
IV.SET.CURRENT.SCENE 18098 . 18798) (IV.SCENE.SETUP 18800 . 19604)) (19607 33829 (DRAW.AXES 19617 . 
20587) (F 20589 . 20727) (IV.CLEARIRIS 20729 . 20978) (IV.DOWN 20980 . 21419) (IV.GETINPUT 21421 . 
21757) (IV.READ 21759 . 22011) (IV.HOME 22013 . 22529) (IV.2D.HOME 22531 . 22857) (IV.PHOME 22859 . 
23110) (IV.PHOME.AUX 23112 . 23926) (IV.VIEW 23928 . 24278) (IV.LEFT 24280 . 24719) (IV.RIGHT 24721 . 
25050) (IV.ROTX 25052 . 25354) (IV.DOUBLEBUFFER 25356 . 25967) (IV.ROTY 25969 . 26271) (IV.ROTZ 26273
 . 26575) (IV.SWAPBUFFERS 26577 . 26758) (IV.UP 26760 . 27086) (IV.THETA 27088 . 27554) (IV.AXES 27556
 . 28039) (IV.BACKGROUND 28041 . 28829) (IV.TOWARD 28831 . 29161) (IV.AWAY 29163 . 29601) (IV.DSPCOLOR
 29603 . 30179) (IV.DELTA 30181 . 30534) (IV.VIEW.CHANGED 30536 . 30675) (IV.NEWSTREAM 30677 . 30986) 
(IV.PROMPTPRINT 30988 . 31255) (IV.PROOF.SKETCH 31257 . 31518) (IV.INIT 31520 . 33296) (\CLEAR.IRIS 
33298 . 33558) (IRIS.DEGREES 33560 . 33827)) (33830 35177 (IV.ITEMMAPFN 33840 . 34061) (
IV.DISPLAY.FMITEM 34063 . 35175)) (35819 55207 (SKULLO 35829 . 55205)))))
STOP
