(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "31-Mar-99 17:08:40" {DSK}<project>medley3.5>patches>NOXNSPATCH.;6 7381         changes to%:  (VARS NOXNSPATCHCOMS)                    (FNS NOXNSNSMAIL.MAKEANSWERFORM NOXNSNSMAIL.NEW.SEND NOXNSNSMAIL.NEW.SEND.PARSE)      previous date%: "18-Mar-99 10:40:16" {DSK}<project>medley3.5>patches>NOXNSPATCH.;5)(* ; "Copyright (c) 1999 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT NOXNSPATCHCOMS)(RPAQQ NOXNSPATCHCOMS       [        (* ;; "Suppress login/clearinghouse/nsmail if not running XNS.  Mail stuff is necessary in order to parse old NS messages in existing folders.  User should set NS.USER.NAME to the canonical name (E.g. %"Ronald Kaplan%") before starting Lafite.")        [COMS                                                (* ; "Suppress general XNS access")              (FNS NOXNSLOGIN NOXNSCANONICAL.NSHOSTNAME NOXNSGETCLEARINGHOUSE)              (P (MOVD? 'LOGIN 'XNSLOGIN)                 (MOVD 'NOXNSLOGIN 'LOGIN)                 (MOVD? '\CANONICAL.NSHOSTNAME 'XNSCANONICAL.NSHOSTNAME)                 (MOVD 'NOXNSCANONICAL.NSHOSTNAME '\CANONICAL.NSHOSTNAME)                 (MOVD? 'GETCLEARINGHOUSE 'XNSGETCLEARINGHOUSE)                 (MOVD 'NOXNSGETCLEARINGHOUSE 'GETCLEARINGHOUSE]        (COMS                                                (* ;                                       "Let Unixmail deal with old NS messages when XNS unavailable")              (FNS NOXNSNSMAIL.NEW.AUTHENTICATE NOXNSNSMAIL.MAKEANSWERFORM NOXNSNSMAIL.NEW.SEND                    NOXNSNSMAIL.NEW.SEND.PARSE)              (INITVARS (NS.USER.NAME "no NS user name"))              (VARS (LAFITE.USE.ALL.MODES NIL))              (P (MOVD? '\NSMAIL.NEW.AUTHENTICATE 'XNSNSMAIL.NEW.AUTHENTICATE)                 (MOVD 'NOXNSNSMAIL.NEW.AUTHENTICATE '\NSMAIL.NEW.AUTHENTICATE)                 (MOVD? '\NSMAIL.MAKEANSWERFORM 'XNSNSMAIL.MAKEANSWERFORM)                 (MOVD 'NOXNSNSMAIL.MAKEANSWERFORM '\NSMAIL.MAKEANSWERFORM)                 (MOVD? '\NSMAIL.NEW.SEND 'XNSNSMAIL.NEW.SEND)                 (MOVD 'NOXNSNSMAIL.NEW.SEND '\NSMAIL.NEW.SEND)                 (MOVD? '\NSMAIL.NEW.SEND.PARSE 'XNSNSMAIL.NEW.SEND.PARSE)                 (MOVD 'NOXNSNSMAIL.NEW.SEND.PARSE '\NSMAIL.NEW.SEND.PARSE))              (DECLARE%: EVAL@COMPILE DONTCOPY (FILES (LOADCOMP)                                                      LAFITEDECLS])(* ;; "Suppress login/clearinghouse/nsmail if not running XNS.  Mail stuff is necessary in order to parse old NS messages in existing folders.  User should set NS.USER.NAME to the canonical name (E.g. %"Ronald Kaplan%") before starting Lafite.")(* ; "Suppress general XNS access")(DEFINEQ(NOXNSLOGIN  [LAMBDA (HOST FLG DIRECTORY MSG)                       (* ; "Edited 14-Oct-97 18:38 by rmk:")    (* ;; "Replace login with NOOP Lisp isn't running XNS")    (CL:WHEN (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))           (XNSLOGIN HOST FLG DIRECTORY MSG])(NOXNSCANONICAL.NSHOSTNAME  [LAMBDA (HOST)                                         (* ; "Edited 11-Feb-98 14:34 by rmk:")    (* ;; "Replace login with NOOP Lisp isn't running XNS")    (CL:WHEN (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))           (XNSCANONICAL.NSHOSTNAME HOST])(NOXNSGETCLEARINGHOUSE  [LAMBDA NIL                                            (* ; "Edited  6-Mar-99 01:15 by rmk:")    (* ;; "Replace login with NOOP Lisp isn't running XNS")    (CL:WHEN (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))           (XNSGETCLEARINGHOUSE]))(MOVD? 'LOGIN 'XNSLOGIN)(MOVD 'NOXNSLOGIN 'LOGIN)(MOVD? '\CANONICAL.NSHOSTNAME 'XNSCANONICAL.NSHOSTNAME)(MOVD 'NOXNSCANONICAL.NSHOSTNAME '\CANONICAL.NSHOSTNAME)(MOVD? 'GETCLEARINGHOUSE 'XNSGETCLEARINGHOUSE)(MOVD 'NOXNSGETCLEARINGHOUSE 'GETCLEARINGHOUSE)(* ; "Let Unixmail deal with old NS messages when XNS unavailable")(DEFINEQ(NOXNSNSMAIL.NEW.AUTHENTICATE  [LAMBDA NIL                                                (* ; "Edited 18-Mar-99 10:39 by rmk:")                                                             (* ; "Edited  8-Mar-99 20:59 by rmk:")                                                             (* ; "Edited  6-Mar-99 11:54 by rmk:")    (* ;; "Fake up lafite user data when not running XNS.  This permits us to parse old mail folders with NS mesages and detect whether they are from the current user.")    (IF (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))        THEN (XNSNSMAIL.NEW.AUTHENTICATE)      ELSE (CREATE LAFITEMODEDATA                      FULLUSERNAME _ (CONCAT NS.USER.NAME ":" CH.DEFAULT.DOMAIN ":"                                             CH.DEFAULT.ORGANIZATION)                      SHORTUSERNAME _ (UNIX-USERNAME)                      UNPACKEDUSERNAME _ (CREATE NSNAME                                                NSOBJECT _ NS.USER.NAME                                                NSDOMAIN _ CH.DEFAULT.DOMAIN                                                NSORGANIZATION _ CH.DEFAULT.ORGANIZATION])(NOXNSNSMAIL.MAKEANSWERFORM  [LAMBDA (MSGDESCRIPTORS MAILFOLDER)                        (* ; "Edited 31-Mar-99 17:04 by rmk:")    (* ;; "Fake up lafite user data when not running XNS.  This permits us to parse old mail folders with NS mesages and detect whether they are from the current user.")    (IF (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))        THEN (XNSNSMAIL.MAKEANSWERFORM MSGDESCRIPTORS MAILFOLDER)      ELSE (\UNIXMAIL.MAKEANSWERFORM MSGDESCRIPTORS MAILFOLDER])(NOXNSNSMAIL.NEW.SEND  [LAMBDA (PARSE EDITORWINDOW ABORTWINDOW)                   (* ; "Edited 31-Mar-99 17:06 by rmk:")    (* ;; "Fake up lafite user data when not running XNS.  This permits us to parse old mail folders with NS mesages and detect whether they are from the current user.")    (IF (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))        THEN (XNSNSMAIL.NEW.SEND PARSE EDITORWINDOW ABORTWINDOW)      ELSE (\UNIXMAIL.SEND PARSE EDITORWINDOW ABORTWINDOW])(NOXNSNSMAIL.NEW.SEND.PARSE  [LAMBDA (MSG EDITORWINDOW)                                 (* ; "Edited 31-Mar-99 17:08 by rmk:")    (* ;; "Fake up lafite user data when not running XNS.  This permits us to parse old mail folders with NS mesages and detect whether they are from the current user.")    (IF (STREQUAL "1" (UNIX-GETENV "LDELISPXNS"))        THEN (XNSNSMAIL.NEW.SEND.PARSE MSG EDITORWINDOW)      ELSE (\UNIXMAIL.SEND.PARSE MSG EDITORWINDOW]))(RPAQ? NS.USER.NAME "no NS user name")(RPAQQ LAFITE.USE.ALL.MODES NIL)(MOVD? '\NSMAIL.NEW.AUTHENTICATE 'XNSNSMAIL.NEW.AUTHENTICATE)(MOVD 'NOXNSNSMAIL.NEW.AUTHENTICATE '\NSMAIL.NEW.AUTHENTICATE)(MOVD? '\NSMAIL.MAKEANSWERFORM 'XNSNSMAIL.MAKEANSWERFORM)(MOVD 'NOXNSNSMAIL.MAKEANSWERFORM '\NSMAIL.MAKEANSWERFORM)(MOVD? '\NSMAIL.NEW.SEND 'XNSNSMAIL.NEW.SEND)(MOVD 'NOXNSNSMAIL.NEW.SEND '\NSMAIL.NEW.SEND)(MOVD? '\NSMAIL.NEW.SEND.PARSE 'XNSNSMAIL.NEW.SEND.PARSE)(MOVD 'NOXNSNSMAIL.NEW.SEND.PARSE '\NSMAIL.NEW.SEND.PARSE)(DECLARE%: EVAL@COMPILE DONTCOPY (FILESLOAD (LOADCOMP)       LAFITEDECLS))(PUTPROPS NOXNSPATCH COPYRIGHT ("Xerox Corporation" 1999))(DECLARE%: DONTCOPY  (FILEMAP (NIL (2784 3669 (NOXNSLOGIN 2794 . 3080) (NOXNSCANONICAL.NSHOSTNAME 3082 . 3380) (NOXNSGETCLEARINGHOUSE 3382 . 3667)) (4011 6678 (NOXNSNSMAIL.NEW.AUTHENTICATE 4021 . 5192) (NOXNSNSMAIL.MAKEANSWERFORM 5194 . 5698) (NOXNSNSMAIL.NEW.SEND 5700 . 6192) (NOXNSNSMAIL.NEW.SEND.PARSE 6194 . 6676)))))STOP