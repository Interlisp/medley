(DEFINE-FILE-INFO READTABLE "XCL" PACKAGE "INTERLISP")(FILECREATED " 6-Mar-2021 20:47:27" |{DSK}<home>larry>ilisp>medley>sources>LOADUP-LISP.;6| 9575         |changes| |to:|  (VARS LOADUP-LISPCOMS)                       (FNS LOADUP-LISP LOADUP-LISP-SYSOUT)      |previous| |date:| " 6-Mar-2021 19:05:04" |{DSK}<home>larry>ilisp>medley>sources>LOADUP-LISP.;3|)(PRETTYCOMPRINT LOADUP-LISPCOMS)(RPAQQ LOADUP-LISPCOMS       ((FNS LOADUP-LISP ENDLOADUP)        (DECLARE\: DONTEVAL@LOAD DOCOPY (P (LOADUP-LISP)))        (FNS MEDLEY-INIT-VARS MEDLEYDIR)        (INITVARS (FILING.ENUMERATION.DEPTH T))        (VARS MEDLEY-INIT-VARS)        (GLOBALVARS XCL::*WHERE-IS-CASH-FILES* LISPMAKESYSDATE MAKESYSFILENAME MEDLEY-INIT-VARS                MEDLEYDIR SYSTEMINITVARS USERRECLST)        (FUNCTIONS WITHOUT.PAGEHOLD)))(DEFINEQ(LOADUP-LISP  (LAMBDA NIL                                         (* \; "Edited  6-Mar-2021 20:44 by larry")    (SETQQ COMPILE.EXT LCOM)                                 (* \; "should be set earlier")    (SETQ SYSFILES (UNION BOOTLOADEDFILES SYSFILES))    (SETQ BOOTLOADEDFILES)    (* |;;| "following files are really loaded earlier, this call to LOADUP just cleans up")    (LOADUP '(ACODE MACHINEINDEPENDENT POSTLOADUP))    (* |;;| "establish all package exports early")    (LOADUP '(LISP-PACKAGE FASL-PACKAGE D-ASSEM-PACKAGE COMPILER-PACKAGE))    (* |;;| "load FASL loader here, so we can load DFASLs earlier in loadup")    (LOADUP '(ERROR-RUNTIME CMLARITH CONDITION-HIERARCHY CMLHASH D-ASSEM FASLOAD))    (* |;;| "These are needed by any FASL files")    (LOADUP '(DEFFER-RUNTIME CMLPRINT CLSTREAMS CMLSTRING CMLSYMBOL CMLTYPES CMLSEQCOMMON                     CMLSEQMAPPERS CMLPATHNAME CMLFILESYS))(* |;;;| "* 'FASL files may be loaded after this point' * * *")    (LOADUP '(CMLDEFFER ERROR-RUNTIME-AFTER-FASL WRAPPERS))    (* |;;| "early runtime support for Common Lisp and (temporarily) debugger")    (LOADUP '(STACKFNS CMLMVS MACROS MACROAUX UNWINDMACROS))    (LOADUP '(COMMON XCLC-RUNTIME CMLTYPES CL-ERROR))    (LOADUP '(AFONT EDIT WEDIT PRETTY DSPRINTDEF NEWPRINTDEF FONTPROFILE SPELLFILE PRINTFN LOADFNS                     DMISC DIRECTORY SPELLFILE FILEPKG RESOURCE))    (* |;;| "needed for makesys")    (LOADUP '(MOD44IO))    (* |;;| "The Byte Compiler (DLAP, BYTECOMPILER, COMPILER) used to be here.  Moved after    XCL Compiler so that one byte compiler init will work.  JDS 10/11/89")    (LOADUP '(HIST UNDO SPELL DWIM WTFIX CLISP DWIMIFY CLISPIFY RECORD))    (LOADUP '(GAINSPACE COROUTINE ARGLIST ASKUSER SYSPRETTY COMMON COMPARE))    (DWIM 'C)    (* |;;| "Kernel Common Lisp files")    (LOADUP '(CMLSTEP CMLDOC CMLPARSE CMLSETF CMLPRED CMLREAD WALKER CMLSEQFINDER CMLSEQMODIFY                     CMLSORT DEFSTRUCT CMLMISCIO CMLCOMPILE CMLDESTRUCT CL-ERROR CMLFORMAT                     CMLENVIRONMENT CMLLOAD CMLFLOAT CMLTIME CMLRAND CMLMODULES))    (LOADUP '(PROFILE CMLEXEC EXEC-COMMANDS DEBUGGER IL-ERROR-STUFF DEBUGEDIT))    (LOADUP '(ADDARITH))    (LOADUP '(CMLPATHNAME HPRINT AARITH ADISPLAY HLDISPLAY MENU WINDOWOBJ WINDOWSCROLL WINDOW                     WINDOWICON PAINTW ATTACHEDWINDOW XXGEOM XXFILL DEXEC INSPECT DESCRIBE                     CMLARRAYINSPECTOR EDITINTERFACE TTYIN))    (LOADUP '(BREAK-AND-TRACE))    (LOADUP '(FASDUMP XCL-COMPILER ADVISE))    (* |;;| "the bytecompiler and Interlisp compiler interface functions")    (LOADUP '(DLAP BYTECOMPILER COMPILE))    (LOADUP '(HARDCOPY LOGOW IDLER ICONW FREEMENU SEDIT))    (CLOSEW (LOGOW))    (MOVD 'NILL 'LOGOW)    (LOADUP '(DSK UFS UFSCALLC MAIKOBITBLT))    (LOADUP '(TIME))    (LOADUP '(BRKDWN))    (LOADUP '(XCL-EXTRAS))                                   (*                                                            "CMLPACKAGE pushes onto INSPECTMACROS")    (LOADUP '(CMLPACKAGE))    (* |;;| "Puts ARGNAME properties on CL and XCL functions that IL:SMARTARGLIST can't hack. Keep this last so everything will be defined when it runs")    (LOADUP '(CMLSMARTARGS))    (LOADUP '(IMPLICIT-KEY-HASH CLOSURE-CACHE))    (* |;;| "Already enabled, but this time fixes tables that weren't defined in the init")    (PACKAGE-ENABLE)))(ENDLOADUP  (LAMBDA NIL                                           (* \; "Edited 13-Feb-2021 19:26 by lmm")                                                             (* \; "Edited 11-Oct-90 11:02 by jds")    (* |;;|   "set up for NONET configuration;  sites with ethernet can load in init from other places")    (* |;;| "All records existing at this point in time have been loaded as part of the system.")    (MAPC USERRECLST (FUNCTION (LAMBDA (R)                                 (AND R (RECORDPRIORITY R 'SYSTEM)))))    (MEDLEY-INIT-VARS T)    (|for| X |in| SYSTEMINITVARS |when| (NOT (ASSOC X MEDLEY-INIT-VARS))       |do| (SETTOPVAL (CAR X)                       (COPY (CDR X))))    (|for| TYPE |in| FILEPKGTYPES |do| (FILEPKGCHANGES TYPE NIL))    (CLRPROMPT))))(DECLARE\: DONTEVAL@LOAD DOCOPY (LOADUP-LISP))(DEFINEQ(MEDLEY-INIT-VARS  (LAMBDA (CLEAR)                                     (* \; "Edited 17-Jan-2021 14:29 by larry")    (* |;;| "MEDLEY-INIT-VARS has variables that might need to get reset. ")    (|if| CLEAR        |then| (SETQ MEDLEYDIR NIL)              (SETQ XCL::*WHERE-IS-CASH-FILES* NIL)              (|for| X |in| MEDLEY-INIT-VARS |do| (SET (CAR X)))      |elseif| (OR (NOT (BOUNDP 'MEDLEYDIR))                       (AND (NULL MEDLEYDIR)                            (NULL (MEDLEYDIR))))        |then| (PRINTOUT T "WARNING: MEDLEYDIR not set correctly"                           " set it and call (MEDLEY-INIT-VARS) again" T)      |else| (|for| X |in| MEDLEY-INIT-VARS |do| (SET (CAR X)                                                                      (EVAL (CADR X))))             (* |;;| "WHEREIS doesn't follow conventions")            (CL:WHEN (GETD 'XCL::ADD-WHERE-IS-DATABASE)                (SETQ XCL::*WHERE-IS-CASH-FILES* NIL)                (NLSETQ (XCL::ADD-WHERE-IS-DATABASE (MEDLEYDIR "loadups" "WHEREIS.HASH"))))            NIL)))(MEDLEYDIR  (LAMBDA (DIRNAME FILENAME OUTPUT)                   (* \; "Edited 14-Dec-2020 17:12 by larry")    (|if| (NULL DIRNAME)        |then| (|if| (OR (NOT (BOUNDP 'MEDLEYDIR))                                 (NOT MEDLEYDIR))                       |then| (OR (SETQ MEDLEYDIR (DIRECTORYNAME (OR (UNIX-GETENV "MEDLEYDIR")                                                                         T)))                                      (DIRECTORYNAME T))                     |elseif| (STRPOS "/" MEDLEYDIR)                       |then| (SETQ MEDLEYDIR (DIRECTORYNAME MEDLEYDIR))                     |else| MEDLEYDIR)      |elseif| (LISTP DIRNAME)        |then| (|for| X |in| DIRNAME |collect| (MEDLEYDIR X))      |elseif| FILENAME        |then| (SETQ FILENAME (CONCAT (MEDLEYDIR DIRNAME)                                         FILENAME))              (|if| OUTPUT                  |then| FILENAME                |else| (OR (INFILEP FILENAME)                               (ERROR "No such medley file" FILENAME)))      |else| (OR (DIRECTORYNAME (CONCAT (MEDLEYDIR)                                           DIRNAME))                     (ERROR "No such medley directory" DIRNAME))))))(RPAQ? FILING.ENUMERATION.DEPTH T)(RPAQQ MEDLEY-INIT-VARS       ((LISPUSERSDIRECTORIES (MEDLEYDIR '("library" "lispusers" "internal/library")))        (LISPSOURCEDIRECTORIES (MEDLEYDIR '("sources")))        (LISPSOURCEDIRECTORY (CAR LISPSOURCEDIRECTORIES))        (IRM.HOST&DIR (MEDLEYDIR '"docs/dinfo"))        (IRM.DINFOGRAPH)        (DIRECTORIES (APPEND LISPUSERSDIRECTORIES LISPSOURCEDIRECTORIES))        (LOGINHOST/DIR (DIRECTORYNAME (OR (UNIX-GETENV "LOGINDIR")                                          (UNIX-GETENV "HOME"))))        (USERGREETFILES `((,LOGINHOST/DIR "INIT" COM)                          (,LOGINHOST/DIR "INIT")))        (DISPLAYFONTDIRECTORIES (MEDLEYDIR '("fonts/displayfonts" "fonts/altofonts")))        (POSTSCRIPTFONTDIRECTORIES (MEDLEYDIR '("fonts/postscriptfonts")))        (INTERPRESSFONTDIRECTORIES (MEDLEYDIR '("fonts/ipfonts")))        (XCL::*WHERE-IS-CASH-FILES*)))(DECLARE\: DOEVAL@COMPILE DONTCOPY(GLOBALVARS XCL::*WHERE-IS-CASH-FILES* LISPMAKESYSDATE MAKESYSFILENAME MEDLEY-INIT-VARS MEDLEYDIR        SYSTEMINITVARS USERRECLST))(DEFMACRO WITHOUT.PAGEHOLD (WINDOW &BODY FORMS)   `(RESETLST        (LET* ((TTYWINDOW ,WINDOW)               (ORIGINAL.PAGEFULLFN (WINDOWPROP TTYWINDOW 'PAGEFULLFN))               (NEW.PAGEFULLFN (FUNCTION NILL)))              (RESETSAVE (WINDOWPROP TTYWINDOW 'PAGEFULLFN NEW.PAGEFULLFN)                     (LIST (FUNCTION (LAMBDA (TTYWINDOW NEW.PAGEFULLFN ORIGINAL.PAGEFULLFN)                                       (COND                                          ((EQ (WINDOWPROP TTYWINDOW 'PAGEFULLFN)                                               NEW.PAGEFULLFN)                                           (WINDOWPROP TTYWINDOW 'PAGEFULLFN ORIGINAL.PAGEFULLFN)))))                           TTYWINDOW NEW.PAGEFULLFN ORIGINAL.PAGEFULLFN)))        ,@FORMS))(DECLARE\: DONTCOPY  (FILEMAP (NIL (842 5163 (LOADUP-LISP 852 . 4314) (ENDLOADUP 4316 . 5161)) (5218 7680 (MEDLEY-INIT-VARS 5228 . 6373) (MEDLEYDIR 6375 . 7678)))))STOP