(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "26-Jan-98 13:30:17" ("compiled on " {DSK}<disk>disk2>jdstools>lc3>lispcore3.0>sources>RENAMEMACROS.;3) "30-Mar-95 20:33:04" bcompl'd in "Medley 14-Aug-95 ..." dated "14-Aug-95 15:27:48")(FILECREATED "27-Apr-94 15:43:27" {DSK}<king>export>lispcore>sources>RENAMEMACROS.;2)(PRETTYCOMPRINT RENAMEMACROSCOMS)(RPAQQ RENAMEMACROSCOMS ((* ;; "MACROS FOR CODE THAT NEEDS TO CHANGE WHEN YOU RUN IT RENAMED.") (COMS (* ; "Things that change when we're renaming for RDSYS/TELERAID") (ADDVARS (RD.SUBFNS (UNLESSRDSYS . 2ND) (\GETBITS . RNGETBITS) (\PUTBITS . RNPUTBITS)))) (COMS (* ; "Things that change when we're making I-NEW, for building a new loadup.") (ADDVARS (MKI.SUBFNS (UNLESSINEW . 2ND) (\GETBITS . RNGETBITS) (\PUTBITS . RNPUTBITS)))) (* ;; "Force these macros to be expanded while renaming:") (ADDVARS (EXPANDMACROFNS 1ST 2ND UNLESSRDSYS UNLESSINEW RNGETBITS RNPUTBITS \TESTBITS) (EXPANDMACROFNS ADDBASE GETBASE GETBASEBYTE GETBASEPTR HILOC LOLOC PUTBASE PUTBASEBYTE PUTBASEPTR REPLACEPTRFIELD VAG2 PAGEBASE PAGELOC)) (* ;; "MACROS TO CONTROL EFFECTS:") (* ;; "(UNLESSRDSYS normal rdsys) expands to one form or the other, depending on whether you're making a RDSYS.") (* ;; "(UNLESSINEW normal inew) expandes to one form or the other, depending on whether you're makeing an I-NEW.") (* ;; "(1ST ...) expands to its first argument") (* ;; "(2ND ...) expands to its second argument.  These are used in epxanding UNLESS...") (EXPORT (MACROS UNLESSRDSYS UNLESSINEW 1ST 2ND LOCAL ALLOCAL) (MACROS ADDBASE GETBASE GETBASEBYTE GETBASEPTR HILOC LOLOC PUTBASE PUTBASEBYTE PUTBASEPTR REPLACEPTRFIELD VAG2 PAGEBASE PAGELOC)) (MACROS RNPUTBITS RNGETBITS)))(ADDTOVAR RD.SUBFNS (UNLESSRDSYS . 2ND) (\GETBITS . RNGETBITS) (\PUTBITS . RNPUTBITS))(ADDTOVAR MKI.SUBFNS (UNLESSINEW . 2ND) (\GETBITS . RNGETBITS) (\PUTBITS . RNPUTBITS))(ADDTOVAR EXPANDMACROFNS 1ST 2ND UNLESSRDSYS UNLESSINEW RNGETBITS RNPUTBITS \TESTBITS)(ADDTOVAR EXPANDMACROFNS ADDBASE GETBASE GETBASEBYTE GETBASEPTR HILOC LOLOC PUTBASE PUTBASEBYTE PUTBASEPTR REPLACEPTRFIELD VAG2 PAGEBASE PAGELOC)(PUTPROPS UNLESSRDSYS MACRO ((NORMAL RDSYS) NORMAL))(PUTPROPS UNLESSINEW MACRO ((NORMAL I-NEW) NORMAL))(PUTPROPS 1ST MACRO ((A . B) A))(PUTPROPS 2ND MACRO ((A B . C) B))(PUTPROPS LOCAL MACRO ((X) X))(PUTPROPS ALLOCAL MACRO ((X) X))(PUTPROPS ADDBASE DMACRO (= . \ADDBASE))(PUTPROPS GETBASE DMACRO (= . \GETBASE))(PUTPROPS GETBASEBYTE DMACRO (= . \GETBASEBYTE))(PUTPROPS GETBASEPTR DMACRO (= . \GETBASEPTR))(PUTPROPS HILOC DMACRO (= . \HILOC))(PUTPROPS LOLOC DMACRO (= . \LOLOC))(PUTPROPS PUTBASE DMACRO (= . \PUTBASE))(PUTPROPS PUTBASEBYTE DMACRO (= . \PUTBASEBYTE))(PUTPROPS PUTBASEPTR DMACRO (= . \PUTBASEPTR))(PUTPROPS REPLACEPTRFIELD DMACRO (= . \RPLPTR))(PUTPROPS VAG2 DMACRO (= . \VAG2))(PUTPROPS PAGEBASE MACRO ((PTR) (fetch (POINTER PAGEBASE) of PTR)))(PUTPROPS PAGELOC MACRO (OPENLAMBDA (PTR) (IPLUS (LLSH (\HILOC PTR) 8) (LRSH (\LOLOC PTR) 8))))(PUTPROPS RNPUTBITS MACRO (X ((LAMBDA (DATUM OFFSET FD NEWVALUE) (PROG ((MASK (BitFieldMask FD)) (SHIFT (BitFieldShift FD)) (FIRST (BitFieldFirst FD))) (OR (EQ FIRST 0) (SETQ NEWVALUE (LIST (QUOTE LOGAND) NEWVALUE MASK))) (OR (EQ SHIFT 0) (SETQ NEWVALUE (LIST (QUOTE LLSH) NEWVALUE SHIFT))) (COND ((AND (EQ FIRST 0) (EQ SHIFT 0)) (SETQ NEWVALUE (LIST (QUOTE \PUTBASE) DATUM OFFSET NEWVALUE))) (T (SETQ NEWVALUE (LIST (QUOTE LOGOR) (LIST (QUOTE LOGAND) (LIST (QUOTE \GETBASE) (QUOTE $$PUTBITS) OFFSET) (LOGXOR 65535 (LLSH MASK SHIFT))) NEWVALUE)) (SETQ NEWVALUE (LIST (LIST (QUOTE OPENLAMBDA) (QUOTE ($$PUTBITS)) (LIST (QUOTE \PUTBASE) (QUOTE $$PUTBITS) OFFSET NEWVALUE)) DATUM)))) (COND ((NOT EFF) (OR (EQ SHIFT 0) (SETQ NEWVALUE (LIST (QUOTE LRSH) NEWVALUE SHIFT))) (OR (EQ FIRST 0) (SETQ NEWVALUE (LIST (QUOTE LOGAND) NEWVALUE MASK))))) (RETURN NEWVALUE))) (CAR X) (CADR X) (CADDR X) (CADDDR X))))(PUTPROPS RNGETBITS MACRO (X ((LAMBDA (FORM OFFSET FD) (COND ((NOT (FIXP FD)) (QUOTE IGNOREMACRO)) (T (SETQ FORM (LIST (QUOTE \GETBASE) FORM OFFSET)) (OR (EQ (BitFieldShift FD) 0) (SETQ FORM (LIST (QUOTE LRSH) FORM (BitFieldShift FD)))) (OR (EQ (BitFieldFirst FD) 0) (SETQ FORM (LIST (QUOTE LOGAND) FORM (BitFieldMask FD)))) FORM))) (CAR X) (CADR X) (CADDR X))))(PUTPROPS RENAMEMACROS COPYRIGHT ("Venue & Xerox Corporation" 1982 1985 1986 1990 1994))NIL