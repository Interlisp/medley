;; AR 8135 test
;; Filed as {ERIS}<LISPCORE>TEST>CMLSTREAMS>AR8135.TEST
;; by Peter Reidy
;; This code is adapted from {ERIS}<LISPCORE>CML>TEST>21-STREAMS.TEST. AR8135-test is the full test file's make-concatenated-stream-test.
(do-test-group AR8135-group
	:before
	(progn
		(test-defun input-test (astream &key keep-open dont-test-for-eof)
			(and
				(streamp astream)
				(input-stream-p astream)
				(or
					(subtypep (stream-element-type astream) 'integer)
					(subtypep (stream-element-type astream) 'character)
				)
				(equal (read astream) 'hello)
				(or dont-test-for-eof (read astream nil t))
				(or keep-open (close astream))
			)
		)
		(test-setq test-string "hello") 
)
(do-test AR8135-test
	(let*
((original-stream (make-string-input-stream test-string))
 (astream (make-concatenated-stream original-stream)))
(input-test astream)
	)
)
)
 
STOP
