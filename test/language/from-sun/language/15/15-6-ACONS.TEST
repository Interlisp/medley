;; Function To Be Tested: ACONS
;;
;; Source: Guy L Steele's CLTL
;; Section: 15.6 Association Lists
;; Page: 279
;;
;; Created By:    Kelly Roach
;;
;; Creation Date: June 27,1986
;;
;; Last Update:   June 27,1986
;;
;; Filed As:      {ERIS}<LISPCORE>CML>TEST>15-6-ACONS.TEST
;;
;;
;; Syntax:        (ACONS KEY DATUM ALIST)
;;
;; Function Description:
;; ACONS constructs a new association list by adding the pair
;; (KEY . DATUM) to the old A-LIST.
;; 
;;     (ACONS X Y A) = (CONS (CONS X Y) A)
;;     
;; 
;; Argument(s):   KEY - a function
;;                DATUM - anything
;;                ALIST - an association list
;;
;; Returns:       an association list
;;

(DO-TEST "ACONS TEST 1" (EQUAL (ACONS 'G 5 '((B . 7)
                                             (E . 5)
                                             (E . 2)))
                               '((G . 5)
                                 (B . 7)
                                 (E . 5)
                                 (E . 2)))
       (EQUAL (ACONS 'C 5 '((G . 3)))
              '((C . 5)
                (G . 3)))
       (EQUAL (ACONS 'G 9 '((G . 4)
                            (B . 5)
                            (E . 7)
                            (X . 4)
                            (B . 10)
                            (X . 6)))
              '((G . 9)
                (G . 4)
                (B . 5)
                (E . 7)
                (X . 4)
                (B . 10)
                (X . 6)))
       (EQUAL (ACONS 'F 3 '((F . 4)
                            (Y . 2)))
              '((F . 3)
                (F . 4)
                (Y . 2)))
       (EQUAL (ACONS 'D 3 '((D . 5)
                            (Z . 3)
                            (Y . 3)
                            (Z . 6)))
              '((D . 3)
                (D . 5)
                (Z . 3)
                (Y . 3)
                (Z . 6)))
       (EQUAL (ACONS 'Z 1 '((E . 4)
                            (F . 2)
                            (G . 3)
                            (C . 10)
                            (C . 4)
                            (G . 9)
                            (F . 3)
                            (D . 8)))
              '((Z . 1)
                (E . 4)
                (F . 2)
                (G . 3)
                (C . 10)
                (C . 4)
                (G . 9)
                (F . 3)
                (D . 8))))

(DO-TEST "ACONS TEST 2"
       (EQUAL (ACONS 'X '(X E G C G)
                     '((D A Z C Z A E E)
                       (Z G X E Y X C Y F)
                       (G A G Z A G G B Y)
                       (F D G E B B A Y)
                       (Z B E B)))
              '((X X E G C G)
                (D A Z C Z A E E)
                (Z G X E Y X C Y F)
                (G A G Z A G G B Y)
                (F D G E B B A Y)
                (Z B E B)))
       (EQUAL (ACONS 'E '(A G C)
                     '((E F F)))
              '((E A G C)
                (E F F)))
       (EQUAL (ACONS 'D
                     '(G F X Y E A Z F E Z)
                     '((C X Y Z F X Z A B)
                       (X G G F X C Y G E E)
                       (C Z X A G)
                       (Z A F Z D X D E Y X)
                       (G A F Y Y B Y)
                       (Z Y Z)
                       (A C X)
                       (E E E X G B F C E)
                       (C Z Y Y E)))
              '((D G F X Y E A Z F E Z)
                (C X Y Z F X Z A B)
                (X G G F X C Y G E E)
                (C Z X A G)
                (Z A F Z D X D E Y X)
                (G A F Y Y B Y)
                (Z Y Z)
                (A C X)
                (E E E X G B F C E)
                (C Z Y Y E)))
       (EQUAL (ACONS 'B '(C C Z)
                     '((D Y B A B B C Z D)
                       (C X E A E X D)
                       (X F F Y B B Y X A)
                       (G Y G C A D)
                       (Z G A D A)
                       (D F A G D G)
                       (B X B E)
                       (Y F B C B X Y)
                       (E F A C)
                       (C F A E A)))
              '((B C C Z)
                (D Y B A B B C Z D)
                (C X E A E X D)
                (X F F Y B B Y X A)
                (G Y G C A D)
                (Z G A D A)
                (D F A G D G)
                (B X B E)
                (Y F B C B X Y)
                (E F A C)
                (C F A E A)))
       (EQUAL (ACONS 'C
                     '(F X G D B G F X)
                     '((C Y E A Z C D)
                       (G F D G C A F D D B)
                       (Z D C D D Z F)
                       (Y C C G E B G D Y Z F)
                       (C E F Z)
                       (Z D)
                       (A G C F G B B A F A Z)
                       (E E A B G Z Z X)))
              '((C F X G D B G F X)
                (C Y E A Z C D)
                (G F D G C A F D D B)
                (Z D C D D Z F)
                (Y C C G E B G D Y Z F)
                (C E F Z)
                (Z D)
                (A G C F G B B A F A Z)
                (E E A B G Z Z X)))
       (EQUAL (ACONS 'X
                     '(C F A F D A Y C X F)
                     '((X G D C D Z Y)
                       (C Y Z G E G Y C C A)
                       (A A)
                       (Z Y F X)))
              '((X C F A F D A Y C X F)
                (X G D C D Z Y)
                (C Y Z G E G Y C C A)
                (A A)
                (Z Y F X))))

(DO-TEST "ACONS TEST 3" (EQUAL (ACONS 'CATOR 'B '((FOO . F)
                                                  (BAZ . A)
                                                  (PERTY . G)
                                                  (MORY . D)))
                               '((CATOR . B)
                                 (FOO . F)
                                 (BAZ . A)
                                 (PERTY . G)
                                 (MORY . D)))
       (EQUAL (ACONS 'FOO 'E '((MEEF . F)
                               (ZORK . Z)
                               (CATOR . G)
                               (MORY . F)
                               (FOO . Y)
                               (ZORK . G)
                               (CATOR . D)
                               (BAZ . Y)))
              '((FOO . E)
                (MEEF . F)
                (ZORK . Z)
                (CATOR . G)
                (MORY . F)
                (FOO . Y)
                (ZORK . G)
                (CATOR . D)
                (BAZ . Y)))
       (EQUAL (ACONS 'ZORK 'X '((BAR . A)
                                (MEEF . D)
                                (BAR . B)
                                (BAR . G)
                                (QIX . C)))
              '((ZORK . X)
                (BAR . A)
                (MEEF . D)
                (BAR . B)
                (BAR . G)
                (QIX . C)))
       (EQUAL (ACONS 'CATOR 'C '((PERTY . E)
                                 (ZORK . X)
                                 (PERTY . C)
                                 (CATOR . Z)
                                 (MEEF . Y)
                                 (CATOR . Z)
                                 (MORY . E)
                                 (ZORK . X)))
              '((CATOR . C)
                (PERTY . E)
                (ZORK . X)
                (PERTY . C)
                (CATOR . Z)
                (MEEF . Y)
                (CATOR . Z)
                (MORY . E)
                (ZORK . X)))
       (EQUAL (ACONS 'PERTY 'E '((FOO . E)
                                 (CATOR . C)
                                 (CATOR . E)
                                 (ZORK . X)
                                 (MORY . D)
                                 (QIX . Y)
                                 (QIX . X)
                                 (FOO . X)))
              '((PERTY . E)
                (FOO . E)
                (CATOR . C)
                (CATOR . E)
                (ZORK . X)
                (MORY . D)
                (QIX . Y)
                (QIX . X)
                (FOO . X)))
       (EQUAL (ACONS 'MORY 'A '((CATOR . Z)
                                (ZORK . B)
                                (BAZ . E)
                                (BAR . D)
                                (MEEF . A)
                                (FOO . Y)))
              '((MORY . A)
                (CATOR . Z)
                (ZORK . B)
                (BAZ . E)
                (BAR . D)
                (MEEF . A)
                (FOO . Y))))

(DO-TEST "ACONS TEST 4"
       (EQUAL (ACONS 'MEEF '(G C E C C)
                     '((MORY G X F E)
                       (ZORK D F C F D E D G Z)
                       (CATOR F Y Z)
                       (ZORK B F G X E X F B B)
                       (PERTY A D F B D E D E A X)))
              '((MEEF G C E C C)
                (MORY G X F E)
                (ZORK D F C F D E D G Z)
                (CATOR F Y Z)
                (ZORK B F G X E X F B B)
                (PERTY A D F B D E D E A X)))
       (EQUAL (ACONS 'BAZ '(G X A)
                     '((QIX C E D C E D X D C B)
                       (ZORK E E Z)
                       (MORY E Y Z)))
              '((BAZ G X A)
                (QIX C E D C E D X D C B)
                (ZORK E E Z)
                (MORY E Y Z)))
       (EQUAL (ACONS 'FOO
                     '(B D E Y B D C B)
                     '((BAZ Y B A X B)
                       (BAZ B E Y E)
                       (FOO B B X C G X)
                       (CATOR G D X G F Z)
                       (MORY X A C X G F E)))
              '((FOO B D E Y B D C B)
                (BAZ Y B A X B)
                (BAZ B E Y E)
                (FOO B B X C G X)
                (CATOR G D X G F Z)
                (MORY X A C X G F E)))
       (EQUAL (ACONS 'CATOR '(E D F G Z)
                     '((BAR C B Z)
                       (QIX Y F D Z F E)
                       (BAZ E G D E F Z B)
                       (MORY B D C G D D G G D C)
                       (BAZ Y E C G F B D B)
                       (BAZ F B B B A E F B)
                       (BAR C F Z A Y D A Z D)
                       (BAZ B)
                       (BAR X X C)))
              '((CATOR E D F G Z)
                (BAR C B Z)
                (QIX Y F D Z F E)
                (BAZ E G D E F Z B)
                (MORY B D C G D D G G D C)
                (BAZ Y E C G F B D B)
                (BAZ F B B B A E F B)
                (BAR C F Z A Y D A Z D)
                (BAZ B)
                (BAR X X C)))
       (EQUAL (ACONS 'QIX '(A Z F C Y G)
                     '((BAR D B Y G F G)
                       (PERTY D Y Z D Z)
                       (QIX Y D E A Y A X Y)
                       (MEEF Y G D B F E E X C)))
              '((QIX A Z F C Y G)
                (BAR D B Y G F G)
                (PERTY D Y Z D Z)
                (QIX Y D E A Y A X Y)
                (MEEF Y G D B F E E X C)))
       (EQUAL (ACONS 'BAZ
                     '(E C G F A G D B)
                     '((MEEF G Y B)
                       (MEEF B D C G)
                       (PERTY G Z F C G Z A)
                       (PERTY X A F Z)
                       (MEEF B X A G E)
                       (BAZ Y Z Y A Z F)
                       (MORY D E Z D C B G B F)))
              '((BAZ E C G F A G D B)
                (MEEF G Y B)
                (MEEF B D C G)
                (PERTY G Z F C G Z A)
                (PERTY X A F Z)
                (MEEF B X A G E)
                (BAZ Y Z Y A Z F)
                (MORY D E Z D C B G B F))))

(DO-TEST "ACONS TEST 5" (EQUAL (ACONS 1 'E '((1 . B)
                                             (4 . G)))
                               '((1 . E)
                                 (1 . B)
                                 (4 . G)))
       (EQUAL (ACONS 1 'Z '((4 . X)
                            (10 . E)
                            (4 . D)
                            (9 . A)
                            (7 . E)
                            (6 . Y)
                            (2 . A)
                            (4 . X)
                            (2 . G)
                            (10 . X)))
              '((1 . Z)
                (4 . X)
                (10 . E)
                (4 . D)
                (9 . A)
                (7 . E)
                (6 . Y)
                (2 . A)
                (4 . X)
                (2 . G)
                (10 . X)))
       (EQUAL (ACONS 2 'F '((3 . Z)
                            (2 . G)))
              '((2 . F)
                (3 . Z)
                (2 . G)))
       (EQUAL (ACONS 9 'Z '((4 . A)
                            (2 . Z)
                            (3 . Y)
                            (2 . E)
                            (6 . A)
                            (1 . D)
                            (3 . C)
                            (7 . D)))
              '((9 . Z)
                (4 . A)
                (2 . Z)
                (3 . Y)
                (2 . E)
                (6 . A)
                (1 . D)
                (3 . C)
                (7 . D)))
       (EQUAL (ACONS 4 'Y '((8 . Y)
                            (10 . E)
                            (5 . A)
                            (6 . Z)
                            (5 . Z)
                            (6 . A)
                            (8 . Z)))
              '((4 . Y)
                (8 . Y)
                (10 . E)
                (5 . A)
                (6 . Z)
                (5 . Z)
                (6 . A)
                (8 . Z)))
       (EQUAL (ACONS 3 'Y '((1 . Y)
                            (4 . E)
                            (8 . A)
                            (3 . F)
                            (6 . F)))
              '((3 . Y)
                (1 . Y)
                (4 . E)
                (8 . A)
                (3 . F)
                (6 . F))))

(DO-TEST "ACONS TEST 6"
       (EQUAL (ACONS 5 '(X G E)
                     '((8 D G Y F G X E D Z Z)
                       (2 Y D B C Z E Y A E Y)
                       (9 C G Z G)
                       (3 Z Y)
                       (2 C)
                       (4 A X E Z C A F)
                       (5 F A Y E F G)
                       (4 Y A)
                       (5 F E E Y D Y B C)
                       (4 Y X X E E)))
              '((5 X G E)
                (8 D G Y F G X E D Z Z)
                (2 Y D B C Z E Y A E Y)
                (9 C G Z G)
                (3 Z Y)
                (2 C)
                (4 A X E Z C A F)
                (5 F A Y E F G)
                (4 Y A)
                (5 F E E Y D Y B C)
                (4 Y X X E E)))
       (EQUAL (ACONS 5 '(Z A D A Z Y)
                     '((7 C F Y E G B)))
              '((5 Z A D A Z Y)
                (7 C F Y E G B)))
       (EQUAL (ACONS 6 '(G)
                     '((4 F A Y Y X B Z G)
                       (10 Y Y G B E G Z F)
                       (7 F B E E B B E)
                       (10 D Z F X Z A A F)
                       (5 Z B B F)
                       (1 A X X A D F D)))
              '((6 G)
                (4 F A Y Y X B Z G)
                (10 Y Y G B E G Z F)
                (7 F B E E B B E)
                (10 D Z F X Z A A F)
                (5 Z B B F)
                (1 A X X A D F D)))
       (EQUAL (ACONS 10 '(Z F B)
                     '((7 G)
                       (2 Z D X E Y C Y X)
                       (4 X E G C E G D A)
                       (5 Y X F Z Y)
                       (5 C)
                       (2 D C Z C D C)
                       (2 Z B)))
              '((10 Z F B)
                (7 G)
                (2 Z D X E Y C Y X)
                (4 X E G C E G D A)
                (5 Y X F Z Y)
                (5 C)
                (2 D C Z C D C)
                (2 Z B)))
       (EQUAL (ACONS 6 '(Z D F Z)
                     '((4 D Z C C A E Y)
                       (9 A A C G X E Y)
                       (2 X G A G D B G)
                       (6 A B)
                       (1 G)))
              '((6 Z D F Z)
                (4 D Z C C A E Y)
                (9 A A C G X E Y)
                (2 X G A G D B G)
                (6 A B)
                (1 G)))
       (EQUAL (ACONS 8
                     '(A B D Z E D Y D)
                     '((8 Z C)
                       (9 E Z A D F D Y X Z G)
                       (6 G)
                       (5 G D D G B F B C A)
                       (4 B Y Z C X A E)
                       (8 X A G F D A C Y)
                       (5 B F E C E F E)))
              '((8 A B D Z E D Y D)
                (8 Z C)
                (9 E Z A D F D Y X Z G)
                (6 G)
                (5 G D D G B F B C A)
                (4 B Y Z C X A E)
                (8 X A G F D A C Y)
                (5 B F E C E F E))))

STOP
