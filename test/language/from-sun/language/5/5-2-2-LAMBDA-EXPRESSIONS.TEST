;;
;;
;;  5.2.2. Lambda-expressions
;;
;;  test cases copied from page 63 - 65 of CLtL
;;
;;  test file created by Karin M. Sye on Nov. 9, 1986
;;
(do-test "test Lambda-expressions - examples of &optional and &rest parameters 0"
	(and

		(= ((lambda (a b) (+ a (* b 3))) 4 5) 19)
		(= ((lambda (a &optional (b 2)) (+ a (* b 3))) 4 5) 19)
		(= ((lambda (a &optional (b 2)) (+ a (* b 3))) 4) 10)
		(equal ((lambda (&optional (a 2 b) (c 3 d) &rest x) (list a b c d x))) '(2 nil 3 nil nil))
	)
)

(do-test "test Lambda-expressions - examples of &optional and &rest parameters 1"
	(and

		(equal ((lambda (&optional (a 2 b) (c 3 d) &rest x) (list a b c d x)) 6) '(6 t 3 nil nil))
		(equal ((lambda (&optional (a 2 b) (c 3 d) &rest x) (list a b c d x)) 6 3) '(6 t 3 t nil))
		(equal ((lambda (&optional (a 2 b) (c 3 d) &rest x) (list a b c d x)) 6 3 8) '(6 t 3 t (8)))
		(equal ((lambda (&optional (a 2 b) (c 3 d) &rest x) (list a b c d x)) 6 3 8 9 10 11) '(6 t 3 t (8 9 10 11)))
	)
)

(do-test "test Lambda-expressions - examples of &key parameters 0"
	(and
		(equal ((lambda (a b &key c d) (list a b c d)) 1 2) '(1 2 nil nil))
		(equal ((lambda (a b &key c d) (list a b c d)) 1 2 :c 6) '(1 2 6 nil))
		(equal ((lambda (a b &key c d) (list a b c d)) 1 2 :d 8) '(1 2 nil 8))
		(equal ((lambda (a b &key c d) (list a b c d)) 1 2 :c 6 :d 8) '(1 2 6 8))
	)
)

(do-test "test Lambda-expressions - examples of &key parameters 1"
	(and
		(equal ((lambda (a b &key c d) (list a b c d)) 1 2 :d 8 :c 6) '(1 2 6 8))
		(equal ((lambda (a b &key c d) (list a b c d)) :a 1 :d 8 :c 6) '(:a 1 6 8))
		(equal ((lambda (a b &key c d) (list a b c d)) :a :b :c :d) '(:a :b :d nil))
	)
)

(do-test "test Lambda-expressions - examples of mixtures 0"
	(and
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) 1) '(1 3 nil 1 nil))
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) 1 2) '(1 2 nil 1 nil)) 
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) :c 7) '(:c 7 nil :c nil))
	)
)

(do-test "test Lambda-expressions - examples of mixtures 1"
	(and
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) 1 6 :c 7) '(1 6 7 1 (:c 7)))
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) 1 6 :d 8) '(1 6 nil 8 (:d 8)))
		(equal ((lambda (a &optional (b 3) &rest x &key c (d a)) (list a b c d x)) 1 6 :d 8 :c 9 :d 10)
			  '(1 6 9 8 (:d 8 :c 9 :d 10)))
	)
)

(do-test "test Lambda-expressions - examples of &aux "
	(and
		(equal ((lambda (x y &aux (a (car x)) (b 2) c) (list x y a b c)) '(6 8 10) '(3 4 5))
			  '( (6 8 10) (3 4 5) 6 2 nil))

		(equal ((lambda (&optional (a 2) (b 4) &rest x &aux (c (+  a b)) d (e b)) (list a b c d e x)) 22)
			  '(22 4 26 nil 4 nil))
	)
)
STOP
