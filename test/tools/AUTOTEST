(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "19-Dec-2020 10:55:08" {DSK}<home>larry>ilisp>medley>internal>test>tools>AUTOTEST.;2 79279        changes to%:  (FNS AUTOTESTER AT.DIRECTORYCOMMAND)      previous date%: "16-Jul-85 15:52:21" {DSK}<home>larry>ilisp>medley>internal>test>tools>AUTOTEST.;1)(* ; "Copyright (c) 1985, 2020 by XEROX Corporation.  All rights reserved.")(PRETTYCOMPRINT AUTOTESTCOMS)(RPAQQ AUTOTESTCOMS       [(FILES ATTACHEDWINDOW ICONW)        [VARS [ATMENUITEMS '((TEST TEST                                    "Tests the selected files; middle button to also redirect output."                                   )                             (ABORT ABORT "Aborts testing of the selected files.")                             (PAUSE PAUSE "Temporarily pauses in the testing of selected files.")                             (RESUME RESUME "Resumes PAUSEd testing.")                             (DIRECTORY DIRECTORY                          "Does a directory of files in order to create a new set of tests to select."                                    )                             (PRINT PRINT "Prints the results of testing of the selected files; middle button to also select printing destination."                                    )                             (SUMMARIZE SUMMARIZE                              "Prints the results of testing of failed tests from the selected files."                                    )                             (QUIT QUIT "Quits testing."]              (ATNOARGITEMS '(DIRECTORY QUIT))              (ATBUSYOKITEMS '(ABORT PAUSE RESUME QUIT]        (INITVARS (ATICONFONT (FONTCREATE 'HELVETICA 8 'MRR))               (DEFAULTAUTOTESTFONT (FONTCREATE 'GACHA 10 'MRR))               (ATTIMEWINDOWFONT (FONTCREATE 'GACHA 8 'MRR))               (ATPROMPTFONT (FONTCREATE 'GACHA 8 'MRR))               (AUTOTESTMENUFONT (FONTCREATE 'HELVETICA 10 'MRR))               (ATBORDERWIDTH 2)               [ATINFOLISTINGWIDTHS '(RESULT (Result . 70)                                            NAME                                            (Name . 180)                                            FILE                                            (File . 1800]               (ATINFOSHADE 16920)               (ATITEMUNSELECTEDSHADE 0)               (ATITEMSELECTEDSHADE 43605))        (BITMAPS ATICON ATICONMASK)        (CURSORS AT.RIGHTARROWCURSOR)        (* * Main autotester fns)        (FNS AT AUTOTESTER SINGLE-TEST TEST-MESSAGE)        (COMS (* * commands and major subfunctions)              (FNS AT.TESTCOMMAND AT.ABORTCOMMAND AT.PAUSECOMMAND AT.RESUMECOMMAND                    AT.DIRECTORYCOMMAND AT.PRINTCOMMAND AT.QUITCOMMAND)              (FNS AT.COMMANDDISPATCH AT.SELECT AT.UPDATEAUTOTESTERITEMS AT.SINGLE-TEST))        (* * lower-level window mungers)        (FNS AT.MAKERIGIDWINDOW AT.CLRPROMPTW AT.PRINTHEADINGSON AT.PRINTANDGETREGION              AT.MAKEHEADINGWINDOW AT.MAKECOUNTERWINDOW AT.MAKETIMEWINDOW AT.PROMPTWPRINT              AT.PROMPTWTERPRI AT.SELECTFILE AT.UNSELECTFILE AT.CHANGECOMPLETEMARK              AT.SHOW.NUMCOMPLETED AT.SHOW.NUMFILES AT.SHOW.NUMSELECTED AT.SHOW.NUMSUCCESSFUL              AT.SHOW.ENDTIME AT.SHOW.STARTTIME AT.SHOW.TESTID AT.SHOW.TESTSUITE)        (* * window functions)        (FNS AT.HEADINGWREDISPLAYFN AT.REPAINT.COUNTERW AT.REPAINT.TIMEW AT.ICONFN AT.BUTTONEVENTFN              AT.CURSORMOVEDFN AT.CURSOROUTFN AT.REPAINTFN AT.SCROLLFN AT.RIGHTBUTTONFN              AT.MENU.WHENSELECTEDFN AT.CLOSEFN AT.HARDCOPYFN)        (* * odds and ends)        (FNS AT.FETCHFILENAME AT.STARTOFNAME AT.STARTUP AT.CREATEPRINTSPEC AT.FINDTESTBUCKET              AT.PROMPTFORINPUT AT.GETALLFILEINFO AT.GETPRINTDESTINATION AT.\ItemWithTag)        (DECLARE%: EVAL@COMPILE DONTCOPY (CONSTANTS (AT.MARKXPOS 16))               (RECORDS ATPRINTSPEC TESTBUCKET))        (ADDVARS (BackgroundMenuCommands ("AutomatedTester" (AT)                                                                                            "Opens an automated tester window; prompts for directory"                                                )))        (VARS (BackgroundMenu))        (DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDVARS (NLAMA AT)                                                                             (NLAML)                                                                             (LAMA AT.PROMPTWPRINT])(FILESLOAD ATTACHEDWINDOW ICONW)(RPAQQ ATMENUITEMS       ((TEST TEST "Tests the selected files; middle button to also redirect output.")        (ABORT ABORT "Aborts testing of the selected files.")        (PAUSE PAUSE "Temporarily pauses in the testing of selected files.")        (RESUME RESUME "Resumes PAUSEd testing.")        (DIRECTORY DIRECTORY                "Does a directory of files in order to create a new set of tests to select.")        (PRINT PRINT "Prints the results of testing of the selected files; middle button to also select printing destination."               )        (SUMMARIZE SUMMARIZE "Prints the results of testing of failed tests from the selected files."               )        (QUIT QUIT "Quits testing.")))(RPAQQ ATNOARGITEMS (DIRECTORY QUIT))(RPAQQ ATBUSYOKITEMS (ABORT PAUSE RESUME QUIT))(RPAQ? ATICONFONT (FONTCREATE 'HELVETICA 8 'MRR))(RPAQ? DEFAULTAUTOTESTFONT (FONTCREATE 'GACHA 10 'MRR))(RPAQ? ATTIMEWINDOWFONT (FONTCREATE 'GACHA 8 'MRR))(RPAQ? ATPROMPTFONT (FONTCREATE 'GACHA 8 'MRR))(RPAQ? AUTOTESTMENUFONT (FONTCREATE 'HELVETICA 10 'MRR))(RPAQ? ATBORDERWIDTH 2)(RPAQ? ATINFOLISTINGWIDTHS '(RESULT (Result . 70)                                       NAME                                       (Name . 180)                                       FILE                                       (File . 1800)))(RPAQ? ATINFOSHADE 16920)(RPAQ? ATITEMUNSELECTEDSHADE 0)(RPAQ? ATITEMSELECTEDSHADE 43605)(RPAQQ ATICON #*(80 80)OOOOOOOOOOOOOOOOOOOOH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@COAH@@@@AOOOOOOON@@@GOIH@@@@AOOOOOOON@@@NAMH@@@@AOOOOOOON@@@L@MH@@@@AOOOOOOON@@@L@MH@@@@AOOOOOOON@@@@@MH@@@@AOOOOOOON@@@@@MH@@@@AOOOOOOON@@@@AMHH@HFAOOOOOOONAH@@OIHLAHCAOOOOOOON@L@@OAHFC@AIOOOOOOON@F@@LAHCF@@MOOOOOOON@C@@LAHALGOOOOOOOOOOOOH@LAHALGOOOOOOOOOOOOH@LAHCF@@MOOOOOOON@C@@LAHFC@AIOOOOOOON@F@@LAHLAHCAOOOOOOON@L@@LAHH@HFAOOOOOOONAH@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@LAH@@@@AOOOOOOON@@@@LAH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@AOOOOOOON@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AH@@@@@@@@@@@@@@@@@@AOOOOOOOOOOOOOOOOOOOO)(RPAQQ ATICONMASK #*(80 80)OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO)(RPAQ AT.RIGHTARROWCURSOR (CURSORCREATE (QUOTE #*(16 16)@@@@@@@@@F@@@GH@@GN@@GOHOOONOOOOOOON@GOH@GN@@GH@@F@@@@@@@@@@@@@@) (QUOTE NIL) 7 9))(* * Main autotester fns)(DEFINEQ(AT  [NLAMBDA DIR                                               (* scv "23-May-85 11:28")    (AUTOTESTER (OR (CAR (NLAMBDA.ARGS DIR))                        (PROMPTFORWORD "Test directory pattern?" NIL NIL PROMPTWINDOW])(AUTOTESTER  [LAMBDA (FILESPEC)                                   (* ; "Edited 17-Dec-2020 16:54 by larry")                                                             (* scv "15-Jul-85 15:36")    (PROG ((PROMPTWHEIGHT 3)           AUTOTESTWINDOW COMMANDMENUWINDOW COMMANDMENU DIRSTART HEADINGW COUNTERW TIMEW TTYDS)          (COND             ((NULL FILESPEC)              (RETURN)))          (SETQ FILESPEC (DIRECTORY.FILL.PATTERN FILESPEC "DFASL" ""))          (SETQ COMMANDMENU           (create MENU                  MENUFONT _ AUTOTESTMENUFONT                  ITEMS _ ATMENUITEMS                  MENUROWS _ 1                  CENTERFLG _ T                  WHENSELECTEDFN _ (FUNCTION AT.MENU.WHENSELECTEDFN)))          (SETQ AUTOTESTWINDOW (CREATEW (GETREGION (WIDTHIFWINDOW (fetch IMAGEWIDTH of                                                                                           COMMANDMENU                                                                         )                                                          (fetch MENUOUTLINESIZE of                                                                                           COMMANDMENU                                                                 ))                                               (HEIGHTIFWINDOW (ITIMES 4 (FONTPROP                                                                                 DEFAULTAUTOTESTFONT                                                                                'HEIGHT))                                                      NIL ATBORDERWIDTH))                                      NIL ATBORDERWIDTH))          (SETQ HEADINGW (AT.MAKEHEADINGWINDOW (GETWINDOWPROP AUTOTESTWINDOW 'WIDTH)                                DEFAULTAUTOTESTFONT ATBORDERWIDTH "Automated Tester Window"))          (SETQ COUNTERW (AT.MAKECOUNTERWINDOW (HEIGHTIFWINDOW (FONTPROP DEFAULTAUTOTESTFONT                                                                          'HEIGHT))                                (WINDOWPROP HEADINGW 'WIDTH)                                AUTOTESTWINDOW))          (SETQ TIMEW (AT.MAKETIMEWINDOW (HEIGHTIFWINDOW (FONTPROP ATTIMEWINDOWFONT 'HEIGHT))                             (WINDOWPROP HEADINGW 'WIDTH)                             AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW 'HEADINGWINDOW HEADINGW)          (ATTACHWINDOW HEADINGW AUTOTESTWINDOW 'TOP)          (PUTWINDOWPROP AUTOTESTWINDOW 'COUNTERWINDOW COUNTERW)          (ATTACHWINDOW COUNTERW HEADINGW 'TOP)          (PUTWINDOWPROP AUTOTESTWINDOW 'TIMEWINDOW TIMEW)          (ATTACHWINDOW TIMEW COUNTERW 'TOP)          (SETQ COMMANDMENUWINDOW (ATTACHMENU COMMANDMENU AUTOTESTWINDOW 'TOP))          (PUTWINDOWPROP AUTOTESTWINDOW 'SCROLLFN (FUNCTION AT.SCROLLFN))          (AT.MAKERIGIDWINDOW (GETPROMPTWINDOW AUTOTESTWINDOW PROMPTWHEIGHT ATPROMPTFONT))          (DSPFONT DEFAULTAUTOTESTFONT AUTOTESTWINDOW)          (PUTWINDOWPROP AUTOTESTWINDOW 'ICONFN (FUNCTION AT.ICONFN))          (PUTWINDOWPROP AUTOTESTWINDOW 'ICONTITLE FILESPEC)          (PUTWINDOWPROP AUTOTESTWINDOW 'NUMCOMPLETED 0)          (PUTWINDOWPROP AUTOTESTWINDOW 'NUMSUCCESSFUL 0)          (PUTWINDOWPROP AUTOTESTWINDOW 'ORIGX (DSPXPOSITION NIL AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW 'ORIGY (DSPYPOSITION NIL AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW 'DIRWIDTH (GETWINDOWPROP AUTOTESTWINDOW 'WIDTH))          (PUTWINDOWPROP AUTOTESTWINDOW 'BUTTONEVENTFN (FUNCTION AT.BUTTONEVENTFN))          (PUTWINDOWPROP AUTOTESTWINDOW 'RIGHTBUTTONFN (FUNCTION AT.RIGHTBUTTONFN))          (PUTWINDOWPROP AUTOTESTWINDOW 'REPAINTFN (FUNCTION AT.REPAINTFN))          (PUTWINDOWPROP AUTOTESTWINDOW 'CURSORMOVEDFN (FUNCTION AT.CURSORMOVEDFN))          (PUTWINDOWPROP AUTOTESTWINDOW 'CURSOROUTFN (FUNCTION AT.CURSOROUTFN))          (WINDOWADDPROP AUTOTESTWINDOW 'RESHAPEFN (FUNCTION RESHAPEBYREPAINTFN))          (WINDOWADDPROP AUTOTESTWINDOW 'SHRINKFN (FUNCTION AT.CLOSEFN)                 T)          (WINDOWADDPROP AUTOTESTWINDOW 'CLOSEFN (FUNCTION AT.CLOSEFN)                 T)          (PUTWINDOWPROP AUTOTESTWINDOW 'ITEMSPEC FILESPEC)          (PUTWINDOWPROP AUTOTESTWINDOW 'HARDCOPYFN 'AT.HARDCOPYFN)          (WINDOWPROP COMMANDMENUWINDOW 'HARDCOPYFN 'AT.HARDCOPYFN)          (WINDOWPROP HEADINGW 'HARDCOPYFN 'AT.HARDCOPYFN)          (WINDOWPROP COUNTERW 'HARDCOPYFN 'AT.HARDCOPYFN)          (WINDOWPROP TIMEW 'HARDCOPYFN 'AT.HARDCOPYFN)          (WINDOWPROP (GETPROMPTWINDOW AUTOTESTWINDOW)                 'HARDCOPYFN                 'AT.HARDCOPYFN)          (SETQ TTYDS (WFROMDS (TTYDISPLAYSTREAM)))          (PUTWINDOWPROP AUTOTESTWINDOW 'ATDISPLAYSTREAM TTYDS)          (WINDOWPROP TTYDS 'PAGEFULLFN 'NILL)          (WINDOWPROP TTYDS 'AUTOTESTER AUTOTESTWINDOW)          (ADD.PROCESS (LIST (FUNCTION AT.STARTUP)                             AUTOTESTWINDOW COMMANDMENU COMMANDMENUWINDOW)                 'NAME                 'AT-Update)          (RETURN AUTOTESTWINDOW])(SINGLE-TEST  [LAMBDA (IDENTIFIER EXPRESSION PREDICATE TIMEOUT)          (* scv "12-Jul-85 16:22")    (PROG (MAIN PROC RESULT TESTEND)          (SETQ MAIN (WINDOWPROP (WFROMDS (TTYDISPLAYSTREAM))                            'AUTOTESTER))          (WINDOWPROP MAIN 'TESTRESULT NIL)          (PUTWINDOWPROP MAIN 'TESTSTART NIL)          (PUTWINDOWPROP MAIN 'TESTEND NIL)          [SETQ PROC (ADD.PROCESS (LIST 'AT.SINGLE-TEST (KWOTE IDENTIFIER)                                        (KWOTE EXPRESSION)                                        (KWOTE PREDICATE)                                        (KWOTE TIMEOUT)                                        (KWOTE (TTYDISPLAYSTREAM))                                        (KWOTE (OUTPUT)))                            'NAME                            (CONCAT 'SINGLE-TEST- IDENTIFIER)                            'WINDOW                            (WFROMDS (TTYDISPLAYSTREAM]          (WHILE (AND [NULL (SETQ RESULT (WINDOWPROP MAIN 'TESTRESULT]                          (OR (NULL TIMEOUT)                              [NULL (SETQ TESTEND (WINDOWPROP MAIN 'TESTEND]                              (LESSP (CLOCK 0)                                     TESTEND))                          (PROCESSP PROC)) DO (DISMISS 50))          (PUTWINDOWPROP MAIN 'TESTID NIL)          (AT.SHOW.TESTID MAIN)          (PUTWINDOWPROP MAIN 'STARTTIME NIL)          (AT.SHOW.STARTTIME MAIN)          (PUTWINDOWPROP MAIN 'ENDTIME NIL)          (AT.SHOW.ENDTIME MAIN)          (IF (NULL RESULT)              THEN (TEST-MESSAGE IDENTIFIER "timed out, timeout" TIMEOUT)                    (DEL.PROCESS PROC)                    (RETURN NIL)            ELSE (RETURN (CAR RESULT])(TEST-MESSAGE  [LAMBDA (IDENTIFIER TEXT INFO)                             (* scv " 3-Jul-85 12:07")    (printout NIL "===> Test " IDENTIFIER ":  " TEXT ":  " INFO T]))(* * commands and major subfunctions)(DEFINEQ(AT.TESTCOMMAND  [LAMBDA (FILEENTRY KEY WINDOW STDOUT)                      (* scv "12-Jul-85 14:21")    (PROG (FILENAME NUM ITEMMAP RESULT)          (BLOCK)          (OUTPUT STDOUT)          [WINDOWPROP WINDOW 'TESTSUITE (fetch (ATPRINTSPEC LABEL)                                           of (CADR (fetch (TESTBUCKET ITEM) of FILEENTRY                                                               ]          (AT.SHOW.TESTSUITE WINDOW)          (SETQ FILENAME (fetch (TESTBUCKET FILENAME) of FILEENTRY))          (SETQ NUM (fetch (TESTBUCKET %#) of FILEENTRY))          (SETQ ITEMMAP (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP))          (LISPXEVAL (LIST 'LOAD (LIST 'QUOTE FILENAME)))          [SETQ RESULT (LISPXEVAL (LIST (FILENAMEFIELD FILENAME 'NAME)                                        (LIST 'QUOTE (PACKFILENAME 'NAME "" 'EXTENSION ""                                                            'VERSION "" 'BODY FILENAME]          (replace (TESTBUCKET COMPLETED?) of FILEENTRY with T)          [WINDOWPROP WINDOW 'NUMCOMPLETED (ADD1 (WINDOWPROP WINDOW 'NUMCOMPLETED]          (replace (TESTBUCKET SUCCESSFUL?) of FILEENTRY with RESULT)          [if RESULT              then (WINDOWPROP WINDOW 'NUMSUCCESSFUL (ADD1 (WINDOWPROP WINDOW 'NUMSUCCESSFUL]          (AT.SHOW.NUMCOMPLETED WINDOW)          (AT.SHOW.NUMSUCCESSFUL WINDOW)          [replace (TESTBUCKET ITEM) of FILEENTRY             with (CONS [create ATPRINTSPEC                                   LABEL _ (if RESULT                                               then 'pass                                             else 'FAIL)                                   WIDTH _ (fetch (ATPRINTSPEC WIDTH) of (LISTGET                                                                                  ATINFOLISTINGWIDTHS                                                                                  'RESULT]                            (CDR (fetch (TESTBUCKET ITEM) of FILEENTRY]          (SETQ ITEMMAP (for I in ITEMMAP                           collect (if (EQP NUM (fetch (TESTBUCKET %#) of I))                                           then FILEENTRY                                         else I)))          (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP ITEMMAP)          (UNDOLISPX1 (LISPXFIND LISPXHISTORY (LIST (CADR LISPXHISTORY))                             'ENTRY NIL))          (UNDOLISPX1 (LISPXFIND LISPXHISTORY (LIST (SUB1 (CADR LISPXHISTORY)))                             'ENTRY NIL))          (REDISPLAYW WINDOW (fetch (TESTBUCKET ITEMREGION) of FILEENTRY))          (WINDOWPROP WINDOW 'TESTSUITE NIL)          (AT.SHOW.TESTSUITE WINDOW)          (OUTPUT T])(AT.ABORTCOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "12-Jul-85 16:19")    (PROG (PAUSED? PAUSE)          (SETQ PAUSED? (GETWINDOWPROP WINDOW 'PAUSESTART))          (if (NOT PAUSED?)              then (SETQ PAUSE (CLOCK 0))                    (PUTWINDOWPROP WINDOW 'PAUSESTART PAUSE))          (if (MOUSECONFIRM "Are you sure?  "                          "Click left button to ABORT tests, right button to RESUME tests."                         (GETPROMPTWINDOW (MAINWINDOW WINDOW T)))              then [PROG (PROC)                             (SETQ PROC (GETWINDOWPROP WINDOW 'TESTPROCESS))                             (if PROC                                 then (DEL.PROCESS PROC)                                       (PUTWINDOWPROP WINDOW 'PAUSESTART NIL)                               else (AT.CLRPROMPTW WINDOW)                                     (AT.PROMPTWPRINT WINDOW "No tests in process.")                                     (if (NOT PAUSED?)                                         then (PUTWINDOWPROP WINDOW 'PAUSESTART NIL]            else (if (NOT PAUSED?)                         then (PUTWINDOWPROP WINDOW 'PAUSESTART NIL)                               (if (GETWINDOWPROP WINDOW 'TESTEND)                                   then (PUTWINDOWPROP WINDOW 'ENDTIME                                                   (PLUS (GETWINDOWPROP WINDOW 'ENDTIME)                                                         (IQUOTIENT (DIFFERENCE (CLOCK 0)                                                                           PAUSE)                                                                1000)))                                         (AT.SHOW.ENDTIME (MAINWINDOW WINDOW T))                                         (PUTWINDOWPROP WINDOW 'TESTEND (PLUS (GETWINDOWPROP                                                                               WINDOW                                                                               'TESTEND)                                                                              (DIFFERENCE                                                                               (CLOCK 0)                                                                               PAUSE])(AT.PAUSECOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv " 2-Jul-85 15:29")    (PROG (PROC)          (SETQ PROC (GETWINDOWPROP WINDOW 'TESTPROCESS))          (if PROC              then (SUSPEND.PROCESS PROC)                    (PUTWINDOWPROP WINDOW 'PAUSESTART (CLOCK 0))            else (AT.CLRPROMPTW WINDOW)                  (AT.PROMPTWPRINT WINDOW "No tests in process."])(AT.RESUMECOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "12-Jul-85 16:19")    (PROG (PROC PAUSE)          (SETQ PROC (GETWINDOWPROP WINDOW 'TESTPROCESS))          (if PROC              then (if (SETQ PAUSE (GETWINDOWPROP WINDOW 'PAUSESTART))                           then (PUTWINDOWPROP WINDOW 'PAUSESTART NIL)                                 [if (GETWINDOWPROP WINDOW 'TESTEND)                                     then (PUTWINDOWPROP WINDOW 'ENDTIME                                                     (PLUS (GETWINDOWPROP WINDOW 'ENDTIME)                                                           (IQUOTIENT (DIFFERENCE (CLOCK 0)                                                                             PAUSE)                                                                  1000)))                                           (AT.SHOW.ENDTIME (MAINWINDOW WINDOW T))                                           (PUTWINDOWPROP WINDOW 'TESTEND (PLUS (GETWINDOWPROP                                                                                 WINDOW                                                                                 'TESTEND)                                                                                (DIFFERENCE                                                                                 (CLOCK 0)                                                                                 PAUSE]                                 (WAKE.PROCESS PROC)                         else (AT.CLRPROMPTW WINDOW)                               (AT.PROMPTWPRINT WINDOW "No tests paused."))            else (AT.CLRPROMPTW WINDOW)                  (AT.PROMPTWPRINT WINDOW "No tests in process."])(AT.DIRECTORYCOMMAND  [LAMBDA (KEY WINDOW)                                 (* ; "Edited 17-Dec-2020 17:08 by larry")                                                             (* scv "20-Jun-85 12:58")    (PROG (FILESPEC)          (AT.CLRPROMPTW WINDOW)          (if (NULL (SETQ FILESPEC (AT.PROMPTFORINPUT "New test directory pattern?  "                                              (GETWINDOWPROP WINDOW 'ITEMSPEC)                                              WINDOW)))              then (RETURN))          (PUTWINDOWPROP WINDOW 'ICONTITLE FILESPEC)          (PUTWINDOWPROP WINDOW 'ITEMSPEC (DIRECTORY.FILL.PATTERN FILESPEC "DFASL" ""))          (RETURN T])(AT.PRINTCOMMAND  [LAMBDA (FILEENTRY KEY WINDOW IMAGESTREAM)                 (* scv " 2-Jul-85 10:36")    (PROG (XPOS FONTWIDTH)          (SETQ FONTWIDTH (CHARWIDTH (CHCON1 "M")                                 (DSPFONT NIL IMAGESTREAM)))          (SETQ XPOS (DSPLEFTMARGIN NIL IMAGESTREAM))          (for I in (fetch (TESTBUCKET ITEM) of FILEENTRY)             do (printout IMAGESTREAM (fetch (ATPRINTSPEC LABEL) of I))                   (DSPXPOSITION (SETQ XPOS (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC WIDTH)                                                                  of I)                                                              FONTWIDTH)))                          IMAGESTREAM))          (TERPRI IMAGESTREAM])(AT.QUITCOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "31-May-85 12:49")    (CLOSEW WINDOW]))(DEFINEQ(AT.COMMANDDISPATCH  [LAMBDA (ITEM MENU KEY)                                    (* scv " 3-Jul-85 11:53")    (PROG (WINDOW ATUPDATE? FILELIST ITEMMAP NUMCOMPLETED NUMSUCCESSFUL FILE XPOS STDOUT)          (SETQ WINDOW (WINDOWPROP (WFROMMENU MENU)                              'MAINWINDOW))          (COND             ((FMEMB (CADR ITEM)                     ATBUSYOKITEMS))             ((GETWINDOWPROP WINDOW 'AUTOTESTERBUSY)              (AT.PROMPTWPRINT WINDOW "The autotester is busy.")              (RETURN)))          (COND             ((EQUAL (CADR ITEM)                     '"")              (RETURN)))          (SETQ ITEMMAP (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP))          (OR (FMEMB (CADR ITEM)                     ATNOARGITEMS)              [SETQ FILELIST (for INDEX in (WINDOWPROP WINDOW 'CURRENTTESTNUMBERS)                                collect (CAR (NTH ITEMMAP INDEX]              (PROGN (AT.PROMPTWPRINT WINDOW "No tests are selected")                     (RETURN)))          (RESETLST              (RESETSAVE NIL (LIST 'SHADEITEM ITEM MENU ATITEMUNSELECTEDSHADE))              [RESETSAVE NIL (LIST [FUNCTION (LAMBDA (W P)                                               (PUTWINDOWPROP W 'AUTOTESTERBUSY P]                                   WINDOW                                   (GETWINDOWPROP WINDOW 'AUTOTESTERBUSY]              (PUTWINDOWPROP WINDOW 'AUTOTESTERBUSY T)              (SHADEITEM ITEM MENU ATITEMSELECTEDSHADE)              [SELECTQ (CADR ITEM)                  (TEST (RESETLST                            (RESETSAVE NIL (LIST 'PUTWINDOWPROP WINDOW 'TESTPROCESS NIL))                            [RESETSAVE NIL (LIST 'SETTOPVAL 'HELPFLAG (GETTOPVAL 'HELPFLAG]                            (RESETSAVE NIL (LIST 'SET 'HELPFLAG HELPFLAG))                            (PUTWINDOWPROP WINDOW 'TESTPROCESS (THIS.PROCESS))                            (SETTOPVAL 'HELPFLAG NIL)                            (SETQ HELPFLAG NIL)                            [SETQ STDOUT (if (EQ KEY 'LEFT)                                             then T                                           else (OPENFILE (AT.PROMPTFORINPUT                                                                 "Name of file to direct output to?  "                                                                     "" WINDOW)                                                           'OUTPUT]                            (SETQ NUMCOMPLETED (WINDOWPROP WINDOW 'NUMCOMPLETED))                            (SETQ NUMSUCCESSFUL (WINDOWPROP WINDOW 'NUMSUCCESSFUL))                            [for FILEENTRY in ITEMMAP                               do (if (AND (FMEMB (fetch (TESTBUCKET %#) of FILEENTRY                                                                 )                                                          (WINDOWPROP WINDOW 'CURRENTTESTNUMBERS))                                                   (fetch (TESTBUCKET COMPLETED?) of                                                                                             FILEENTRY                                                          ))                                          then (SETQ NUMCOMPLETED (SUB1 NUMCOMPLETED))                                                (replace (TESTBUCKET COMPLETED?) of FILEENTRY                                                   with NIL)                                                (if (fetch (TESTBUCKET SUCCESSFUL?)                                                           of FILEENTRY)                                                    then (SETQ NUMSUCCESSFUL (SUB1 NUMSUCCESSFUL)                                                              )                                                          (replace (TESTBUCKET SUCCESSFUL?)                                                             of FILEENTRY with NIL]                            (WINDOWPROP WINDOW 'NUMCOMPLETED NUMCOMPLETED)                            (WINDOWPROP WINDOW 'NUMSUCCESSFUL NUMSUCCESSFUL)                            (AT.SHOW.NUMCOMPLETED WINDOW)                            (AT.SHOW.NUMSUCCESSFUL WINDOW)                            (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP ITEMMAP)                            (REDISPLAYW WINDOW)                            (TTYDISPLAYSTREAM (WINDOWPROP WINDOW 'ATDISPLAYSTREAM))                            (CLEARW (WINDOWPROP WINDOW 'ATDISPLAYSTREAM))                            (for FILEENTRY in FILELIST                               do (AT.TESTCOMMAND FILEENTRY KEY WINDOW STDOUT))                            (if (NEQ STDOUT T)                                then (CLOSEF STDOUT))))                  (ABORT (AT.ABORTCOMMAND KEY WINDOW))                  (PAUSE (AT.PAUSECOMMAND KEY WINDOW))                  (RESUME (AT.RESUMECOMMAND KEY WINDOW))                  (DIRECTORY (SETQ ATUPDATE? (AT.DIRECTORYCOMMAND KEY WINDOW)))                  (PRINT (SETQ FILE (AT.GETPRINTDESTINATION KEY))                         (printout FILE "Testing results for " (WINDOWPROP WINDOW 'ITEMSPEC)                                ":" T T)                         (SETQ XPOS (DSPLEFTMARGIN NIL FILE))                         (for I on ATINFOLISTINGWIDTHS by (CDDR I)                            do (printout FILE (fetch (ATPRINTSPEC LABEL) of (CADR I)))                                  (DSPXPOSITION [SETQ XPOS (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC                                                                                          WIDTH)                                                                                 of (CADR I))                                                                             (CHARWIDTH (CHCON1                                                                                         "M")                                                                                    (DSPFONT NIL FILE                                                                                           ]                                         FILE))                         (TERPRI FILE)                         (for FILEENTRY in FILELIST do (AT.PRINTCOMMAND FILEENTRY KEY                                                                          WINDOW FILE))                         (CLOSEF FILE))                  (SUMMARIZE (SETQ FILE (AT.GETPRINTDESTINATION KEY))                             (printout FILE "Testing summary for " (WINDOWPROP WINDOW 'ITEMSPEC)                                    ":" T T)                             (SETQ XPOS (DSPLEFTMARGIN NIL FILE))                             (for I on ATINFOLISTINGWIDTHS by (CDDR I)                                do (printout FILE (fetch (ATPRINTSPEC LABEL)                                                         of (CADR I)))                                      (DSPXPOSITION [SETQ XPOS (PLUS XPOS                                                                     (ITIMES (fetch (ATPRINTSPEC                                                                                         WIDTH)                                                                                of (CADR I))                                                                            (CHARWIDTH (CHCON1 "M")                                                                                   (DSPFONT NIL FILE]                                             FILE))                             (TERPRI FILE)                             (for FILEENTRY in FILELIST                                do (if (NULL (fetch (TESTBUCKET SUCCESSFUL?) of                                                                                         FILEENTRY))                                           then (AT.PRINTCOMMAND FILEENTRY KEY WINDOW FILE)))                             (CLOSEF FILE))                  (QUIT (AT.QUITCOMMAND KEY WINDOW))                  (LET ((FN (CADR ITEM)))                       (if (EQ (CAR FN)                                   'FUNCTION)                           then (APPLY* (CADR FN)                                           FILELIST KEY WINDOW)                         else (SHOULDNT]              (COND                 (ATUPDATE? (AT.UPDATEAUTOTESTERITEMS (WINDOWPROP WINDOW 'ITEMSPEC)                                   WINDOW))))])(AT.SELECT  [LAMBDA (WINDOW)                                           (* scv "22-May-85 15:32")    (PROG (AUTOTESTERITEMMAP TEST SETSEL ADDSEL EXTEND CURRENT#S TEST# FIRST# LAST#)          (OR (SETQ SETSEL (MOUSESTATE LEFT))              (SETQ ADDSEL (LASTMOUSESTATE MIDDLE))              (SETQ EXTEND (LASTMOUSESTATE RIGHT))              (RETURN))          (SETQ AUTOTESTERITEMMAP (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP))          (SETQ TEST (AT.FINDTESTBUCKET WINDOW))          (COND             ((NULL TEST)              (RETURN)))          [COND             (SETSEL (for TEST# in (GETWINDOWUSERPROP WINDOW 'CURRENTTESTNUMBERS)                        do (AT.UNSELECTFILE (CAR (FNTH AUTOTESTERITEMMAP TEST#))                                      WINDOW))                    (AT.SELECTFILE TEST WINDOW))             (ADDSEL (if (fetch (TESTBUCKET SELECTED?) of TEST)                         then (AT.UNSELECTFILE TEST WINDOW)                       else (AT.SELECTFILE TEST WINDOW)))             (EXTEND                                         (* have to find all the messages                                                            between TEST and the one selected *)                    (COND                       ([SETQ CURRENT#S (SORT (WINDOWPROP WINDOW 'CURRENTTESTNUMBERS]                        (SETQ TEST# (fetch (TESTBUCKET %#) of TEST))                        [COND                           [(ILESSP TEST# (CAR CURRENT#S))   (* before *)                            (SETQ FIRST# TEST#)                            (SETQ LAST# (SUB1 (CAR CURRENT#S]                           (T (SETQ LAST# TEST#)             (* after *)                              (SETQ FIRST# (ADD1 (CAR (LAST CURRENT#S]                        (for I from FIRST# to LAST#                           do (AT.SELECTFILE (CAR (NTH AUTOTESTERITEMMAP I))                                         WINDOW]          (AT.SHOW.NUMSELECTED WINDOW])(AT.UPDATEAUTOTESTERITEMS  [LAMBDA (ITEMSPEC WINDOW)                                  (* scv "12-Jul-85 14:07")    (PROG ((INFOWANTED '(RESULT NAME FILE))           HEADINGWINDOW FILEGENERATOR FILENAME FILEINFO MAXWIDTH AUTOTESTERITEMMAP)          [SETQ FILEGENERATOR (\GENERATEFILES ITEMSPEC '(NAME)                                     '(SORT RESETLST]          (SETQ HEADINGWINDOW (GETWINDOWPROP WINDOW 'HEADINGWINDOW))          (WINDOWPROP HEADINGWINDOW 'TITLE "Auto Tester")          (CLEARW (WINDOWPROP WINDOW 'COUNTERWINDOW))          (PUTWINDOWPROP WINDOW 'EXTENT NIL)                 (* set EXTENT to NIL while updating)          (PUTWINDOWPROP WINDOW 'INFOGOTTEN INFOWANTED)          (PUTWINDOWPROP WINDOW 'DIRWIDTH (SETQ MAXWIDTH (AT.PRINTHEADINGSON HEADINGWINDOW                                                                 INFOWANTED)))          (DSPRIGHTMARGIN 32767 WINDOW)          (CLEARW WINDOW)          [SETQ AUTOTESTERITEMMAP (while (SETQ FILENAME (\GENERATENEXTFILE FILEGENERATOR))                                     as ITEMCOUNT from 1 bind ITEM bind STARTOFNAME                                     collect (if (LISTP FILENAME)                                                     then (SETQ FILENAME (CONCATCODES FILENAME)))                                           (SETQ FILEINFO (AT.GETALLFILEINFO FILENAME                                                                  FILEGENERATOR INFOWANTED))                                           (create TESTBUCKET                                                  FILENAME _ FILENAME                                                  %# _ ITEMCOUNT                                                  ITEM _ [SETQ ITEM (AT.CREATEPRINTSPEC                                                                     FILEINFO INFOWANTED                                                                     (OR STARTOFNAME                                                                         (SETQ STARTOFNAME                                                                          (AT.STARTOFNAME                                                                                  FILENAME ITEMSPEC]                                                  ITEMREGION _ (AT.PRINTANDGETREGION ITEM WINDOW                                                                      AT.MARKXPOS 10)                                                  SELECTED? _ NIL                                                  COMPLETED? _ NIL                                                  SUCCESSFUL? _ '?]          (PUTWINDOWPROP WINDOW 'AUTOTESTERITEMMAP AUTOTESTERITEMMAP)          (PUTWINDOWPROP WINDOW 'EXTENT (if AUTOTESTERITEMMAP                                            then [create                                                      REGION                                                      LEFT _ 0                                                      BOTTOM _ [fetch (REGION BOTTOM)                                                                  of (fetch (TESTBUCKET                                                                                     ITEMREGION)                                                                            of                                                                            (CAR (LAST                                                                                     AUTOTESTERITEMMAP                                                                                       ]                                                      WIDTH _ MAXWIDTH                                                      HEIGHT _                                                      (IDIFFERENCE (fetch (REGION PTOP)                                                                      of (fetch (TESTBUCKET                                                                                         ITEMREGION)                                                                                of (CAR                                                                                     AUTOTESTERITEMMAP                                                                                            )))                                                             (fetch (REGION BOTTOM)                                                                of (fetch (TESTBUCKET                                                                                          ITEMREGION)                                                                          of (CAR (LAST                                                                                     AUTOTESTERITEMMAP                                                                                            ]                                          else (AT.CLRPROMPTW WINDOW)                                                (AT.PROMPTWPRINT WINDOW "No files in group "                                                        ITEMSPEC)                                                NIL))          (PUTWINDOWPROP HEADINGWINDOW 'TITLE (CONCAT (WINDOWPROP WINDOW 'ITEMSPEC)                                                     " tester"))          (PUTWINDOWPROP WINDOW 'CURRENTTESTNUMBERS NIL)          (PUTWINDOWPROP WINDOW 'CURRENTITEM NIL)          (PUTWINDOWPROP WINDOW 'NUMCOMPLETED 0)          (PUTWINDOWPROP WINDOW 'NUMSUCCESSFUL 0)          (AT.SHOW.NUMFILES WINDOW)          (AT.SHOW.NUMSELECTED WINDOW)          (AT.SHOW.NUMCOMPLETED WINDOW)          (AT.SHOW.NUMSUCCESSFUL WINDOW)          (AT.SHOW.TESTSUITE WINDOW)          (AT.SHOW.TESTID WINDOW)          (AT.SHOW.STARTTIME WINDOW)          (AT.SHOW.ENDTIME WINDOW])(AT.SINGLE-TEST  [LAMBDA (IDENTIFIER EXPRESSION PREDICATE TIMEOUT TTYDS STDOUT)                                                             (* scv "12-Jul-85 16:08")    (PROG (RESULT MAIN START)          (TTYDISPLAYSTREAM TTYDS)          (OUTPUT STDOUT)          (SETQ MAIN (WINDOWPROP (WFROMDS TTYDS)                            'AUTOTESTER))          (PUTWINDOWPROP MAIN 'TESTID IDENTIFIER)          (AT.SHOW.TESTID MAIN)          (PUTWINDOWPROP MAIN 'STARTTIME (IDATE))          (AT.SHOW.STARTTIME MAIN)          (IF TIMEOUT              THEN          (* The following assumes that the date format used by IDATE and GDATE is in        seconds.)                    (PUTWINDOWPROP MAIN 'ENDTIME (PLUS (IDATE)                                                       (QUOTIENT TIMEOUT 1000)))                    (AT.SHOW.ENDTIME MAIN))          (BLOCK)          (SETQ START (CLOCK 0))          (PUTWINDOWPROP MAIN 'TESTSTART START)          (PUTWINDOWPROP MAIN 'TESTEND (if TIMEOUT                                           then (PLUS START TIMEOUT)                                         else -1))          (SETQ RESULT (ERRORSET EXPRESSION T))          (PUTWINDOWPROP MAIN 'TESTSTART NIL)          (PUTWINDOWPROP MAIN 'TESTEND NIL)          (BLOCK)          (if (NULL RESULT)              then (TEST-MESSAGE IDENTIFIER "got an error in expression" EXPRESSION)                    (PUTWINDOWPROP MAIN 'TESTRESULT '(NIL))            elseif (EQ (CAR RESULT)                           'NOBIND)              then (TEST-MESSAGE IDENTIFIER "returned NOBIND in expression" EXPRESSION)                    (PUTWINDOWPROP MAIN 'TESTRESULT '(NIL))            else [SETQ RESULT (ERSETQ (APPLY* PREDICATE (CAR RESULT]                  (BLOCK)                  (if (NULL RESULT)                      then (TEST-MESSAGE IDENTIFIER "got an error in predicate" PREDICATE)                            (PUTWINDOWPROP MAIN 'TESTRESULT '(NIL))                    elseif (EQ (CAR RESULT)                                   'NOBIND)                      then (TEST-MESSAGE IDENTIFIER "returned NOBIND in predicate" PREDICATE)                            (PUTWINDOWPROP MAIN 'TESTRESULT '(NIL))                    else (PUTWINDOWPROP MAIN 'TESTRESULT RESULT]))(* * lower-level window mungers)(DEFINEQ(AT.MAKERIGIDWINDOW  [LAMBDA (WINDOW)                                           (* lmm "14-Sep-84 16:22")         (* * make the argument window immutable w/r/to attachedwindow package)    (PROG [(HEIGHT (fetch (REGION HEIGHT) of (GETWINDOWPROP WINDOW 'REGION]          (PUTWINDOWPROP WINDOW 'MINSIZE (CONS 0 HEIGHT))          (PUTWINDOWPROP WINDOW 'MAXSIZE (CONS SCREENWIDTH HEIGHT])(AT.CLRPROMPTW  [LAMBDA (MAINWINDOW)                                       (* Jellinek " 6-May-84 16:48")    (CLEARW (CAR (GETWINDOWPROP MAINWINDOW 'PROMPTWINDOW])(AT.PRINTHEADINGSON  [LAMBDA (WINDOW HEADINGS)                                  (* scv " 1-Jul-85 10:35")    (PROG ((totalwidth 0)           BOTTOM)          (DSPRIGHTMARGIN 32000 WINDOW)          (DSPTEXTURE BLACKSHADE WINDOW)          (DSPOPERATION 'INVERT WINDOW)          (DSPFILL NIL BLACKSHADE 'REPLACE WINDOW)          (for HEADING in ATINFOLISTINGWIDTHS by (CDDR HEADING)             bind word width (pos _ AT.MARKXPOS) when (FMEMB HEADING HEADINGS)             do (SETQ word (fetch (ATPRINTSPEC LABEL) of (LISTGET ATINFOLISTINGWIDTHS                                                                             HEADING)))                   (SETQ width (ITIMES (fetch (ATPRINTSPEC WIDTH) of (LISTGET                                                                                   ATINFOLISTINGWIDTHS                                                                                    HEADING))                                      (CHARWIDTH (CHCON1 "M")                                             DEFAULTAUTOTESTFONT)))                   (SETQ totalwidth (IPLUS totalwidth width))                   (DSPXPOSITION pos WINDOW)                   (PRIN3 word WINDOW)                   (add pos width))          (PUTWINDOWPROP WINDOW 'EXTENT (create REGION                                               LEFT _ 0                                               BOTTOM _ [SETQ BOTTOM (IPLUS (DSPYPOSITION NIL WINDOW)                                                                            (FONTPROP WINDOW                                                                                   'ASCENT]                                               WIDTH _ totalwidth                                               HEIGHT _ (IDIFFERENCE (GETWINDOWPROP WINDOW                                                                            'HEIGHT)                                                               BOTTOM)))          (RETURN totalwidth])(AT.PRINTANDGETREGION  [LAMBDA (PRINTSPEC STREAM LFTMARGIN MINSPACE)              (* scv " 1-Jul-85 11:29")                                                             (* prints PRINTSPEC on WINDOW and                                                            returns the box taken by the                                                            characters.)    (PROG (YSTART YEND HEIGHT)          (DSPXPOSITION LFTMARGIN STREAM)          (SETQ YSTART (DSPYPOSITION NIL STREAM))          (for SPEC in PRINTSPEC bind OLDX PRETTYWIDTH             do (SETQ OLDX (DSPXPOSITION NIL STREAM))                   [SETQ PRETTYWIDTH (ITIMES (fetch (ATPRINTSPEC WIDTH) of SPEC)                                            (CHARWIDTH (CHCON1 "M")                                                   (DSPFONT NIL STREAM]                   (COND                      ((fetch (ATPRINTSPEC LABEL) of SPEC)                       (PRIN3 (fetch (ATPRINTSPEC LABEL) of SPEC)                              STREAM)                       (PRIN3 " " STREAM)))                  (* If any single item won't fit,                                                            skip a line and continue)                   (if (IGEQ (IDIFFERENCE (DSPXPOSITION NIL STREAM)                                        OLDX)                                 PRETTYWIDTH)                       then (TERPRI STREAM))                   (DSPXPOSITION (IPLUS OLDX PRETTYWIDTH)                          STREAM))          (SETQ YEND (DSPYPOSITION NIL STREAM))          (RETURN (PROG1 (create REGION                                LEFT _ LFTMARGIN                                BOTTOM _ (IDIFFERENCE YEND (FONTPROP STREAM 'DESCENT))                                HEIGHT _ (IPLUS (IDIFFERENCE YSTART YEND)                                                (FONTPROP STREAM 'HEIGHT))                                WIDTH _ (IDIFFERENCE (DSPXPOSITION NIL STREAM)                                               LFTMARGIN))                         (TERPRI STREAM])(AT.MAKEHEADINGWINDOW  [LAMBDA (WIDTH FONT BORDER TITLE)                          (* scv "23-May-85 11:56")    (PROG (PWINDOW)          (SETQ PWINDOW (CREATEW (create REGION                                        LEFT _ 0                                        BOTTOM _ 0                                        WIDTH _ WIDTH                                        HEIGHT _ (HEIGHTIFWINDOW (FONTPROP FONT 'HEIGHT)                                                        TITLE BORDER))                               TITLE BORDER T))          (DSPFONT FONT PWINDOW)          (PUTWINDOWPROP PWINDOW 'PAGEFULLFN (FUNCTION NILL))          (PUTWINDOWPROP PWINDOW 'NOSCROLLBARS T)          (PUTWINDOWPROP PWINDOW 'SCROLLFN (FUNCTION SCROLLBYREPAINTFN))          (PUTWINDOWPROP PWINDOW 'REPAINTFN (FUNCTION AT.HEADINGWREDISPLAYFN))          (AT.MAKERIGIDWINDOW PWINDOW)          (RETURN PWINDOW])(AT.MAKECOUNTERWINDOW  [LAMBDA (HEIGHT WIDTH AUTOTESTW)                           (* scv "30-May-85 16:59")    (LET ((COUNTERW (CREATEW (create REGION                                    LEFT _ 0                                    BOTTOM _ 0                                    HEIGHT _ (HEIGHTIFWINDOW (FONTPROP DEFAULTAUTOTESTFONT                                                                    'HEIGHT))                                    WIDTH _ (WINDOWPROP AUTOTESTW 'WIDTH))                           NIL NIL T)))         (AT.MAKERIGIDWINDOW COUNTERW)         (WINDOWPROP COUNTERW 'AUTOTESTERWINDOW AUTOTESTW)         (WINDOWPROP COUNTERW 'REPAINTFN (FUNCTION AT.REPAINT.COUNTERW))         COUNTERW])(AT.MAKETIMEWINDOW  [LAMBDA (HEIGHT WIDTH AUTOTESTW)                           (* scv "15-Jul-85 15:36")    (LET ((TIMEW (CREATEW (create REGION                                 LEFT _ 0                                 BOTTOM _ 0                                 HEIGHT _ (HEIGHTIFWINDOW (FONTPROP ATTIMEWINDOWFONT 'HEIGHT))                                 WIDTH _ (WINDOWPROP AUTOTESTW 'WIDTH))                        NIL NIL T)))         (AT.MAKERIGIDWINDOW TIMEW)         (WINDOWPROP TIMEW 'AUTOTESTERWINDOW AUTOTESTW)         (WINDOWPROP TIMEW 'REPAINTFN (FUNCTION AT.REPAINT.TIMEW))         (DSPFONT ATTIMEWINDOWFONT TIMEW)         TIMEW])(AT.PROMPTWPRINT  [LAMBDA U                                                  (* Jellinek " 6-May-84 16:37")    (PROG (WINDOW)          (COND             ((ILESSP U 2)              (ERROR "not enough args to PROMPTWPRINT")))    (* CAR is window, CDR is height in                                                            lines)          [SETQ WINDOW (CAR (GETWINDOWPROP (ARG U 1)                                   'PROMPTWINDOW]          (for ITEM from 2 to U do (PRIN1 (ARG U ITEM)                                                          WINDOW])(AT.PROMPTWTERPRI  [LAMBDA (MAINWINDOW)                                       (* Jellinek " 6-May-84 16:37")                                                             (* CAR is prompt window, CDR is                                                            height in lines)    (TERPRI (CAR (GETWINDOWPROP MAINWINDOW 'PROMPTWINDOW])(AT.SELECTFILE  [LAMBDA (FOLDER WINDOW)                                    (* scv "23-May-85 12:10")    (COND       (FOLDER (replace (TESTBUCKET SELECTED?) of FOLDER with T)              (WINDOWADDPROP WINDOW 'CURRENTTESTNUMBERS (fetch (TESTBUCKET %#) of FOLDER))              [WINDOWPROP WINDOW 'CURRENTTESTNUMBERS (SORT (WINDOWPROP WINDOW 'CURRENTTESTNUMBERS]              (\ITEMW.SELECTITEM (LIST (fetch (TESTBUCKET ITEMREGION) of FOLDER))                     WINDOW])(AT.UNSELECTFILE  [LAMBDA (MSG WINDOW)                                       (* scv "28-May-85 12:53")    (COND       (MSG (replace (TESTBUCKET SELECTED?) of MSG with NIL)            [WINDOWPROP WINDOW 'CURRENTTESTNUMBERS (REMOVE (fetch (TESTBUCKET %#) of MSG)                                                          (WINDOWPROP WINDOW 'CURRENTTESTNUMBERS]            (\ITEMW.DESELECTITEM (LIST (fetch ITEMREGION of MSG))                   WINDOW])(AT.CHANGECOMPLETEMARK  [LAMBDA (TEST WINDOW)                                      (* scv "28-May-85 12:37")    (PROG ((TESTREGION (fetch ITEMREGION of TEST)))          (BITBLT NIL 0 0 WINDOW (fetch (REGION LEFT) of TESTREGION)                 (IDIFFERENCE (fetch (REGION PTOP) of TESTREGION)                        (IQUOTIENT (FONTPROP WINDOW 'HEIGHT)                               2))                 (fetch (REGION WIDTH) of TESTREGION)                 1                 'TEXTURE                 'INVERT BLACKSHADE])(AT.SHOW.NUMCOMPLETED  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:30")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW 'COUNTERWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                2))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              3)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP COUNTERW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE COUNTERW)              (DSPXPOSITION STARTPOSITION COUNTERW)              (PRIN3 "Completed:" COUNTERW)              (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW 'NUMCOMPLETED)                     PRINTINGREGION COUNTERW])(AT.SHOW.NUMFILES  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:28")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW 'COUNTERWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                0))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              1)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP COUNTERW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE COUNTERW)              (DSPXPOSITION STARTPOSITION COUNTERW)              (PRIN3 "Files:" COUNTERW)              (CENTERPRINTINREGION (LENGTH (WINDOWPROP AUTOTESTERW 'AUTOTESTERITEMMAP))                     PRINTINGREGION COUNTERW])(AT.SHOW.NUMSELECTED  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:35")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW 'COUNTERWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                1))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              2)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP COUNTERW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE COUNTERW)              (DSPXPOSITION STARTPOSITION COUNTERW)              (PRIN3 "Selected:" COUNTERW)              (CENTERPRINTINREGION (LENGTH (WINDOWPROP AUTOTESTERW 'CURRENTTESTNUMBERS))                     PRINTINGREGION COUNTERW])(AT.SHOW.NUMSUCCESSFUL  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:30")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW 'COUNTERWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                3))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              4)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP COUNTERW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE COUNTERW)              (DSPXPOSITION STARTPOSITION COUNTERW)              (PRIN3 "Successful:" COUNTERW)              (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW 'NUMSUCCESSFUL)                     PRINTINGREGION COUNTERW])(AT.SHOW.ENDTIME  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 16:01")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW 'TIMEWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                3))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              4)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP TIMEW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE TIMEW)              (DSPXPOSITION STARTPOSITION TIMEW)              (PRIN3 "End:" TIMEW)              (IF (WINDOWPROP AUTOTESTERW 'ENDTIME)                  THEN (CENTERPRINTINREGION (GDATE (WINDOWPROP AUTOTESTERW 'ENDTIME))                                  PRINTINGREGION TIMEW])(AT.SHOW.STARTTIME  [LAMBDA (AUTOTESTERW)                                      (* scv "15-Jul-85 15:43")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW 'TIMEWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                2))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              3)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP TIMEW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE TIMEW)              (DSPXPOSITION STARTPOSITION TIMEW)              (PRIN3 "Start:" TIMEW)              (IF (WINDOWPROP AUTOTESTERW 'STARTTIME)                  THEN (CENTERPRINTINREGION (GDATE (WINDOWPROP AUTOTESTERW 'STARTTIME))                                  PRINTINGREGION TIMEW])(AT.SHOW.TESTID  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 13:49")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW 'TIMEWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                1))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              2)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP TIMEW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE TIMEW)              (DSPXPOSITION STARTPOSITION TIMEW)              (PRIN3 "ID:" TIMEW)              (IF (WINDOWPROP AUTOTESTERW 'TESTID)                  THEN (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW 'TESTID)                                  PRINTINGREGION TIMEW])(AT.SHOW.TESTSUITE  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 13:47")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW 'TIMEWINDOW))          (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                        4)                                0))          (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW 'WIDTH)                                      4)                              1)))         (LET [(PRINTINGREGION (create REGION                                      LEFT _ STARTPOSITION                                      WIDTH _ (IDIFFERENCE ENDPOSITION STARTPOSITION)                                      BOTTOM _ 0                                      HEIGHT _ (WINDOWPROP TIMEW 'HEIGHT]              (DSPFILL PRINTINGREGION WHITESHADE 'REPLACE TIMEW)              (DSPXPOSITION STARTPOSITION TIMEW)              (PRIN3 "Suite:" TIMEW)              (IF (WINDOWPROP AUTOTESTERW 'TESTSUITE)                  THEN (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW 'TESTSUITE)                                  PRINTINGREGION TIMEW]))(* * window functions)(DEFINEQ(AT.HEADINGWREDISPLAYFN  [LAMBDA (WINDOW)                                           (* scv "24-May-85 17:06")    (AT.PRINTHEADINGSON WINDOW (GETWINDOWPROP (GETWINDOWPROP WINDOW 'MAINWINDOW)                                          'INFOGOTTEN])(AT.REPAINT.COUNTERW  [LAMBDA (COUNTERWINDOW)                                    (* scv "29-May-85 14:12")    (LET [(AUTOTESTERW (WINDOWPROP COUNTERWINDOW 'AUTOTESTERWINDOW]         (DSPFILL NIL WHITESHADE 'REPLACE COUNTERWINDOW)         (AT.SHOW.NUMFILES AUTOTESTERW)         (AT.SHOW.NUMSELECTED AUTOTESTERW)         (AT.SHOW.NUMCOMPLETED AUTOTESTERW)         (AT.SHOW.NUMSUCCESSFUL AUTOTESTERW])(AT.REPAINT.TIMEW  [LAMBDA (TIMEWINDOW)                                       (* scv "12-Jul-85 13:16")    (LET [(AUTOTESTERW (WINDOWPROP TIMEWINDOW 'AUTOTESTERWINDOW]         (DSPFILL NIL WHITESHADE 'REPLACE TIMEWINDOW)         (AT.SHOW.TESTSUITE AUTOTESTERW)         (AT.SHOW.TESTID AUTOTESTERW)         (AT.SHOW.STARTTIME AUTOTESTERW)         (AT.SHOW.ENDTIME AUTOTESTERW])(AT.ICONFN  [LAMBDA (W I)                                              (* scv " 3-Jun-85 14:41")    (PROG (OLDICONREGION)          [SETQ OLDICONREGION (AND I (GETWINDOWPROP I 'REGION]          (RETURN (TITLEDICONW (create TITLEDICON                                      ICON _ ATICON                                      MASK _ ATICONMASK                                      TITLEREG _                                      (create REGION                                             LEFT _ 5                                             WIDTH _ 70                                             BOTTOM _ 45                                             HEIGHT _ 75))                         (GETWINDOWPROP W 'ITEMSPEC)                         ATICONFONT                         (AND I (create POSITION                                       XCOORD _ (fetch (REGION LEFT) of OLDICONREGION)                                       YCOORD _ (fetch (REGION BOTTOM) of OLDICONREGION)))                         NIL                         'TOP])(AT.BUTTONEVENTFN  [LAMBDA (WINDOW)                                           (* scv "30-May-85 09:23")    (AT.SELECT WINDOW])(AT.CURSORMOVEDFN  [LAMBDA (WINDOW)                                           (* scv "29-May-85 09:49")    (if (IGEQ AT.MARKXPOS (fetch XCOORD of (CURSORPOSITION NIL WINDOW)))        then (SETCURSOR AT.RIGHTARROWCURSOR)      else (if (NEQ (CURSOR)                            DEFAULTCURSOR)                   then (SETCURSOR DEFAULTCURSOR])(AT.CURSOROUTFN  [LAMBDA (WINDOW)                                           (* rao%: "30-JUN-82 15:49")    (SETCURSOR DEFAULTCURSOR])(AT.REPAINTFN  [LAMBDA (WINDOW R)                                         (* scv "29-May-85 09:45")    (PROG ((AUTOTESTERITEMMAP (GETWINDOWPROP WINDOW 'AUTOTESTERITEMMAP))           (HEADINGWINDOW (GETWINDOWPROP WINDOW 'HEADINGWINDOW))           (TOP (fetch (REGION TOP) of R))           [BOTTOM (IDIFFERENCE (fetch (REGION BOTTOM) of R)                          (FONTPROP WINDOW 'ASCENT]           YPOS ITEMSPEC DIRWIDTH STARTOFNAME ATTRS)          (COND             ((NULL AUTOTESTERITEMMAP)              (RETURN)))          (for FILE in AUTOTESTERITEMMAP bind REGION             do (if (AND [IGREATERP TOP (SETQ YPOS (fetch (REGION BOTTOM)                                                              of (SETQ REGION (fetch                                                                                   (TESTBUCKET                                                                                           ITEMREGION)                                                                                     of FILE]                                 (ILESSP BOTTOM (fetch (REGION TOP) of REGION)))                        then (DSPYPOSITION (IDIFFERENCE (IPLUS (fetch (REGION BOTTOM)                                                                      of REGION)                                                                   (fetch (REGION HEIGHT)                                                                      of REGION))                                                      (FONTPROP WINDOW 'ASCENT))                                        WINDOW)                              (OR (EQUAL (AT.PRINTANDGETREGION (fetch (TESTBUCKET ITEM)                                                                      of FILE)                                                WINDOW AT.MARKXPOS 10)                                         REGION)                                  T                                  (HELP))                              (if (fetch (TESTBUCKET SELECTED?) of FILE)                                  then (\ITEMW.SELECTITEM (LIST (fetch ITEMREGION                                                                       of FILE))                                                  WINDOW))                              (if (fetch (TESTBUCKET COMPLETED?) of FILE)                                  then (AT.CHANGECOMPLETEMARK FILE WINDOW)))             repeatwhile (ILESSP BOTTOM YPOS])(AT.SCROLLFN  [LAMBDA (WINDOW HORIZ VERT CONTINUOUS?)                    (* scv "28-May-85 12:45")         (* * Scroll AT window up/down and right/left.       In right/left case, tell heading window to scroll also)         (* * only scroll an integral number of text lines)    (if (GETWINDOWPROP WINDOW 'AUTOTESTERBUSY)        then (AT.CLRPROMPTW WINDOW)              (AT.PROMPTWPRINT WINDOW "The autotester is busy.")      else (COND                  ((NOT (ZEROP HORIZ))                   (SCROLLW (GETWINDOWPROP WINDOW 'HEADINGWINDOW)                          HORIZ VERT CONTINUOUS?)))            (SCROLLBYREPAINTFN WINDOW HORIZ VERT CONTINUOUS?])(AT.RIGHTBUTTONFN  [LAMBDA (WINDOW)                                           (* scv "29-May-85 09:45")    (COND       ((IGREATERP (LASTMOUSEX WINDOW)               AT.MARKXPOS)        (DOWINDOWCOM WINDOW))       (T (AT.SELECT WINDOW])(AT.MENU.WHENSELECTEDFN  [LAMBDA (Item Menu Key)                                    (* scv "28-May-85 11:03")    (ADD.PROCESS (LIST (FUNCTION AT.COMMANDDISPATCH)                       (KWOTE Item)                       (KWOTE Menu)                       (KWOTE Key))           'NAME           (PACK (LIST 'AT- (CAR Item])(AT.CLOSEFN  [LAMBDA (WINDOW)                                           (* scv " 2-Jul-85 13:55")                                                             (* did you really want to close up                                                            shop?)         (* * do the right thing; if we are really closing, smash pointers which can        cause circularities, so everything gets collected)    (PROG (PROC)          (SETQ PROC (GETWINDOWPROP WINDOW 'TESTPROCESS))          (RETURN (COND                     (PROC (SUSPEND.PROCESS PROC)                           (if (MOUSECONFIRM "Tests in progress:  "                                     "Click left button to ABORT tests, right button to RESUME tests."                                          (GETPROMPTWINDOW (MAINWINDOW WINDOW T)))                               then (DEL.PROCESS PROC)                                     (PUTWINDOWPROP (GETWINDOWPROP WINDOW 'COUNTERWINDOW)                                            'AUTOTESTERWINDOW NIL)                                     (PUTWINDOWPROP WINDOW 'ATDISPLAYSTREAM NIL)                             else (WAKE.PROCESS PROC)                                   'DON'T))                     (T (PUTWINDOWPROP (GETWINDOWPROP WINDOW 'COUNTERWINDOW)                               'AUTOTESTERWINDOW NIL)                        (PUTWINDOWPROP WINDOW 'ATDISPLAYSTREAM NIL])(AT.HARDCOPYFN  [LAMBDA (WINDOW IMAGESTREAM)                               (* scv " 1-Jul-85 14:15")    (SETQ WINDOW (MAINWINDOW WINDOW T))    (PROG (XPOS FONTWIDTH)          (printout IMAGESTREAM "Testing results for " (GETWINDOWPROP WINDOW 'ITEMSPEC)                 ":" T T)          (SETQ FONTWIDTH (CHARWIDTH (CHCON1 "M")                                 (DSPFONT NIL IMAGESTREAM)))          (SETQ XPOS (DSPLEFTMARGIN NIL IMAGESTREAM))          (for I on ATINFOLISTINGWIDTHS by (CDDR I)             do (printout IMAGESTREAM (fetch (ATPRINTSPEC LABEL) of (CADR I)))                   (DSPXPOSITION (SETQ XPOS (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC WIDTH)                                                                  of (CADR I))                                                              FONTWIDTH)))                          IMAGESTREAM))          (TERPRI IMAGESTREAM)          (for FILEENTRY in (for INDEX in (GETWINDOWPROP WINDOW 'CURRENTTESTNUMBERS)                                       collect (CAR (NTH (GETWINDOWPROP WINDOW                                                                     'AUTOTESTERITEMMAP)                                                             INDEX)))             do (AT.PRINTCOMMAND FILEENTRY 'RIGHT WINDOW IMAGESTREAM]))(* * odds and ends)(DEFINEQ(AT.FETCHFILENAME  [LAMBDA (ENTRY)                                            (* scv "24-May-85 16:45")    (fetch (TESTBUCKET FILENAME) of ENTRY])(AT.STARTOFNAME  [LAMBDA (FILENAME SPEC)                                    (* lmm "14-Sep-84 17:59")                                                             (* assume that hosts match)    [SETQ SPEC (SUBSTRING SPEC (ADD1 (OR (LASTCHPOS (CHARCODE })                                                SPEC)                                         0]    (bind (DIRSTART _ (ADD1 (OR (LASTCHPOS (CHARCODE })                                           FILENAME)                                    0)))           DIREND first (SETQ FILENAME (SUBSTRING FILENAME DIRSTART))       while (SETQ DIREND (LASTCHPOS (CHARCODE >)                                     SPEC))       do (SETQ SPEC (SUBSTRING SPEC 1 DIREND SPEC))             [if (STRPOS SPEC FILENAME 1 NIL T NIL (UPPERCASEARRAY))                 then (RETURN (IPLUS DIRSTART (NCHARS SPEC]             (SETQ SPEC (SUBSTRING SPEC 1 -2 SPEC)) finally (RETURN DIRSTART])(AT.STARTUP  [LAMBDA (WINDOW COMMANDMENU COMMANDMENUWINDOW)             (* scv "20-Jun-85 11:05")    (PROG ((DIR (FASSOC 'DIRECTORY ATMENUITEMS)))          (RESETLST              (RESETSAVE NIL (LIST 'SHADEITEM DIR COMMANDMENU WHITESHADE))              (RESETSAVE NIL (LIST [FUNCTION (LAMBDA (W P)                                               (PUTWINDOWPROP W 'AUTOTESTERBUSY P]                                   WINDOW NIL))              (SHADEITEM DIR COMMANDMENU ATITEMSELECTEDSHADE COMMANDMENUWINDOW)              (PUTWINDOWPROP WINDOW 'AUTOTESTERBUSY T)              (AT.UPDATEAUTOTESTERITEMS (GETWINDOWPROP WINDOW 'ITEMSPEC)                     WINDOW))])(AT.CREATEPRINTSPEC  [LAMBDA (FILEINFO WANTTOSEE NAMESTART)                     (* scv "13-Jun-85 17:23")    (for HEADING in ATINFOLISTINGWIDTHS by (CDDR HEADING) when (FMEMB HEADING                                                                                       WANTTOSEE)       collect (create ATPRINTSPEC                          LABEL _ [COND                                     ((EQ HEADING 'FILE)                                      (SUBSTRING (CDR (FASSOC HEADING FILEINFO))                                             NAMESTART))                                     (T (CDR (FASSOC HEADING FILEINFO]                          WIDTH _ (fetch (ATPRINTSPEC WIDTH) of (LISTGET ATINFOLISTINGWIDTHS                                                                               HEADING])(AT.FINDTESTBUCKET  [LAMBDA (WINDOW)                                           (* scv "22-May-85 15:30")    (for TEST in (WINDOWPROP WINDOW 'AUTOTESTERITEMMAP)       bind [YPOS _ (IPLUS (LASTMOUSEY WINDOW)                               (FONTPROP WINDOW 'DESCENT]       thereis (IGREATERP YPOS (fetch BOTTOM of (fetch (TESTBUCKET ITEMREGION)                                                               of TEST])(AT.PROMPTFORINPUT  [LAMBDA (PROMPT EXPRS WINDOW)                              (* hdj " 1-Sep-84 15:58")    (PROMPTFORWORD PROMPT EXPRS NIL (CAR (GETWINDOWPROP WINDOW 'PROMPTWINDOW))           NIL           'TTY           (CHARCODE (CR ESC])(AT.GETALLFILEINFO  [LAMBDA (FILE GENERATOR ATTRIBUTES)                        (* scv "13-Jun-85 16:15")         (* *)    (for ATTR in ATTRIBUTES collect (if (EQ ATTR 'FILE)                                                    then (CONS ATTR FILE)                                                  elseif (EQ ATTR 'NAME)                                                    then (CONS ATTR (FILENAMEFIELD FILE                                                                               'NAME))                                                  elseif (EQ ATTR 'RESULT)                                                    then (CONS ATTR '?)                                                  else (CONS ATTR (\GENERATEFILEINFO GENERATOR                                                                              ATTR])(AT.GETPRINTDESTINATION  [LAMBDA (KEY)                                              (* scv " 2-Jul-85 10:24")    (if (EQ KEY 'LEFT)        then (OPENIMAGESTREAM '{LPT})      else (SELECTQ (MENU (create MENU                                     ITEMS _ '(File Printer)                                     TITLE _ "Print where?"                                     MENUCOLUMNS _ 1))                   (File [PROG (FILE)                               (SETQ FILE (GetImageFile))                               (RETURN (OPENIMAGESTREAM (CAR FILE)                                              (CDR FILE])                   (Printer (OPENIMAGESTREAM (PACKFILENAME 'HOST 'LPT 'NAME (GetPrinterName))))                   (SHOULDNT "Bad printer destination"])(AT.\ItemWithTag  [LAMBDA (TAG ITEMS)                                        (* hdj "16-Sep-84 16:16")         (* * search a menu's items for one with tag TAG)    (for ITEM in ITEMS do (if (EQ (CADR ITEM)                                                  TAG)                                          then (RETURN ITEM]))(DECLARE%: EVAL@COMPILE DONTCOPY (DECLARE%: EVAL@COMPILE (RPAQQ AT.MARKXPOS 16)(CONSTANTS (AT.MARKXPOS 16)))(DECLARE%: EVAL@COMPILE(RECORD ATPRINTSPEC (LABEL . WIDTH))(RECORD TESTBUCKET (FILENAME ITEMREGION %# SELECTED? COMPLETED? SUCCESSFUL? ITEM))))(ADDTOVAR BackgroundMenuCommands ("AutomatedTester" (AT)                                            "Opens an automated tester window; prompts for directory"                                            ))(RPAQQ BackgroundMenu NIL)(DECLARE%: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDTOVAR NLAMA AT)(ADDTOVAR NLAML )(ADDTOVAR LAMA AT.PROMPTWPRINT))(PUTPROPS AUTOTEST COPYRIGHT ("XEROX Corporation" 1985 2020))(DECLARE%: DONTCOPY  (FILEMAP (NIL (9502 16804 (AT 9512 . 9747) (AUTOTESTER 9749 . 14850) (SINGLE-TEST 14852 . 16624) (TEST-MESSAGE 16626 . 16802)) (16849 25928 (AT.TESTCOMMAND 16859 . 19699) (AT.ABORTCOMMAND 19701 . 22058) (AT.PAUSECOMMAND 22060 . 22499) (AT.RESUMECOMMAND 22501 . 24307) (AT.DIRECTORYCOMMAND 24309 . 25012) (AT.PRINTCOMMAND 25014 . 25793) (AT.QUITCOMMAND 25795 . 25926)) (25929 44896 (AT.COMMANDDISPATCH 25939 . 34567) (AT.SELECT 34569 . 36627) (AT.UPDATEAUTOTESTERITEMS 36629 . 42512) (AT.SINGLE-TEST 42514 . 44894)) (44936 63489 (AT.MAKERIGIDWINDOW 44946 . 45356) (AT.CLRPROMPTW 45358 . 45531) (AT.PRINTHEADINGSON 45533 . 47560) (AT.PRINTANDGETREGION 47562 . 49679) (AT.MAKEHEADINGWINDOW 49681 . 50599) (AT.MAKECOUNTERWINDOW 50601 . 51336) (AT.MAKETIMEWINDOW 51338 . 52008) (AT.PROMPTWPRINT 52010 . 52600) (AT.PROMPTWTERPRI 52602 . 52956) (AT.SELECTFILE 52958 . 53472) (AT.UNSELECTFILE 53474 . 53966) (AT.CHANGECOMPLETEMARK 53968 . 54537) (AT.SHOW.NUMCOMPLETED 54539 . 55627) (AT.SHOW.NUMFILES 55629 . 56723) (AT.SHOW.NUMSELECTED 56725 . 57826) (AT.SHOW.NUMSUCCESSFUL 57828 . 58919) (AT.SHOW.ENDTIME 58921 . 60062) (AT.SHOW.STARTTIME 60064 . 61213) (AT.SHOW.TESTID 61215 . 62344) (AT.SHOW.TESTSUITE 62346 . 63487)) (63519 73071 (AT.HEADINGWREDISPLAYFN 63529 . 63788) (AT.REPAINT.COUNTERW 63790 . 64219) (AT.REPAINT.TIMEW 64221 . 64628) (AT.ICONFN 64630 . 65715) (AT.BUTTONEVENTFN 65717 . 65857) (AT.CURSORMOVEDFN 65859 . 66240) (AT.CURSOROUTFN 66242 . 66385) (AT.REPAINTFN 66387 . 68973) (AT.SCROLLFN 68975 . 69680) (AT.RIGHTBUTTONFN 69682 . 69935) (AT.MENU.WHENSELECTEDFN 69937 . 70273) (AT.CLOSEFN 70275 . 71712) (AT.HARDCOPYFN 71714 . 73069)) (73098 78522 (AT.FETCHFILENAME 73108 . 73272) (AT.STARTOFNAME 73274 . 74243) (AT.STARTUP 74245 . 74930) (AT.CREATEPRINTSPEC 74932 . 75777) (AT.FINDTESTBUCKET 75779 . 76237) (AT.PROMPTFORINPUT 76239 . 76493) (AT.GETALLFILEINFO 76495 . 77374) (AT.GETPRINTDESTINATION 77376 . 78160) (AT.\ItemWithTag 78162 . 78520)))))STOP